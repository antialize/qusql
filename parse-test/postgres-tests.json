[
  {
    "input": "ALTER OPERATOR && (TEXT, TEXT) SET (RESTRICT = {}, JOIN = {})",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR + (INTEGER, INTEGER) SET (COMMUTATOR = +, NEGATOR = -, HASHES, MERGES)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER OPERATOR CLASS USING btree RENAME TO integer_ops",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER OPERATOR CLASS int_ops RENAME TO integer_ops",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER OPERATOR CLASS int_ops USING 123invalid RENAME TO integer_ops",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR CLASS int_ops USING btree ADD OPERATOR 1 < (INT4, INT2)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER OPERATOR CLASS int_ops USING btree DROP OPERATOR 1 (INT4, INT2)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR CLASS int_ops USING btree INVALID_OPERATION",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR CLASS int_ops USING btree OWNER TO",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR CLASS int_ops USING btree OWNER TO 123invalid",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR CLASS int_ops USING btree OWNER TO CURRENT_USER",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER OPERATOR CLASS int_ops USING btree OWNER TO joe",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER OPERATOR CLASS int_ops USING btree RENAME TO",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR CLASS int_ops USING btree RENAME TO 123invalid",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR CLASS int_ops USING btree RENAME TO integer_ops",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER OPERATOR CLASS int_ops USING btree RENAME TO integer_ops EXTRA",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR CLASS int_ops USING btree SET SCHEMA",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR CLASS int_ops USING btree SET SCHEMA 123invalid",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR CLASS int_ops USING btree SET SCHEMA new_schema",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER OPERATOR CLASS int_ops USING {} RENAME TO integer_ops",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR CLASS myschema.int_ops USING btree RENAME TO integer_ops",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER OPERATOR FAMILY 123invalid.my_ops USING btree ADD OPERATOR 1 < (INT4, INT2)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY USING btree ADD OPERATOR 1 < (INT4, INT2)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER OPERATOR FAMILY integer_ops USING btree ADD FUNCTION 1 btint42cmp(INT4, INT2)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER OPERATOR FAMILY integer_ops USING btree ADD OPERATOR 1 < (INT4, INT2)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER OPERATOR FAMILY integer_ops USING btree DROP FUNCTION 1 (INT4, INT2)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY integer_ops USING btree DROP OPERATOR 1 (INT4, INT2)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops ADD OPERATOR 1 < (INT4, INT2)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree ADD",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree ADD FUNCTION -1 func(INT4, INT2)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree ADD FUNCTION 1 () func",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree ADD FUNCTION 1 (INT4 func(INT2",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree ADD FUNCTION 1 (INT4, INT2 func()",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree ADD FUNCTION 1 (INT4, INT2)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree ADD FUNCTION 1 123invalid(INT4, INT2)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree ADD FUNCTION 1 func(@#$%, INT2)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree ADD FUNCTION 1 func(INT4, INT2",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree ADD FUNCTION 1.5 func(INT4, INT2)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree ADD OPERATOR -1 < (INT4, INT2)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree ADD OPERATOR 1  (INT4, INT2)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree ADD OPERATOR 1 (INT4, INT2)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree ADD OPERATOR 1 < ()",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree ADD OPERATOR 1 < (@#$%, INT2)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree ADD OPERATOR 1 < (INT4, INT2",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree ADD OPERATOR 1 < (INT4, INT2) EXTRA",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree ADD OPERATOR 1 < (INT4, INT2) FOR",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree ADD OPERATOR 1 < (INT4, INT2) FOR INVALID",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree ADD OPERATOR 1 < (INT4, INT2) FOR ORDER BY",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree ADD OPERATOR 1 < (INT4, INT2) FOR ORDER BY 123invalid",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree ADD OPERATOR 1 < (INT4, INT2) FOR SEARCH EXTRA",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree ADD OPERATOR 1 < (INT4, INT2) FOR SEARCH FOR ORDER BY sort_family",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree ADD OPERATOR 1 < (INT4, INT2), INVALID_ITEM",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree ADD OPERATOR 1 < INT4, INT2)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree ADD OPERATOR 1 @#$ (INT4, INT2)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree ADD OPERATOR 1.5 < (INT4, INT2)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree ADD OPERATOR 999999999999999999999 < (INT4, INT2)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree DROP FUNCTION 1 ()",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree DROP FUNCTION 1 (INT4, INT2) func(INT4)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree DROP OPERATOR 1 ()",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree DROP OPERATOR 1 (INT4, INT2) FOR SEARCH",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree DROP OPERATOR 1 (INT4, INT2), INVALID_ITEM",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree DROP OPERATOR 1 INT4, INT2",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree INVALID_OPERATION",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree OWNER TO 123invalid",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree OWNER TO joe",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree RENAME TO 123invalid",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree SET SCHEMA 123invalid",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR FAMILY my_ops USING btree SET SCHEMA new_schema",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER OPERATOR FAMILY old_ops USING btree RENAME TO new_ops",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER OPERATOR FAMILY text_ops USING btree ADD OPERATOR 1 @@ (TEXT, TEXT) FOR SEARCH",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER OPERATOR {} (INTEGER, INTEGER) SET (COMMUTATOR = {}, NEGATOR = {})",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR {} (INTEGER, INTEGER) SET ({})",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR {} (TEXT, TEXT) SET SCHEMA {}",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER OPERATOR {} ({}, {}) OWNER TO {}",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..14,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER ROLE old_name RENAME TO new_name",
    "output": "AlterRole(\n    AlterRole {\n        alter_span: 0..5,\n        role_span: 6..10,\n        role_name: Identifier {\n            value: \"old_name\",\n            span: 11..19,\n        },\n        action: RenameTo {\n            rename_to_span: 20..29,\n            new_name: Identifier {\n                value: \"new_name\",\n                span: 30..38,\n            },\n        },\n    },\n)",
    "issues": []
  },
  {
    "input": "ALTER ROLE role_name IN DATABASE database_name RESET maintenance_work_mem",
    "output": "AlterRole(\n    AlterRole {\n        alter_span: 0..5,\n        role_span: 6..10,\n        role_name: Identifier {\n            value: \"role_name\",\n            span: 11..20,\n        },\n        action: ResetInDatabase {\n            in_database_span: 21..32,\n            database_name: Identifier {\n                value: \"database_name\",\n                span: 33..46,\n            },\n            reset_span: 47..52,\n            parameter: Identifier {\n                value: \"maintenance_work_mem\",\n                span: 53..73,\n            },\n        },\n    },\n)",
    "issues": []
  },
  {
    "input": "ALTER ROLE role_name IN DATABASE database_name SET maintenance_work_mem = 100000",
    "output": "AlterRole(\n    AlterRole {\n        alter_span: 0..5,\n        role_span: 6..10,\n        role_name: Identifier {\n            value: \"role_name\",\n            span: 11..20,\n        },\n        action: SetInDatabase {\n            in_database_span: 21..32,\n            database_name: Identifier {\n                value: \"database_name\",\n                span: 33..46,\n            },\n            set_span: 47..50,\n            parameter: Identifier {\n                value: \"maintenance_work_mem\",\n                span: 51..71,\n            },\n            value: Value(\n                Integer(\n                    (\n                        100000,\n                        74..80,\n                    ),\n                ),\n            ),\n        },\n    },\n)",
    "issues": []
  },
  {
    "input": "ALTER ROLE role_name IN DATABASE database_name SET maintenance_work_mem TO 100000",
    "output": "AlterRole(\n    AlterRole {\n        alter_span: 0..5,\n        role_span: 6..10,\n        role_name: Identifier {\n            value: \"role_name\",\n            span: 11..20,\n        },\n        action: SetInDatabase {\n            in_database_span: 21..32,\n            database_name: Identifier {\n                value: \"database_name\",\n                span: 33..46,\n            },\n            set_span: 47..50,\n            parameter: Identifier {\n                value: \"maintenance_work_mem\",\n                span: 51..71,\n            },\n            value: Value(\n                Integer(\n                    (\n                        100000,\n                        75..81,\n                    ),\n                ),\n            ),\n        },\n    },\n)",
    "issues": []
  },
  {
    "input": "ALTER ROLE role_name IN DATABASE database_name SET maintenance_work_mem TO DEFAULT",
    "output": "AlterRole(\n    AlterRole {\n        alter_span: 0..5,\n        role_span: 6..10,\n        role_name: Identifier {\n            value: \"role_name\",\n            span: 11..20,\n        },\n        action: SetInDatabase {\n            in_database_span: 21..32,\n            database_name: Identifier {\n                value: \"database_name\",\n                span: 33..46,\n            },\n            set_span: 47..50,\n            parameter: Identifier {\n                value: \"maintenance_work_mem\",\n                span: 51..71,\n            },\n            value: Default(\n                72..82,\n            ),\n        },\n    },\n)",
    "issues": []
  },
  {
    "input": "ALTER ROLE role_name RESET ALL",
    "output": "AlterRole(\n    AlterRole {\n        alter_span: 0..5,\n        role_span: 6..10,\n        role_name: Identifier {\n            value: \"role_name\",\n            span: 11..20,\n        },\n        action: ResetAll {\n            reset_all_span: 21..30,\n        },\n    },\n)",
    "issues": []
  },
  {
    "input": "ALTER ROLE role_name SET maintenance_work_mem FROM CURRENT",
    "output": "AlterRole(\n    AlterRole {\n        alter_span: 0..5,\n        role_span: 6..10,\n        role_name: Identifier {\n            value: \"role_name\",\n            span: 11..20,\n        },\n        action: Set {\n            set_span: 21..24,\n            parameter: Identifier {\n                value: \"maintenance_work_mem\",\n                span: 25..45,\n            },\n            value: FromCurrent(\n                46..58,\n            ),\n        },\n    },\n)",
    "issues": []
  },
  {
    "input": "ALTER ROLE role_name WITH NOSUPERUSER NOCREATEDB NOCREATEROLE NOINHERIT NOLOGIN NOREPLICATION NOBYPASSRLS PASSWORD NULL",
    "output": "AlterRole(\n    AlterRole {\n        alter_span: 0..5,\n        role_span: 6..10,\n        role_name: Identifier {\n            value: \"role_name\",\n            span: 11..20,\n        },\n        action: With {\n            with_span: 21..25,\n            options: [\n                (\n                    Identifier {\n                        value: \"NOSUPERUSER\",\n                        span: 26..37,\n                    },\n                    None,\n                ),\n                (\n                    Identifier {\n                        value: \"NOCREATEDB\",\n                        span: 38..48,\n                    },\n                    None,\n                ),\n                (\n                    Identifier {\n                        value: \"NOCREATEROLE\",\n                        span: 49..61,\n                    },\n                    None,\n                ),\n                (\n                    Identifier {\n                        value: \"NOINHERIT\",\n                        span: 62..71,\n                    },\n                    None,\n                ),\n                (\n                    Identifier {\n                        value: \"NOLOGIN\",\n                        span: 72..79,\n                    },\n                    None,\n                ),\n                (\n                    Identifier {\n                        value: \"NOREPLICATION\",\n                        span: 80..93,\n                    },\n                    None,\n                ),\n                (\n                    Identifier {\n                        value: \"NOBYPASSRLS\",\n                        span: 94..105,\n                    },\n                    None,\n                ),\n                (\n                    Identifier {\n                        value: \"PASSWORD\",\n                        span: 106..114,\n                    },\n                    None,\n                ),\n            ],\n        },\n    },\n)",
    "issues": []
  },
  {
    "input": "ALTER ROLE role_name WITH SUPERUSER CREATEDB CREATEROLE INHERIT LOGIN REPLICATION BYPASSRLS CONNECTION LIMIT 100 PASSWORD 'abcdef' VALID UNTIL '2025-01-01'",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expression should not follow expression\",\n    span: 122..130,\n    sql_segment: \"'abcdef'\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER SCHEMA foo OWNER TO {}",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..12,\n    sql_segment: \"SCHEMA\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER SCHEMA foo RENAME TO bar",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..12,\n    sql_segment: \"SCHEMA\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE IF EXISTS ONLY tab ADD COLUMN a TEXT, ADD COLUMN b INT",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: Some(\n            12..21,\n        ),\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"ONLY\",\n                span: 22..26,\n            },\n        },\n        alter_specifications: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alter specification' here\",\n    span: 27..30,\n    sql_segment: \"tab\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE foo ADD CONSTRAINT \"bar\" PRIMARY KEY (baz)",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"foo\",\n                span: 12..15,\n            },\n        },\n        alter_specifications: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'addable' here\",\n    span: 31..36,\n    sql_segment: \"\\\"bar\\\"\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE foo ADD CONSTRAINT bar FOREIGN KEY (baz) REFERENCES other(ref) NOT VALID",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"foo\",\n                span: 12..15,\n            },\n        },\n        alter_specifications: [\n            AddForeignKey {\n                add_span: 16..19,\n                constraint: Some(\n                    (\n                        20..30,\n                        Some(\n                            Identifier {\n                                value: \"bar\",\n                                span: 31..34,\n                            },\n                        ),\n                    ),\n                ),\n                foreign_key_span: 35..46,\n                if_not_exists: None,\n                name: None,\n                cols: [\n                    IndexCol {\n                        expr: Column(\n                            Identifier {\n                                value: \"baz\",\n                                span: 48..51,\n                            },\n                        ),\n                        size: None,\n                        asc: None,\n                        desc: None,\n                    },\n                ],\n                references_span: 53..63,\n                references_table: Identifier {\n                    value: \"other\",\n                    span: 64..69,\n                },\n                references_cols: [\n                    Identifier {\n                        value: \"ref\",\n                        span: 70..73,\n                    },\n                ],\n                ons: [],\n            },\n        ],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected '';'' here\",\n    span: 75..78,\n    sql_segment: \"NOT\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE foo REPLICA IDENTITY DEFAULT",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"foo\",\n                span: 12..15,\n            },\n        },\n        alter_specifications: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alter specification' here\",\n    span: 16..23,\n    sql_segment: \"REPLICA\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE foo REPLICA IDENTITY FULL",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"foo\",\n                span: 12..15,\n            },\n        },\n        alter_specifications: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alter specification' here\",\n    span: 16..23,\n    sql_segment: \"REPLICA\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE foo REPLICA IDENTITY NOTHING",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"foo\",\n                span: 12..15,\n            },\n        },\n        alter_specifications: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alter specification' here\",\n    span: 16..23,\n    sql_segment: \"REPLICA\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE foo REPLICA IDENTITY USING INDEX foo_idx",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"foo\",\n                span: 12..15,\n            },\n        },\n        alter_specifications: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alter specification' here\",\n    span: 16..23,\n    sql_segment: \"REPLICA\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE foo VALIDATE CONSTRAINT bar",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"foo\",\n                span: 12..15,\n            },\n        },\n        alter_specifications: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alter specification' here\",\n    span: 16..24,\n    sql_segment: \"VALIDATE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE t ADD CONSTRAINT b UNIQUE (c)",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"t\",\n                span: 12..13,\n            },\n        },\n        alter_specifications: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''KEY' or 'INDEX'' here\",\n    span: 38..39,\n    sql_segment: \"(\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE t ADD CONSTRAINT b UNIQUE NULLS DISTINCT (c)",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"t\",\n                span: 12..13,\n            },\n        },\n        alter_specifications: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''KEY' or 'INDEX'' here\",\n    span: 38..43,\n    sql_segment: \"NULLS\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE t ADD CONSTRAINT b UNIQUE NULLS NOT DISTINCT (c)",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"t\",\n                span: 12..13,\n            },\n        },\n        alter_specifications: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''KEY' or 'INDEX'' here\",\n    span: 38..43,\n    sql_segment: \"NULLS\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE t ALTER COLUMN id ADD GENERATED ( INCREMENT 1 MINVALUE 1 )",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"t\",\n                span: 12..13,\n            },\n        },\n        alter_specifications: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alter column action' here\",\n    span: 30..33,\n    sql_segment: \"ADD\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE t ALTER COLUMN id ADD GENERATED ALWAYS AS IDENTITY",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"t\",\n                span: 12..13,\n            },\n        },\n        alter_specifications: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alter column action' here\",\n    span: 30..33,\n    sql_segment: \"ADD\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE t ALTER COLUMN id ADD GENERATED AS IDENTITY",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"t\",\n                span: 12..13,\n            },\n        },\n        alter_specifications: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alter column action' here\",\n    span: 30..33,\n    sql_segment: \"ADD\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE t ALTER COLUMN id ADD GENERATED AS IDENTITY (",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alter column action' here\",\n    span: 30..33,\n    sql_segment: \"ADD\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE t ALTER COLUMN id ADD GENERATED AS IDENTITY ( )",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"t\",\n                span: 12..13,\n            },\n        },\n        alter_specifications: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alter column action' here\",\n    span: 30..33,\n    sql_segment: \"ADD\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "ALTER TABLE t ALTER COLUMN id ADD GENERATED AS IDENTITY ( INCREMENT )",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"t\",\n                span: 12..13,\n            },\n        },\n        alter_specifications: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alter column action' here\",\n    span: 30..33,\n    sql_segment: \"ADD\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE t ALTER COLUMN id ADD GENERATED AS IDENTITY ( INCREMENT 1 MINVALUE 1 )",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"t\",\n                span: 12..13,\n            },\n        },\n        alter_specifications: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alter column action' here\",\n    span: 30..33,\n    sql_segment: \"ADD\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE t ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"t\",\n                span: 12..13,\n            },\n        },\n        alter_specifications: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alter column action' here\",\n    span: 30..33,\n    sql_segment: \"ADD\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE tab ALTER COLUMN is_active SET DATA TYPE TEXT USING 'text'",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"tab\",\n                span: 12..15,\n            },\n        },\n        alter_specifications: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''DEFAULT' or 'NOT NULL'' here\",\n    span: 43..47,\n    sql_segment: \"DATA\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE tab ALTER COLUMN is_active TYPE TEXT USING 'text'",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"tab\",\n                span: 12..15,\n            },\n        },\n        alter_specifications: [\n            AlterColumn {\n                alter_column_span: 16..28,\n                column: Identifier {\n                    value: \"is_active\",\n                    span: 29..38,\n                },\n                alter_column_action: Type {\n                    type_span: 39..43,\n                    type_: DataType {\n                        identifier: 44..48,\n                        type_: Text(\n                            None,\n                        ),\n                        properties: [],\n                    },\n                },\n            },\n        ],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected '';'' here\",\n    span: 49..54,\n    sql_segment: \"USING\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE tab DISABLE ROW LEVEL SECURITY",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"tab\",\n                span: 12..15,\n            },\n        },\n        alter_specifications: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alter specification' here\",\n    span: 16..23,\n    sql_segment: \"DISABLE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE tab DISABLE RULE rule_name",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"tab\",\n                span: 12..15,\n            },\n        },\n        alter_specifications: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alter specification' here\",\n    span: 16..23,\n    sql_segment: \"DISABLE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE tab DISABLE TRIGGER ALL",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"tab\",\n                span: 12..15,\n            },\n        },\n        alter_specifications: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alter specification' here\",\n    span: 16..23,\n    sql_segment: \"DISABLE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE tab DISABLE TRIGGER USER",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"tab\",\n                span: 12..15,\n            },\n        },\n        alter_specifications: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alter specification' here\",\n    span: 16..23,\n    sql_segment: \"DISABLE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE tab DISABLE TRIGGER trigger_name",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"tab\",\n                span: 12..15,\n            },\n        },\n        alter_specifications: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alter specification' here\",\n    span: 16..23,\n    sql_segment: \"DISABLE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE tab ENABLE ALWAYS RULE rule_name",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"tab\",\n                span: 12..15,\n            },\n        },\n        alter_specifications: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alter specification' here\",\n    span: 16..22,\n    sql_segment: \"ENABLE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE tab ENABLE ALWAYS TRIGGER trigger_name",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"tab\",\n                span: 12..15,\n            },\n        },\n        alter_specifications: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alter specification' here\",\n    span: 16..22,\n    sql_segment: \"ENABLE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE tab ENABLE REPLICA RULE rule_name",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"tab\",\n                span: 12..15,\n            },\n        },\n        alter_specifications: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alter specification' here\",\n    span: 16..22,\n    sql_segment: \"ENABLE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE tab ENABLE REPLICA TRIGGER trigger_name",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"tab\",\n                span: 12..15,\n            },\n        },\n        alter_specifications: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alter specification' here\",\n    span: 16..22,\n    sql_segment: \"ENABLE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE tab ENABLE ROW LEVEL SECURITY",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"tab\",\n                span: 12..15,\n            },\n        },\n        alter_specifications: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alter specification' here\",\n    span: 16..22,\n    sql_segment: \"ENABLE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE tab ENABLE RULE rule_name",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"tab\",\n                span: 12..15,\n            },\n        },\n        alter_specifications: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alter specification' here\",\n    span: 16..22,\n    sql_segment: \"ENABLE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE tab ENABLE TRIGGER ALL",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"tab\",\n                span: 12..15,\n            },\n        },\n        alter_specifications: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alter specification' here\",\n    span: 16..22,\n    sql_segment: \"ENABLE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE tab ENABLE TRIGGER USER",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"tab\",\n                span: 12..15,\n            },\n        },\n        alter_specifications: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alter specification' here\",\n    span: 16..22,\n    sql_segment: \"ENABLE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE tab ENABLE TRIGGER trigger_name",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"tab\",\n                span: 12..15,\n            },\n        },\n        alter_specifications: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alter specification' here\",\n    span: 16..22,\n    sql_segment: \"ENABLE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE tab FORCE ROW LEVEL SECURITY",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"tab\",\n                span: 12..15,\n            },\n        },\n        alter_specifications: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alter specification' here\",\n    span: 16..21,\n    sql_segment: \"FORCE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE tab NO FORCE ROW LEVEL SECURITY",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"tab\",\n                span: 12..15,\n            },\n        },\n        alter_specifications: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alter specification' here\",\n    span: 16..18,\n    sql_segment: \"NO\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE tab OWNER TO \"new_owner\"",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"tab\",\n                span: 12..15,\n            },\n        },\n        alter_specifications: [\n            OwnerTo {\n                span: 16..24,\n                owner: Identifier {\n                    value: \"new_owner\",\n                    span: 25..36,\n                },\n            },\n        ],\n    },\n)",
    "issues": []
  },
  {
    "input": "ALTER TABLE tab OWNER TO 4",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"tab\",\n                span: 12..15,\n            },\n        },\n        alter_specifications: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'identifier' here\",\n    span: 25..26,\n    sql_segment: \"4\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE tab OWNER TO CREATE",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"tab\",\n                span: 12..15,\n            },\n        },\n        alter_specifications: [\n            OwnerTo {\n                span: 16..24,\n                owner: Identifier {\n                    value: \"CREATE\",\n                    span: 25..31,\n                },\n            },\n        ],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"'CREATE' is a reserved identifier use `CREATE`\",\n    span: 25..31,\n    sql_segment: \"CREATE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE tab OWNER TO CREATE FOO",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"tab\",\n                span: 12..15,\n            },\n        },\n        alter_specifications: [\n            OwnerTo {\n                span: 16..24,\n                owner: Identifier {\n                    value: \"CREATE\",\n                    span: 25..31,\n                },\n            },\n        ],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"'CREATE' is a reserved identifier use `CREATE`\",\n    span: 25..31,\n    sql_segment: \"CREATE\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected '';'' here\",\n    span: 32..35,\n    sql_segment: \"FOO\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE tab OWNER TO CURRENT_ROLE",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"tab\",\n                span: 12..15,\n            },\n        },\n        alter_specifications: [\n            OwnerTo {\n                span: 16..24,\n                owner: Identifier {\n                    value: \"CURRENT_ROLE\",\n                    span: 25..37,\n                },\n            },\n        ],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"'CURRENT_ROLE' is a reserved identifier use `CURRENT_ROLE`\",\n    span: 25..37,\n    sql_segment: \"CURRENT_ROLE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TABLE tab OWNER TO SESSION_USER",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"tab\",\n                span: 12..15,\n            },\n        },\n        alter_specifications: [\n            OwnerTo {\n                span: 16..24,\n                owner: Identifier {\n                    value: \"SESSION_USER\",\n                    span: 25..37,\n                },\n            },\n        ],\n    },\n)",
    "issues": []
  },
  {
    "input": "ALTER TABLE tab OWNER TO new_owner",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"tab\",\n                span: 12..15,\n            },\n        },\n        alter_specifications: [\n            OwnerTo {\n                span: 16..24,\n                owner: Identifier {\n                    value: \"new_owner\",\n                    span: 25..34,\n                },\n            },\n        ],\n    },\n)",
    "issues": []
  },
  {
    "input": "ALTER TABLE tab OWNER TO postgres",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"tab\",\n                span: 12..15,\n            },\n        },\n        alter_specifications: [\n            OwnerTo {\n                span: 16..24,\n                owner: Identifier {\n                    value: \"postgres\",\n                    span: 25..33,\n                },\n            },\n        ],\n    },\n)",
    "issues": []
  },
  {
    "input": "ALTER TABLE tab RENAME CONSTRAINT old_name TO new_name",
    "output": "AlterTable(\n    AlterTable {\n        alter_span: 0..5,\n        online: None,\n        ignore: None,\n        table_span: 6..11,\n        if_exists: None,\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"tab\",\n                span: 12..15,\n            },\n        },\n        alter_specifications: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''COLUMN', 'INDEX' or 'TO'' here\",\n    span: 23..33,\n    sql_segment: \"CONSTRAINT\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TYPE public.my_type ADD VALUE 'label3.5' AFTER 'label3'",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..10,\n    sql_segment: \"TYPE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TYPE public.my_type ADD VALUE 'label3.5' BEFORE 'label4'",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..10,\n    sql_segment: \"TYPE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TYPE public.my_type ADD VALUE 'label5'",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..10,\n    sql_segment: \"TYPE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TYPE public.my_type ADD VALUE IF NOT EXISTS 'label3.5' AFTER 'label3'",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..10,\n    sql_segment: \"TYPE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TYPE public.my_type ADD VALUE IF NOT EXISTS 'label3.5' BEFORE 'label4'",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..10,\n    sql_segment: \"TYPE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TYPE public.my_type ADD VALUE IF NOT EXISTS 'label5'",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..10,\n    sql_segment: \"TYPE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "ALTER TYPE public.my_type RENAME TO my_new_type",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'alterable' here\",\n    span: 6..10,\n    sql_segment: \"TYPE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "BEGIN\n            -- Check that empname and salary are given\n            IF NEW.empname IS NULL THEN\n                RAISE EXCEPTION 'empname cannot be null';\n            END IF;\n            IF NEW.salary IS NULL THEN\n                RAISE EXCEPTION '% cannot have null salary', NEW.empname;\n            END IF;\n\n            -- Who works for us when they must pay for it?\n            IF NEW.salary < 0 THEN\n                RAISE EXCEPTION '% cannot have a negative salary', NEW.empname;\n            END IF;\n\n            -- Remember who changed the payroll when\n            NEW.last_date := current_timestamp;\n            NEW.last_user := current_user;\n            RETURN NEW;\n        END;",
    "output": "Begin(\n    0..5,\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 73..75,\n    sql_segment: \"IF\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "BEGIN\n        RETURN TRUE;\n    END;",
    "output": "Begin(\n    0..5,\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 14..20,\n    sql_segment: \"RETURN\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "BEGIN\n    IF a <> b THEN\n        RETURN TRUE;\n    ELSE\n        RETURN FALSE;\n    END IF;\nEND;",
    "output": "Begin(\n    0..5,\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 10..12,\n    sql_segment: \"IF\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "BEGIN\n    IF int1 <> 0 THEN\n        RETURN TRUE;\n    ELSE\n        RETURN FALSE;\n    END IF;\nEND;",
    "output": "Begin(\n    0..5,\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 10..12,\n    sql_segment: \"IF\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "BEGIN\n    IF int1 <> int2 THEN\n        RETURN TRUE;\n    ELSE\n        RETURN FALSE;\n    END IF;\nEND;",
    "output": "Begin(\n    0..5,\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 10..12,\n    sql_segment: \"IF\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "BEGIN\n    IF str1 <> str2 THEN\n        RETURN TRUE;\n    ELSE\n        RETURN FALSE;\n    END IF;\nEND;",
    "output": "Begin(\n    0..5,\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 10..12,\n    sql_segment: \"IF\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "COPY (SELECT 42 AS a, 'hello' AS b) FROM 'query.csv'",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'identifier' here\",\n    span: 5..6,\n    sql_segment: \"(\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "COPY (SELECT 42 AS a, 'hello' AS b) TO 'query.csv'",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'identifier' here\",\n    span: 5..6,\n    sql_segment: \"(\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "COPY ... FROM does not support query as a source",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'identifier' here\",\n    span: 5..6,\n    sql_segment: \".\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "COPY country TO PROGRAM 'gzip > /usr1/proj/bray/sql/country_data.gz'",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''('' here\",\n    span: 13..15,\n    sql_segment: \"TO\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "COPY country TO STDOUT (DELIMITER '|')",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''('' here\",\n    span: 13..15,\n    sql_segment: \"TO\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "COPY public.actor (actor_id, first_name, last_name, last_update, value) FROM stdin;\n1\tPENELOPE\tGUINESS\t2006-02-15 09:34:33 0.11111\n2\tNICK\tWAHLBERG\t2006-02-15 09:34:33 0.22222\n3\tED\tCHASE\t2006-02-15 09:34:33 0.312323\n4\tJENNIFER\tDAVIS\t2006-02-15 09:34:33 0.3232\n5\tJOHNNY\tLOLLOBRIGIDA\t2006-02-15 09:34:33 1.343\n6\tBETTE\tNICHOLSON\t2006-02-15 09:34:33 5.0\n7\tGRACE\tMOSTEL\t2006-02-15 09:34:33 6.0\n8\tMATTHEW\tJOHANSSON\t2006-02-15 09:34:33 7.0\n9\tJOE\tSWANK\t2006-02-15 09:34:33 8.0\n10\tCHRISTIAN\tGABLE\t2006-02-15 09:34:33 9.1\n11\tZERO\tCAGE\t2006-02-15 09:34:33 10.001\n12\tKARL\tBERRY\t2017-11-02 19:15:42.308637+08 11.001\nA Fateful Reflection of a Waitress And a Boat who must Discover a Sumo Wrestler in Ancient China\nKwara & Kogi\n{\"Deleted Scenes\",\"Behind the Scenes\"}\n'awe':5 'awe-inspir':4 'barbarella':1 'cat':13 'conquer':16 'dog':18 'feminist':10 'inspir':6 'monasteri':21 'must':15 'stori':7 'streetcar':2\nPHP\t\u20b1 USD $\n\\N  Some other value\n\\\\.",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''('' here\",\n    span: 11..12,\n    sql_segment: \".\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "COPY users FROM 'data.csv'",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''('' here\",\n    span: 11..15,\n    sql_segment: \"FROM\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "COPY users FROM 'data.csv' BINARY DELIMITER ',' NULL 'null' CSV HEADER QUOTE '\"' ESCAPE '\\' FORCE NOT NULL column",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''('' here\",\n    span: 11..15,\n    sql_segment: \"FROM\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "COPY users FROM 'data.csv' DELIMITER ','",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''('' here\",\n    span: 11..15,\n    sql_segment: \"FROM\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "COPY users FROM 'data.csv' DELIMITER ',' CSV HEADER",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''('' here\",\n    span: 11..15,\n    sql_segment: \"FROM\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "COPY users FROM 'data.csv' DELIMITER AS ',' NULL AS 'null' CSV QUOTE AS '\"' ESCAPE AS '\\'",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''('' here\",\n    span: 11..15,\n    sql_segment: \"FROM\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "COPY users TO 'data.csv'",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''('' here\",\n    span: 11..13,\n    sql_segment: \"TO\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "COPY users TO 'data.csv' BINARY DELIMITER ',' NULL 'null' CSV HEADER QUOTE '\"' ESCAPE '\\' FORCE QUOTE column",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''('' here\",\n    span: 11..13,\n    sql_segment: \"TO\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "COPY users TO 'data.csv' DELIMITER ','",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''('' here\",\n    span: 11..13,\n    sql_segment: \"TO\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "COPY users TO 'data.csv' DELIMITER ',' CSV HEADER",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''('' here\",\n    span: 11..13,\n    sql_segment: \"TO\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 6..6,\n    sql_segment: \"\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "CREATE CONSTRAINT TRIGGER check_multiple_events BEFORE INSERT OR UPDATE OR DELETE ON accounts DEFERRABLE INITIALLY DEFERRED FOR EACH ROW EXECUTE FUNCTION check_account_changes",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..17,\n    sql_segment: \"CONSTRAINT\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'ON' here\",\n    span: 62..64,\n    sql_segment: \"OR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE DOMAIN my_domain AS INTEGER CHECK (VALUE > 0)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..13,\n    sql_segment: \"DOMAIN\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE DOMAIN my_domain AS INTEGER COLLATE \"en_US\" CHECK (VALUE > 0)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..13,\n    sql_segment: \"DOMAIN\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE DOMAIN my_domain AS INTEGER COLLATE \"en_US\" DEFAULT 1 CHECK (VALUE > 0)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..13,\n    sql_segment: \"DOMAIN\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE DOMAIN my_domain AS INTEGER CONSTRAINT my_constraint CHECK (VALUE > 0)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..13,\n    sql_segment: \"DOMAIN\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE DOMAIN my_domain AS INTEGER DEFAULT 1 CHECK (VALUE > 0)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..13,\n    sql_segment: \"DOMAIN\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE EXTENSION extension_name",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..16,\n    sql_segment: \"EXTENSION\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE EXTENSION extension_name WITH CASCADE",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..16,\n    sql_segment: \"EXTENSION\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE EXTENSION extension_name WITH SCHEMA schema_name",
    "output": "CreateDatabase(\n    CreateDatabase {\n        create_span: 0..6,\n        database_span: 37..43,\n        if_not_exists: None,\n        name: Identifier {\n            value: \"schema_name\",\n            span: 44..55,\n        },\n        create_options: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..16,\n    sql_segment: \"EXTENSION\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE EXTENSION extension_name WITH SCHEMA schema_name CASCADE",
    "output": "CreateDatabase(\n    CreateDatabase {\n        create_span: 0..6,\n        database_span: 37..43,\n        if_not_exists: None,\n        name: Identifier {\n            value: \"schema_name\",\n            span: 44..55,\n        },\n        create_options: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..16,\n    sql_segment: \"EXTENSION\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 56..63,\n    sql_segment: \"CASCADE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE EXTENSION extension_name WITH SCHEMA schema_name VERSION version",
    "output": "CreateDatabase(\n    CreateDatabase {\n        create_span: 0..6,\n        database_span: 37..43,\n        if_not_exists: None,\n        name: Identifier {\n            value: \"schema_name\",\n            span: 44..55,\n        },\n        create_options: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..16,\n    sql_segment: \"EXTENSION\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 56..63,\n    sql_segment: \"VERSION\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE EXTENSION extension_name WITH SCHEMA schema_name VERSION version CASCADE",
    "output": "CreateDatabase(\n    CreateDatabase {\n        create_span: 0..6,\n        database_span: 37..43,\n        if_not_exists: None,\n        name: Identifier {\n            value: \"schema_name\",\n            span: 44..55,\n        },\n        create_options: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..16,\n    sql_segment: \"EXTENSION\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 56..63,\n    sql_segment: \"VERSION\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE EXTENSION extension_name WITH VERSION version",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..16,\n    sql_segment: \"EXTENSION\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE EXTENSION extension_name WITH VERSION version CASCADE",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..16,\n    sql_segment: \"EXTENSION\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE FUNCTION add(INTEGER, INTEGER = 1) RETURNS INTEGER AS 'select $1 + $2;'",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"'add' is a reserved identifier use `add`\",\n    span: 16..19,\n    sql_segment: \"add\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"'INTEGER' is a reserved identifier use `INTEGER`\",\n    span: 20..27,\n    sql_segment: \"INTEGER\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'type' here\",\n    span: 27..28,\n    sql_segment: \",\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected ''$$'' here\",\n    span: 61..78,\n    sql_segment: \"'select $1 + $2;'\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE FUNCTION add(INTEGER, INTEGER DEFAULT 1) RETURNS INTEGER AS 'select $1 + $2;'",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"'add' is a reserved identifier use `add`\",\n    span: 16..19,\n    sql_segment: \"add\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"'INTEGER' is a reserved identifier use `INTEGER`\",\n    span: 20..27,\n    sql_segment: \"INTEGER\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'type' here\",\n    span: 27..28,\n    sql_segment: \",\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected ''$$'' here\",\n    span: 67..84,\n    sql_segment: \"'select $1 + $2;'\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE FUNCTION add(INTEGER, INTEGER) RETURNS INTEGER LANGUAGE SQL IMMUTABLE STRICT PARALLEL SAFE AS 'select $1 + $2;'",
    "output": "CreateFunction(\n    CreateFunction {\n        create_span: 0..6,\n        create_options: [],\n        function_span: 7..15,\n        if_not_exists: None,\n        name: Identifier {\n            value: \"add\",\n            span: 16..19,\n        },\n        params: [],\n        returns_span: 38..45,\n        return_type: DataType {\n            identifier: 46..53,\n            type_: Integer(\n                None,\n            ),\n            properties: [],\n        },\n        characteristics: [\n            LanguageSql(\n                54..66,\n            ),\n        ],\n        return_: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"'add' is a reserved identifier use `add`\",\n    span: 16..19,\n    sql_segment: \"add\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"'INTEGER' is a reserved identifier use `INTEGER`\",\n    span: 20..27,\n    sql_segment: \"INTEGER\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'type' here\",\n    span: 27..28,\n    sql_segment: \",\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 67..76,\n    sql_segment: \"IMMUTABLE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE FUNCTION add(INTEGER, INTEGER) RETURNS INTEGER LANGUAGE SQL PARALLEL BLAH AS 'select $1 + $2;'",
    "output": "CreateFunction(\n    CreateFunction {\n        create_span: 0..6,\n        create_options: [],\n        function_span: 7..15,\n        if_not_exists: None,\n        name: Identifier {\n            value: \"add\",\n            span: 16..19,\n        },\n        params: [],\n        returns_span: 38..45,\n        return_type: DataType {\n            identifier: 46..53,\n            type_: Integer(\n                None,\n            ),\n            properties: [],\n        },\n        characteristics: [\n            LanguageSql(\n                54..66,\n            ),\n        ],\n        return_: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"'add' is a reserved identifier use `add`\",\n    span: 16..19,\n    sql_segment: \"add\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"'INTEGER' is a reserved identifier use `INTEGER`\",\n    span: 20..27,\n    sql_segment: \"INTEGER\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'type' here\",\n    span: 27..28,\n    sql_segment: \",\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 67..75,\n    sql_segment: \"PARALLEL\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE FUNCTION add(function(struct<a,b> int64), b INTEGER) RETURNS INTEGER LANGUAGE SQL IMMUTABLE STRICT PARALLEL SAFE AS 'select $1 + $2;'",
    "output": "CreateFunction(\n    CreateFunction {\n        create_span: 0..6,\n        create_options: [],\n        function_span: 7..15,\n        if_not_exists: None,\n        name: Identifier {\n            value: \"add\",\n            span: 16..19,\n        },\n        params: [],\n        returns_span: 60..67,\n        return_type: DataType {\n            identifier: 68..75,\n            type_: Integer(\n                None,\n            ),\n            properties: [],\n        },\n        characteristics: [\n            LanguageSql(\n                76..88,\n            ),\n        ],\n        return_: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"'add' is a reserved identifier use `add`\",\n    span: 16..19,\n    sql_segment: \"add\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'type' here\",\n    span: 28..29,\n    sql_segment: \"(\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 89..98,\n    sql_segment: \"IMMUTABLE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE FUNCTION cas_in(input cstring) RETURNS cas IMMUTABLE PARALLEL SAFE LANGUAGE c AS 'MODULE_PATHNAME', 'cas_in_wrapper'",
    "output": "CreateFunction(\n    CreateFunction {\n        create_span: 0..6,\n        create_options: [],\n        function_span: 7..15,\n        if_not_exists: None,\n        name: Identifier {\n            value: \"cas_in\",\n            span: 16..22,\n        },\n        params: [\n            (\n                None,\n                Identifier {\n                    value: \"input\",\n                    span: 23..28,\n                },\n                DataType {\n                    identifier: 29..36,\n                    type_: Named(\n                        29..36,\n                    ),\n                    properties: [],\n                },\n            ),\n        ],\n        returns_span: 38..45,\n        return_type: DataType {\n            identifier: 46..49,\n            type_: Named(\n                46..49,\n            ),\n            properties: [],\n        },\n        characteristics: [],\n        return_: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 50..59,\n    sql_segment: \"IMMUTABLE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE FUNCTION cas_in(input cstring) RETURNS cas LANGUAGE c IMMUTABLE PARALLEL SAFE AS 'MODULE_PATHNAME', 'cas_in_wrapper'",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'language name' here\",\n    span: 59..60,\n    sql_segment: \"c\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE FUNCTION emp_stamp() RETURNS trigger AS $emp_stamp$\n        BEGIN\n            -- Check that empname and salary are given\n            IF NEW.empname IS NULL THEN\n                RAISE EXCEPTION 'empname cannot be null';\n            END IF;\n            IF NEW.salary IS NULL THEN\n                RAISE EXCEPTION '% cannot have null salary', NEW.empname;\n            END IF;\n\n            -- Who works for us when they must pay for it?\n            IF NEW.salary < 0 THEN\n                RAISE EXCEPTION '% cannot have a negative salary', NEW.empname;\n            END IF;\n\n            -- Remember who changed the payroll when\n            NEW.last_date := current_timestamp;\n            NEW.last_user := current_user;\n            RETURN NEW;\n        END;\n    $emp_stamp$ LANGUAGE plpgsql;",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'identifier' here\",\n    span: 26..27,\n    sql_segment: \")\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected ''$$'' here\",\n    span: 47..48,\n    sql_segment: \"$\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "CREATE FUNCTION test() RETURNS TEXT AS $$SELECT 'hello'$$ LANGUAGE SQL",
    "output": "CreateFunction(\n    CreateFunction {\n        create_span: 0..6,\n        create_options: [],\n        function_span: 7..15,\n        if_not_exists: None,\n        name: Identifier {\n            value: \"test\",\n            span: 16..20,\n        },\n        params: [],\n        returns_span: 23..30,\n        return_type: DataType {\n            identifier: 31..35,\n            type_: Text(\n                None,\n            ),\n            properties: [],\n        },\n        characteristics: [\n            LanguageSql(\n                58..70,\n            ),\n        ],\n        return_: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'identifier' here\",\n    span: 21..22,\n    sql_segment: \")\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "CREATE FUNCTION test() RETURNS TEXT AS $body$SELECT 'hello'$body$ LANGUAGE SQL",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'identifier' here\",\n    span: 21..22,\n    sql_segment: \")\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected ''$$'' here\",\n    span: 39..40,\n    sql_segment: \"$\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "CREATE FUNCTION test_fn() RETURNS void LANGUAGE sql SECURITY DEFINER AS $$ SELECT 1 $$",
    "output": "CreateFunction(\n    CreateFunction {\n        create_span: 0..6,\n        create_options: [],\n        function_span: 7..15,\n        if_not_exists: None,\n        name: Identifier {\n            value: \"test_fn\",\n            span: 16..23,\n        },\n        params: [],\n        returns_span: 26..33,\n        return_type: DataType {\n            identifier: 34..38,\n            type_: Named(\n                34..38,\n            ),\n            properties: [],\n        },\n        characteristics: [\n            LanguageSql(\n                39..51,\n            ),\n        ],\n        return_: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'identifier' here\",\n    span: 24..25,\n    sql_segment: \")\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 52..60,\n    sql_segment: \"SECURITY\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "CREATE FUNCTION test_fn() RETURNS void LANGUAGE sql SECURITY INVOKER AS $$ SELECT 1 $$",
    "output": "CreateFunction(\n    CreateFunction {\n        create_span: 0..6,\n        create_options: [],\n        function_span: 7..15,\n        if_not_exists: None,\n        name: Identifier {\n            value: \"test_fn\",\n            span: 16..23,\n        },\n        params: [],\n        returns_span: 26..33,\n        return_type: DataType {\n            identifier: 34..38,\n            type_: Named(\n                34..38,\n            ),\n            properties: [],\n        },\n        characteristics: [\n            LanguageSql(\n                39..51,\n            ),\n        ],\n        return_: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'identifier' here\",\n    span: 24..25,\n    sql_segment: \")\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 52..60,\n    sql_segment: \"SECURITY\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "CREATE FUNCTION test_fn() RETURNS void LANGUAGE sql SET search_path = auth, pg_temp, public AS $$ SELECT 1 $$",
    "output": "CreateFunction(\n    CreateFunction {\n        create_span: 0..6,\n        create_options: [],\n        function_span: 7..15,\n        if_not_exists: None,\n        name: Identifier {\n            value: \"test_fn\",\n            span: 16..23,\n        },\n        params: [],\n        returns_span: 26..33,\n        return_type: DataType {\n            identifier: 34..38,\n            type_: Named(\n                34..38,\n            ),\n            properties: [],\n        },\n        characteristics: [\n            LanguageSql(\n                39..51,\n            ),\n        ],\n        return_: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'identifier' here\",\n    span: 24..25,\n    sql_segment: \")\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 52..55,\n    sql_segment: \"SET\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "CREATE FUNCTION test_fn() RETURNS void LANGUAGE sql SET search_path = public SET statement_timeout = '5s' AS $$ SELECT 1 $$",
    "output": "CreateFunction(\n    CreateFunction {\n        create_span: 0..6,\n        create_options: [],\n        function_span: 7..15,\n        if_not_exists: None,\n        name: Identifier {\n            value: \"test_fn\",\n            span: 16..23,\n        },\n        params: [],\n        returns_span: 26..33,\n        return_type: DataType {\n            identifier: 34..38,\n            type_: Named(\n                34..38,\n            ),\n            properties: [],\n        },\n        characteristics: [\n            LanguageSql(\n                39..51,\n            ),\n        ],\n        return_: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'identifier' here\",\n    span: 24..25,\n    sql_segment: \")\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 52..55,\n    sql_segment: \"SET\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "CREATE FUNCTION test_fn() RETURNS void LANGUAGE sql SET search_path FROM CURRENT AS $$ SELECT 1 $$",
    "output": "CreateFunction(\n    CreateFunction {\n        create_span: 0..6,\n        create_options: [],\n        function_span: 7..15,\n        if_not_exists: None,\n        name: Identifier {\n            value: \"test_fn\",\n            span: 16..23,\n        },\n        params: [],\n        returns_span: 26..33,\n        return_type: DataType {\n            identifier: 34..38,\n            type_: Named(\n                34..38,\n            ),\n            properties: [],\n        },\n        characteristics: [\n            LanguageSql(\n                39..51,\n            ),\n        ],\n        return_: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'identifier' here\",\n    span: 24..25,\n    sql_segment: \")\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 52..55,\n    sql_segment: \"SET\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "CREATE INDEX CONCURRENTLY IF NOT EXISTS my_index ON my_table(col1, col2)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'ON' here\",\n    span: 26..28,\n    sql_segment: \"IF\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE INDEX IF NOT EXISTS my_index ON my_table(col1, col2)",
    "output": "CreateIndex(\n    CreateIndex {\n        create_span: 0..6,\n        create_options: [],\n        index_span: 7..12,\n        index_name: Identifier {\n            value: \"my_index\",\n            span: 27..35,\n        },\n        if_not_exists: Some(\n            13..26,\n        ),\n        on_span: 36..38,\n        table_name: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"my_table\",\n                span: 39..47,\n            },\n        },\n        index_options: [],\n        l_paren_span: 47..48,\n        column_names: [\n            IndexCol {\n                expr: Column(\n                    Identifier {\n                        value: \"col1\",\n                        span: 48..52,\n                    },\n                ),\n                size: None,\n                asc: None,\n                desc: None,\n            },\n            IndexCol {\n                expr: Column(\n                    Identifier {\n                        value: \"col2\",\n                        span: 54..58,\n                    },\n                ),\n                size: None,\n                asc: None,\n                desc: None,\n            },\n        ],\n        r_paren_span: 58..59,\n        where_: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "CREATE INDEX IF NOT EXISTS my_index ON my_table(col1, col2) INCLUDE (col3, col4)",
    "output": "CreateIndex(\n    CreateIndex {\n        create_span: 0..6,\n        create_options: [],\n        index_span: 7..12,\n        index_name: Identifier {\n            value: \"my_index\",\n            span: 27..35,\n        },\n        if_not_exists: Some(\n            13..26,\n        ),\n        on_span: 36..38,\n        table_name: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"my_table\",\n                span: 39..47,\n            },\n        },\n        index_options: [],\n        l_paren_span: 47..48,\n        column_names: [\n            IndexCol {\n                expr: Column(\n                    Identifier {\n                        value: \"col1\",\n                        span: 48..52,\n                    },\n                ),\n                size: None,\n                asc: None,\n                desc: None,\n            },\n            IndexCol {\n                expr: Column(\n                    Identifier {\n                        value: \"col2\",\n                        span: 54..58,\n                    },\n                ),\n                size: None,\n                asc: None,\n                desc: None,\n            },\n        ],\n        r_paren_span: 58..59,\n        where_: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 60..67,\n    sql_segment: \"INCLUDE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE INDEX IF NOT EXISTS my_index ON my_table(col1, col2) NULLS DISTINCT",
    "output": "CreateIndex(\n    CreateIndex {\n        create_span: 0..6,\n        create_options: [],\n        index_span: 7..12,\n        index_name: Identifier {\n            value: \"my_index\",\n            span: 27..35,\n        },\n        if_not_exists: Some(\n            13..26,\n        ),\n        on_span: 36..38,\n        table_name: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"my_table\",\n                span: 39..47,\n            },\n        },\n        index_options: [],\n        l_paren_span: 47..48,\n        column_names: [\n            IndexCol {\n                expr: Column(\n                    Identifier {\n                        value: \"col1\",\n                        span: 48..52,\n                    },\n                ),\n                size: None,\n                asc: None,\n                desc: None,\n            },\n            IndexCol {\n                expr: Column(\n                    Identifier {\n                        value: \"col2\",\n                        span: 54..58,\n                    },\n                ),\n                size: None,\n                asc: None,\n                desc: None,\n            },\n        ],\n        r_paren_span: 58..59,\n        where_: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 60..65,\n    sql_segment: \"NULLS\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE INDEX IF NOT EXISTS my_index ON my_table(col1, col2) NULLS NOT DISTINCT",
    "output": "CreateIndex(\n    CreateIndex {\n        create_span: 0..6,\n        create_options: [],\n        index_span: 7..12,\n        index_name: Identifier {\n            value: \"my_index\",\n            span: 27..35,\n        },\n        if_not_exists: Some(\n            13..26,\n        ),\n        on_span: 36..38,\n        table_name: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"my_table\",\n                span: 39..47,\n            },\n        },\n        index_options: [],\n        l_paren_span: 47..48,\n        column_names: [\n            IndexCol {\n                expr: Column(\n                    Identifier {\n                        value: \"col1\",\n                        span: 48..52,\n                    },\n                ),\n                size: None,\n                asc: None,\n                desc: None,\n            },\n            IndexCol {\n                expr: Column(\n                    Identifier {\n                        value: \"col2\",\n                        span: 54..58,\n                    },\n                ),\n                size: None,\n                asc: None,\n                desc: None,\n            },\n        ],\n        r_paren_span: 58..59,\n        where_: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 60..65,\n    sql_segment: \"NULLS\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE INDEX IF NOT EXISTS my_index ON my_table(col1, col2) WHERE col3 IS NULL",
    "output": "CreateIndex(\n    CreateIndex {\n        create_span: 0..6,\n        create_options: [],\n        index_span: 7..12,\n        index_name: Identifier {\n            value: \"my_index\",\n            span: 27..35,\n        },\n        if_not_exists: Some(\n            13..26,\n        ),\n        on_span: 36..38,\n        table_name: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"my_table\",\n                span: 39..47,\n            },\n        },\n        index_options: [],\n        l_paren_span: 47..48,\n        column_names: [\n            IndexCol {\n                expr: Column(\n                    Identifier {\n                        value: \"col1\",\n                        span: 48..52,\n                    },\n                ),\n                size: None,\n                asc: None,\n                desc: None,\n            },\n            IndexCol {\n                expr: Column(\n                    Identifier {\n                        value: \"col2\",\n                        span: 54..58,\n                    },\n                ),\n                size: None,\n                asc: None,\n                desc: None,\n            },\n        ],\n        r_paren_span: 58..59,\n        where_: Some(\n            (\n                60..65,\n                Is(\n                    Identifier(\n                        [\n                            Name(\n                                Identifier {\n                                    value: \"col3\",\n                                    span: 66..70,\n                                },\n                            ),\n                        ],\n                    ),\n                    Null,\n                    71..78,\n                ),\n            ),\n        ),\n    },\n)",
    "issues": []
  },
  {
    "input": "CREATE INDEX ON my_table(col1, col2)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"'ON' is a reserved identifier use `ON`\",\n    span: 13..15,\n    sql_segment: \"ON\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'ON' here\",\n    span: 16..24,\n    sql_segment: \"my_table\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE INDEX bloomidx ON tbloom USING BLOOM (i1, i2, i3) WITH (length = 80, col1 = 2, col2 = 2, col3 = 4)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected GIST after USING (or use USING after column list for MySQL)\",\n    span: 38..43,\n    sql_segment: \"BLOOM\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE INDEX brin_sensor_data_recorded_at ON sensor_data USING BRIN (recorded_at)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected GIST after USING (or use USING after column list for MySQL)\",\n    span: 63..67,\n    sql_segment: \"BRIN\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE INDEX my_index ON my_table USING HNSW (embedding public.vector_cosine_ops)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected GIST after USING (or use USING after column list for MySQL)\",\n    span: 40..44,\n    sql_segment: \"HNSW\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE INDEX the_index_name ON users USING {expected_index_type} (column_name, concat_users_name(first_name, last_name){})",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected GIST after USING (or use USING after column list for MySQL)\",\n    span: 43..44,\n    sql_segment: \"{\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "CREATE INDEX the_index_name ON users USING {expected_index_type} (concat_users_name(first_name, last_name){})",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected GIST after USING (or use USING after column list for MySQL)\",\n    span: 43..44,\n    sql_segment: \"{\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "CREATE LOCAL TEMPORARY TABLE table (COL INT)",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 23..28,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"table\",\n                span: 29..34,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"COL\",\n                    span: 36..39,\n                },\n                data_type: DataType {\n                    identifier: 40..43,\n                    type_: Int(\n                        None,\n                    ),\n                    properties: [],\n                },\n            },\n        ],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..12,\n    sql_segment: \"LOCAL\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"'table' is a reserved identifier use `table`\",\n    span: 29..34,\n    sql_segment: \"table\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE MATERIALIZED VIEW IF NOT EXISTS stats AS SELECT * FROM data",
    "output": "CreateView(\n    CreateView {\n        create_span: 0..6,\n        create_options: [],\n        view_span: 20..24,\n        if_not_exists: Some(\n            25..38,\n        ),\n        name: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"stats\",\n                span: 39..44,\n            },\n        },\n        as_span: 45..47,\n        select: Select(\n            Select {\n                select_span: 48..54,\n                flags: [],\n                select_exprs: [\n                    SelectExpr {\n                        expr: Identifier(\n                            [\n                                Star(\n                                    55..56,\n                                ),\n                            ],\n                        ),\n                        as_: None,\n                    },\n                ],\n                from_span: Some(\n                    57..61,\n                ),\n                table_references: Some(\n                    [\n                        Table {\n                            identifier: QualifiedName {\n                                prefix: [],\n                                identifier: Identifier {\n                                    value: \"data\",\n                                    span: 62..66,\n                                },\n                            },\n                            as_span: None,\n                            as_: None,\n                            index_hints: [],\n                        },\n                    ],\n                ),\n                where_: None,\n                group_by: None,\n                having: None,\n                window_span: None,\n                order_by: None,\n                limit: None,\n                locking: None,\n            },\n        ),\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..19,\n    sql_segment: \"MATERIALIZED\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE MATERIALIZED VIEW user_summary AS SELECT user_id, COUNT(*) FROM orders GROUP BY user_id",
    "output": "CreateView(\n    CreateView {\n        create_span: 0..6,\n        create_options: [],\n        view_span: 20..24,\n        if_not_exists: None,\n        name: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"user_summary\",\n                span: 25..37,\n            },\n        },\n        as_span: 38..40,\n        select: Select(\n            Select {\n                select_span: 41..47,\n                flags: [],\n                select_exprs: [\n                    SelectExpr {\n                        expr: Identifier(\n                            [\n                                Name(\n                                    Identifier {\n                                        value: \"user_id\",\n                                        span: 48..55,\n                                    },\n                                ),\n                            ],\n                        ),\n                        as_: None,\n                    },\n                    SelectExpr {\n                        expr: Count {\n                            count_span: 57..62,\n                            distinct_span: None,\n                            expr: Identifier(\n                                [\n                                    Star(\n                                        63..64,\n                                    ),\n                                ],\n                            ),\n                        },\n                        as_: None,\n                    },\n                ],\n                from_span: Some(\n                    66..70,\n                ),\n                table_references: Some(\n                    [\n                        Table {\n                            identifier: QualifiedName {\n                                prefix: [],\n                                identifier: Identifier {\n                                    value: \"orders\",\n                                    span: 71..77,\n                                },\n                            },\n                            as_span: None,\n                            as_: None,\n                            index_hints: [],\n                        },\n                    ],\n                ),\n                where_: None,\n                group_by: Some(\n                    (\n                        78..86,\n                        [\n                            Identifier(\n                                [\n                                    Name(\n                                        Identifier {\n                                            value: \"user_id\",\n                                            span: 87..94,\n                                        },\n                                    ),\n                                ],\n                            ),\n                        ],\n                    ),\n                ),\n                having: None,\n                window_span: None,\n                order_by: None,\n                limit: None,\n                locking: None,\n            },\n        ),\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..19,\n    sql_segment: \"MATERIALIZED\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE OPERATOR != (FUNCTION = func)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..15,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE OPERATOR + ()",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..15,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "CREATE OPERATOR + (FUNCTION = f, COMMUTATOR = >, NEGATOR = >=)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..15,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE OPERATOR + (FUNCTION = f, COMMUTATOR = OPERATOR(>), NEGATOR = OPERATOR(>=))",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..15,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE OPERATOR + (FUNCTION = f, {field})",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..15,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE OPERATOR + (LEFTARG = INT4)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..15,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE OPERATOR <> (FUNCTION = func)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..15,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE OPERATOR > (()",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..15,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "CREATE OPERATOR > ())",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..15,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "CREATE OPERATOR CLASS CAS_btree_ops DEFAULT FOR TYPE CAS USING btree FAMILY CAS_btree_ops AS OPERATOR 1 <, OPERATOR 2 <=, OPERATOR 3 =, OPERATOR 4 >=, OPERATOR 5 >, FUNCTION 1 cas_cmp(CAS, CAS)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..15,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'AS' here\",\n    span: 57..62,\n    sql_segment: \"USING\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE OPERATOR CLASS gist_ops FOR TYPE geometry USING gist AS OPERATOR 1 <<, FUNCTION 1 gist_consistent(internal, geometry, INT4), STORAGE box",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..15,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'AS' here\",\n    span: 49..54,\n    sql_segment: \"USING\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE OPERATOR CLASS test_ops FOR TYPE INT4 USING btree AS FUNCTION 1 (INT4, INT4) btcmp(INT4, INT4)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..15,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"'INT4' is a reserved identifier use `INT4`\",\n    span: 40..44,\n    sql_segment: \"INT4\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'AS' here\",\n    span: 45..50,\n    sql_segment: \"USING\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE OPERATOR CLASS test_ops FOR TYPE INT4 USING btree AS FUNCTION 1 cas_cmp(()",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..15,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"'INT4' is a reserved identifier use `INT4`\",\n    span: 40..44,\n    sql_segment: \"INT4\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'AS' here\",\n    span: 45..50,\n    sql_segment: \"USING\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "CREATE OPERATOR CLASS test_ops FOR TYPE INT4 USING btree AS FUNCTION 1 my_func",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..15,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"'INT4' is a reserved identifier use `INT4`\",\n    span: 40..44,\n    sql_segment: \"INT4\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'AS' here\",\n    span: 45..50,\n    sql_segment: \"USING\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE OPERATOR CLASS test_ops FOR TYPE INT4 USING btree AS FUNCTION 1 my_func()",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..15,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"'INT4' is a reserved identifier use `INT4`\",\n    span: 40..44,\n    sql_segment: \"INT4\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'AS' here\",\n    span: 45..50,\n    sql_segment: \"USING\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "CREATE OPERATOR CLASS test_ops FOR TYPE INT4 USING gist AS OPERATOR 1 < (INT4, INT4)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..15,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"'INT4' is a reserved identifier use `INT4`\",\n    span: 40..44,\n    sql_segment: \"INT4\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'AS' here\",\n    span: 45..50,\n    sql_segment: \"USING\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE OPERATOR CLASS test_ops FOR TYPE INT4 USING gist AS OPERATOR 1 < FOR SEARCH",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..15,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"'INT4' is a reserved identifier use `INT4`\",\n    span: 40..44,\n    sql_segment: \"INT4\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'AS' here\",\n    span: 45..50,\n    sql_segment: \"USING\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE OPERATOR CLASS test_ops FOR TYPE INT4 USING gist AS OPERATOR 2 <<-> FOR ORDER BY float_ops",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..15,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"'INT4' is a reserved identifier use `INT4`\",\n    span: 40..44,\n    sql_segment: \"INT4\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'AS' here\",\n    span: 45..50,\n    sql_segment: \"USING\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE OPERATOR CLASS {class_name} {default_clause}FOR TYPE INT4 USING btree{family_clause} AS OPERATOR 1 <",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..15,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"'INT4' is a reserved identifier use `INT4`\",\n    span: 60..64,\n    sql_segment: \"INT4\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'AS' here\",\n    span: 65..70,\n    sql_segment: \"USING\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE OPERATOR FAMILY my_family USING {index_method}",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..15,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE OPERATOR FAMILY myschema.test_family USING {index_method}",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..15,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE OPERATOR myschema.@@ (PROCEDURE = myschema.my_proc, LEFTARG = TIMESTAMP WITH TIME ZONE, RIGHTARG = VARCHAR(255), COMMUTATOR = schema.>, NEGATOR = schema.<=, RESTRICT = myschema.sel_func, JOIN = myschema.join_func, HASHES, MERGES)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..15,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE OPERATOR {name} (FUNCTION = f)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..15,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE OPERATOR {op_symbol} (FUNCTION = f)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..15,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE OR REPLACE FUNCTION add(a INTEGER, IN b INTEGER = 1) RETURNS INTEGER LANGUAGE SQL IMMUTABLE PARALLEL RESTRICTED RETURN a + b",
    "output": "CreateFunction(\n    CreateFunction {\n        create_span: 0..6,\n        create_options: [\n            OrReplace(\n                7..17,\n            ),\n        ],\n        function_span: 18..26,\n        if_not_exists: None,\n        name: Identifier {\n            value: \"add\",\n            span: 27..30,\n        },\n        params: [\n            (\n                None,\n                Identifier {\n                    value: \"a\",\n                    span: 31..32,\n                },\n                DataType {\n                    identifier: 33..40,\n                    type_: Integer(\n                        None,\n                    ),\n                    properties: [],\n                },\n            ),\n            (\n                Some(\n                    In(\n                        42..44,\n                    ),\n                ),\n                Identifier {\n                    value: \"b\",\n                    span: 45..46,\n                },\n                DataType {\n                    identifier: 47..54,\n                    type_: Integer(\n                        None,\n                    ),\n                    properties: [],\n                },\n            ),\n        ],\n        returns_span: 60..67,\n        return_type: DataType {\n            identifier: 68..75,\n            type_: Integer(\n                None,\n            ),\n            properties: [],\n        },\n        characteristics: [\n            LanguageSql(\n                76..88,\n            ),\n        ],\n        return_: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"'add' is a reserved identifier use `add`\",\n    span: 27..30,\n    sql_segment: \"add\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected '')'' here\",\n    span: 55..56,\n    sql_segment: \"=\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 89..98,\n    sql_segment: \"IMMUTABLE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE OR REPLACE FUNCTION add(a INTEGER, IN b INTEGER = 1) RETURNS INTEGER LANGUAGE SQL IMMUTABLE RETURNS NULL ON NULL INPUT PARALLEL RESTRICTED RETURN a + b",
    "output": "CreateFunction(\n    CreateFunction {\n        create_span: 0..6,\n        create_options: [\n            OrReplace(\n                7..17,\n            ),\n        ],\n        function_span: 18..26,\n        if_not_exists: None,\n        name: Identifier {\n            value: \"add\",\n            span: 27..30,\n        },\n        params: [\n            (\n                None,\n                Identifier {\n                    value: \"a\",\n                    span: 31..32,\n                },\n                DataType {\n                    identifier: 33..40,\n                    type_: Integer(\n                        None,\n                    ),\n                    properties: [],\n                },\n            ),\n            (\n                Some(\n                    In(\n                        42..44,\n                    ),\n                ),\n                Identifier {\n                    value: \"b\",\n                    span: 45..46,\n                },\n                DataType {\n                    identifier: 47..54,\n                    type_: Integer(\n                        None,\n                    ),\n                    properties: [],\n                },\n            ),\n        ],\n        returns_span: 60..67,\n        return_type: DataType {\n            identifier: 68..75,\n            type_: Integer(\n                None,\n            ),\n            properties: [],\n        },\n        characteristics: [\n            LanguageSql(\n                76..88,\n            ),\n        ],\n        return_: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"'add' is a reserved identifier use `add`\",\n    span: 27..30,\n    sql_segment: \"add\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected '')'' here\",\n    span: 55..56,\n    sql_segment: \"=\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 89..98,\n    sql_segment: \"IMMUTABLE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE OR REPLACE FUNCTION add(a INTEGER, IN b INTEGER = 1) RETURNS INTEGER LANGUAGE SQL STABLE CALLED ON NULL INPUT PARALLEL UNSAFE RETURN a + b",
    "output": "CreateFunction(\n    CreateFunction {\n        create_span: 0..6,\n        create_options: [\n            OrReplace(\n                7..17,\n            ),\n        ],\n        function_span: 18..26,\n        if_not_exists: None,\n        name: Identifier {\n            value: \"add\",\n            span: 27..30,\n        },\n        params: [\n            (\n                None,\n                Identifier {\n                    value: \"a\",\n                    span: 31..32,\n                },\n                DataType {\n                    identifier: 33..40,\n                    type_: Integer(\n                        None,\n                    ),\n                    properties: [],\n                },\n            ),\n            (\n                Some(\n                    In(\n                        42..44,\n                    ),\n                ),\n                Identifier {\n                    value: \"b\",\n                    span: 45..46,\n                },\n                DataType {\n                    identifier: 47..54,\n                    type_: Integer(\n                        None,\n                    ),\n                    properties: [],\n                },\n            ),\n        ],\n        returns_span: 60..67,\n        return_type: DataType {\n            identifier: 68..75,\n            type_: Integer(\n                None,\n            ),\n            properties: [],\n        },\n        characteristics: [\n            LanguageSql(\n                76..88,\n            ),\n        ],\n        return_: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"'add' is a reserved identifier use `add`\",\n    span: 27..30,\n    sql_segment: \"add\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected '')'' here\",\n    span: 55..56,\n    sql_segment: \"=\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 89..95,\n    sql_segment: \"STABLE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE OR REPLACE FUNCTION add(a INTEGER, IN b INTEGER = 1) RETURNS INTEGER LANGUAGE SQL STABLE PARALLEL UNSAFE RETURN a + b",
    "output": "CreateFunction(\n    CreateFunction {\n        create_span: 0..6,\n        create_options: [\n            OrReplace(\n                7..17,\n            ),\n        ],\n        function_span: 18..26,\n        if_not_exists: None,\n        name: Identifier {\n            value: \"add\",\n            span: 27..30,\n        },\n        params: [\n            (\n                None,\n                Identifier {\n                    value: \"a\",\n                    span: 31..32,\n                },\n                DataType {\n                    identifier: 33..40,\n                    type_: Integer(\n                        None,\n                    ),\n                    properties: [],\n                },\n            ),\n            (\n                Some(\n                    In(\n                        42..44,\n                    ),\n                ),\n                Identifier {\n                    value: \"b\",\n                    span: 45..46,\n                },\n                DataType {\n                    identifier: 47..54,\n                    type_: Integer(\n                        None,\n                    ),\n                    properties: [],\n                },\n            ),\n        ],\n        returns_span: 60..67,\n        return_type: DataType {\n            identifier: 68..75,\n            type_: Integer(\n                None,\n            ),\n            properties: [],\n        },\n        characteristics: [\n            LanguageSql(\n                76..88,\n            ),\n        ],\n        return_: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"'add' is a reserved identifier use `add`\",\n    span: 27..30,\n    sql_segment: \"add\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected '')'' here\",\n    span: 55..56,\n    sql_segment: \"=\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 89..95,\n    sql_segment: \"STABLE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE OR REPLACE FUNCTION check_not_zero(int1 INT) RETURNS BOOLEAN LANGUAGE plpgsql AS $$\nBEGIN\n    IF int1 <> 0 THEN\n        RETURN TRUE;\n    ELSE\n        RETURN FALSE;\n    END IF;\nEND;\n$$",
    "output": "CreateFunction(\n    CreateFunction {\n        create_span: 0..6,\n        create_options: [\n            OrReplace(\n                7..17,\n            ),\n        ],\n        function_span: 18..26,\n        if_not_exists: None,\n        name: Identifier {\n            value: \"check_not_zero\",\n            span: 27..41,\n        },\n        params: [\n            (\n                None,\n                Identifier {\n                    value: \"int1\",\n                    span: 42..46,\n                },\n                DataType {\n                    identifier: 47..50,\n                    type_: Int(\n                        None,\n                    ),\n                    properties: [],\n                },\n            ),\n        ],\n        returns_span: 52..59,\n        return_type: DataType {\n            identifier: 60..67,\n            type_: Boolean,\n            properties: [],\n        },\n        characteristics: [\n            LanguagePlpgsql(\n                68..84,\n            ),\n        ],\n        return_: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"'int1' is a reserved identifier use `int1`\",\n    span: 42..46,\n    sql_segment: \"int1\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 85..87,\n    sql_segment: \"AS\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE OR REPLACE FUNCTION check_strings_different(str1 VARCHAR, str2 VARCHAR) RETURNS BOOLEAN LANGUAGE plpgsql AS $$\nBEGIN\n    IF str1 <> str2 THEN\n        RETURN TRUE;\n    ELSE\n        RETURN FALSE;\n    END IF;\nEND;\n$$",
    "output": "CreateFunction(\n    CreateFunction {\n        create_span: 0..6,\n        create_options: [\n            OrReplace(\n                7..17,\n            ),\n        ],\n        function_span: 18..26,\n        if_not_exists: None,\n        name: Identifier {\n            value: \"check_strings_different\",\n            span: 27..50,\n        },\n        params: [\n            (\n                None,\n                Identifier {\n                    value: \"str1\",\n                    span: 51..55,\n                },\n                DataType {\n                    identifier: 56..63,\n                    type_: VarChar(\n                        None,\n                    ),\n                    properties: [],\n                },\n            ),\n            (\n                None,\n                Identifier {\n                    value: \"str2\",\n                    span: 65..69,\n                },\n                DataType {\n                    identifier: 70..77,\n                    type_: VarChar(\n                        None,\n                    ),\n                    properties: [],\n                },\n            ),\n        ],\n        returns_span: 79..86,\n        return_type: DataType {\n            identifier: 87..94,\n            type_: Boolean,\n            properties: [],\n        },\n        characteristics: [\n            LanguagePlpgsql(\n                95..111,\n            ),\n        ],\n        return_: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 112..114,\n    sql_segment: \"AS\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE OR REPLACE FUNCTION check_values_different(a INT, b INT) RETURNS BOOLEAN LANGUAGE plpgsql AS $$\nBEGIN\n    IF a <> b THEN\n        RETURN TRUE;\n    ELSE\n        RETURN FALSE;\n    END IF;\nEND;\n$$",
    "output": "CreateFunction(\n    CreateFunction {\n        create_span: 0..6,\n        create_options: [\n            OrReplace(\n                7..17,\n            ),\n        ],\n        function_span: 18..26,\n        if_not_exists: None,\n        name: Identifier {\n            value: \"check_values_different\",\n            span: 27..49,\n        },\n        params: [\n            (\n                None,\n                Identifier {\n                    value: \"a\",\n                    span: 50..51,\n                },\n                DataType {\n                    identifier: 52..55,\n                    type_: Int(\n                        None,\n                    ),\n                    properties: [],\n                },\n            ),\n            (\n                None,\n                Identifier {\n                    value: \"b\",\n                    span: 57..58,\n                },\n                DataType {\n                    identifier: 59..62,\n                    type_: Int(\n                        None,\n                    ),\n                    properties: [],\n                },\n            ),\n        ],\n        returns_span: 64..71,\n        return_type: DataType {\n            identifier: 72..79,\n            type_: Boolean,\n            properties: [],\n        },\n        characteristics: [\n            LanguagePlpgsql(\n                80..96,\n            ),\n        ],\n        return_: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 97..99,\n    sql_segment: \"AS\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE OR REPLACE FUNCTION check_values_different(int1 INT, int2 INT) RETURNS BOOLEAN LANGUAGE plpgsql AS $$\nBEGIN\n    IF int1 <> int2 THEN\n        RETURN TRUE;\n    ELSE\n        RETURN FALSE;\n    END IF;\nEND;\n$$",
    "output": "CreateFunction(\n    CreateFunction {\n        create_span: 0..6,\n        create_options: [\n            OrReplace(\n                7..17,\n            ),\n        ],\n        function_span: 18..26,\n        if_not_exists: None,\n        name: Identifier {\n            value: \"check_values_different\",\n            span: 27..49,\n        },\n        params: [\n            (\n                None,\n                Identifier {\n                    value: \"int1\",\n                    span: 50..54,\n                },\n                DataType {\n                    identifier: 55..58,\n                    type_: Int(\n                        None,\n                    ),\n                    properties: [],\n                },\n            ),\n            (\n                None,\n                Identifier {\n                    value: \"int2\",\n                    span: 60..64,\n                },\n                DataType {\n                    identifier: 65..68,\n                    type_: Int(\n                        None,\n                    ),\n                    properties: [],\n                },\n            ),\n        ],\n        returns_span: 70..77,\n        return_type: DataType {\n            identifier: 78..85,\n            type_: Boolean,\n            properties: [],\n        },\n        characteristics: [\n            LanguagePlpgsql(\n                86..102,\n            ),\n        ],\n        return_: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"'int1' is a reserved identifier use `int1`\",\n    span: 50..54,\n    sql_segment: \"int1\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"'int2' is a reserved identifier use `int2`\",\n    span: 60..64,\n    sql_segment: \"int2\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 103..105,\n    sql_segment: \"AS\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE OR REPLACE FUNCTION foo(a TIMESTAMP WITH TIME ZONE, b VARCHAR) RETURNS BOOLEAN LANGUAGE plpgsql AS $$\n    BEGIN\n        RETURN TRUE;\n    END;\n    $$",
    "output": "CreateFunction(\n    CreateFunction {\n        create_span: 0..6,\n        create_options: [\n            OrReplace(\n                7..17,\n            ),\n        ],\n        function_span: 18..26,\n        if_not_exists: None,\n        name: Identifier {\n            value: \"foo\",\n            span: 27..30,\n        },\n        params: [\n            (\n                None,\n                Identifier {\n                    value: \"a\",\n                    span: 31..32,\n                },\n                DataType {\n                    identifier: 33..42,\n                    type_: Timestamp(\n                        Timestamp {\n                            width: None,\n                            with_time_zone: Some(\n                                43..57,\n                            ),\n                        },\n                    ),\n                    properties: [],\n                },\n            ),\n            (\n                None,\n                Identifier {\n                    value: \"b\",\n                    span: 59..60,\n                },\n                DataType {\n                    identifier: 61..68,\n                    type_: VarChar(\n                        None,\n                    ),\n                    properties: [],\n                },\n            ),\n        ],\n        returns_span: 70..77,\n        return_type: DataType {\n            identifier: 78..85,\n            type_: Boolean,\n            properties: [],\n        },\n        characteristics: [\n            LanguagePlpgsql(\n                86..102,\n            ),\n        ],\n        return_: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 103..105,\n    sql_segment: \"AS\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE OR REPLACE FUNCTION increment(i INTEGER) RETURNS INTEGER LANGUAGE plpgsql AS $$ BEGIN RETURN i + 1; END; $$",
    "output": "CreateFunction(\n    CreateFunction {\n        create_span: 0..6,\n        create_options: [\n            OrReplace(\n                7..17,\n            ),\n        ],\n        function_span: 18..26,\n        if_not_exists: None,\n        name: Identifier {\n            value: \"increment\",\n            span: 27..36,\n        },\n        params: [\n            (\n                None,\n                Identifier {\n                    value: \"i\",\n                    span: 37..38,\n                },\n                DataType {\n                    identifier: 39..46,\n                    type_: Integer(\n                        None,\n                    ),\n                    properties: [],\n                },\n            ),\n        ],\n        returns_span: 48..55,\n        return_type: DataType {\n            identifier: 56..63,\n            type_: Integer(\n                None,\n            ),\n            properties: [],\n        },\n        characteristics: [\n            LanguagePlpgsql(\n                64..80,\n            ),\n        ],\n        return_: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 81..83,\n    sql_segment: \"AS\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE OR REPLACE FUNCTION no_arg() RETURNS VOID LANGUAGE plpgsql AS $$ BEGIN DELETE FROM my_table; END; $$",
    "output": "CreateFunction(\n    CreateFunction {\n        create_span: 0..6,\n        create_options: [\n            OrReplace(\n                7..17,\n            ),\n        ],\n        function_span: 18..26,\n        if_not_exists: None,\n        name: Identifier {\n            value: \"no_arg\",\n            span: 27..33,\n        },\n        params: [],\n        returns_span: 36..43,\n        return_type: DataType {\n            identifier: 44..48,\n            type_: Named(\n                44..48,\n            ),\n            properties: [],\n        },\n        characteristics: [\n            LanguagePlpgsql(\n                49..65,\n            ),\n        ],\n        return_: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'identifier' here\",\n    span: 34..35,\n    sql_segment: \")\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 66..68,\n    sql_segment: \"AS\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "CREATE OR REPLACE FUNCTION return_table(i INTEGER) RETURNS TABLE(id UUID, is_active BOOLEAN) LANGUAGE plpgsql AS $$ BEGIN RETURN QUERY SELECT NULL::UUID, NULL::BOOLEAN; END; $$",
    "output": "CreateFunction(\n    CreateFunction {\n        create_span: 0..6,\n        create_options: [\n            OrReplace(\n                7..17,\n            ),\n        ],\n        function_span: 18..26,\n        if_not_exists: None,\n        name: Identifier {\n            value: \"return_table\",\n            span: 27..39,\n        },\n        params: [\n            (\n                None,\n                Identifier {\n                    value: \"i\",\n                    span: 40..41,\n                },\n                DataType {\n                    identifier: 42..49,\n                    type_: Integer(\n                        None,\n                    ),\n                    properties: [],\n                },\n            ),\n        ],\n        returns_span: 51..58,\n        return_type: DataType {\n            identifier: 59..64,\n            type_: Named(\n                59..64,\n            ),\n            properties: [],\n        },\n        characteristics: [],\n        return_: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 64..65,\n    sql_segment: \"(\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE ROLE IF NOT EXISTS mysql_a, mysql_b",
    "output": "CreateRole(\n    CreateRole {\n        create_span: 0..6,\n        role_span: 7..11,\n        if_not_exists: Some(\n            12..25,\n        ),\n        role_names: [\n            Identifier {\n                value: \"mysql_a\",\n                span: 26..33,\n            },\n            Identifier {\n                value: \"mysql_b\",\n                span: 35..42,\n            },\n        ],\n        with_span: None,\n        options: [],\n        memberships: [],\n    },\n)",
    "issues": []
  },
  {
    "input": "CREATE ROLE abc LOGIN PASSWORD NULL",
    "output": "CreateRole(\n    CreateRole {\n        create_span: 0..6,\n        role_span: 7..11,\n        if_not_exists: None,\n        role_names: [\n            Identifier {\n                value: \"abc\",\n                span: 12..15,\n            },\n        ],\n        with_span: None,\n        options: [\n            Login(\n                16..21,\n            ),\n            PasswordNull(\n                22..30,\n            ),\n        ],\n        memberships: [],\n    },\n)",
    "issues": []
  },
  {
    "input": "CREATE ROLE abc WITH LOGIN PASSWORD NULL",
    "output": "CreateRole(\n    CreateRole {\n        create_span: 0..6,\n        role_span: 7..11,\n        if_not_exists: None,\n        role_names: [\n            Identifier {\n                value: \"abc\",\n                span: 12..15,\n            },\n        ],\n        with_span: Some(\n            16..20,\n        ),\n        options: [\n            Login(\n                21..26,\n            ),\n            PasswordNull(\n                27..35,\n            ),\n        ],\n        memberships: [],\n    },\n)",
    "issues": []
  },
  {
    "input": "CREATE ROLE abc WITH USER foo, bar ROLE baz",
    "output": "CreateRole(\n    CreateRole {\n        create_span: 0..6,\n        role_span: 7..11,\n        if_not_exists: None,\n        role_names: [\n            Identifier {\n                value: \"abc\",\n                span: 12..15,\n            },\n        ],\n        with_span: Some(\n            16..20,\n        ),\n        options: [],\n        memberships: [\n            RoleMembership {\n                type_: User(\n                    21..25,\n                ),\n                roles: [\n                    Identifier {\n                        value: \"foo\",\n                        span: 26..29,\n                    },\n                    Identifier {\n                        value: \"bar\",\n                        span: 31..34,\n                    },\n                ],\n            },\n            RoleMembership {\n                type_: Role(\n                    35..39,\n                ),\n                roles: [\n                    Identifier {\n                        value: \"baz\",\n                        span: 40..43,\n                    },\n                ],\n            },\n        ],\n    },\n)",
    "issues": []
  },
  {
    "input": "CREATE ROLE abc {negatable_kw} NO{negatable_kw}",
    "output": "CreateRole(\n    CreateRole {\n        create_span: 0..6,\n        role_span: 7..11,\n        if_not_exists: None,\n        role_names: [\n            Identifier {\n                value: \"abc\",\n                span: 12..15,\n            },\n        ],\n        with_span: None,\n        options: [],\n        memberships: [],\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 16..17,\n    sql_segment: \"{\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE ROLE magician WITH SUPERUSER CREATEROLE NOCREATEDB BYPASSRLS INHERIT PASSWORD 'abcdef' LOGIN VALID UNTIL '2025-01-01' IN ROLE role1, role2 ROLE role3 ADMIN role4, role5 REPLICATION",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expression should not follow expression\",\n    span: 100..105,\n    sql_segment: \"VALID\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE SCHEMA IF NOT EXISTS schema_name",
    "output": "CreateDatabase(\n    CreateDatabase {\n        create_span: 0..6,\n        database_span: 7..13,\n        if_not_exists: Some(\n            14..27,\n        ),\n        name: Identifier {\n            value: \"schema_name\",\n            span: 28..39,\n        },\n        create_options: [],\n    },\n)",
    "issues": []
  },
  {
    "input": "CREATE SEQUENCE  IF NOT EXISTS  name0",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..15,\n    sql_segment: \"SEQUENCE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE SEQUENCE  name0",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..15,\n    sql_segment: \"SEQUENCE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE SEQUENCE IF NOT EXISTS name0",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..15,\n    sql_segment: \"SEQUENCE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE SEQUENCE IF NOT EXISTS name2 AS BIGINT INCREMENT 1 MINVALUE 1 MAXVALUE 20 START WITH 10 CACHE 2 NO CYCLE",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..15,\n    sql_segment: \"SEQUENCE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE SEQUENCE foo INCREMENT 1 NO MINVALUE NO",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..15,\n    sql_segment: \"SEQUENCE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE SEQUENCE name0",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..15,\n    sql_segment: \"SEQUENCE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE SEQUENCE name4 AS BIGINT INCREMENT -15 MINVALUE -2000 MAXVALUE -50 START WITH -60",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..15,\n    sql_segment: \"SEQUENCE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE SEQUENCE name5 AS BIGINT INCREMENT +10 MINVALUE +30 MAXVALUE +5000 START WITH +45",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..15,\n    sql_segment: \"SEQUENCE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE SERVER IF NOT EXISTS myserver TYPE 'server_type' VERSION 'server_version' FOREIGN DATA WRAPPER postgres_fdw",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..13,\n    sql_segment: \"SERVER\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'identifier' here\",\n    span: 42..55,\n    sql_segment: \"'server_type'\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE SERVER myserver FOREIGN DATA WRAPPER postgres_fdw",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..13,\n    sql_segment: \"SERVER\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE SERVER myserver2 FOREIGN DATA WRAPPER postgres_fdw OPTIONS (host 'foo', dbname 'foodb', port '5432')",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 7..13,\n    sql_segment: \"SERVER\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TABLE \"foo\" (\"bar\" \"int\")",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"foo\",\n                span: 13..18,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'identifier' here\",\n    span: 20..25,\n    sql_segment: \"\\\"bar\\\"\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TABLE IF EXISTS uk_cities ()",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"\",\n                span: 0..0,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'NOT' here\",\n    span: 16..22,\n    sql_segment: \"EXISTS\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "CREATE TABLE IF NOT EXISTS uk_cities ()",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"uk_cities\",\n                span: 27..36,\n            },\n        },\n        if_not_exists: Some(\n            13..26,\n        ),\n        create_definitions: [],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "CREATE TABLE IF NOT uk_cities ()",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"\",\n                span: 0..0,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'EXISTS' here\",\n    span: 20..29,\n    sql_segment: \"uk_cities\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "CREATE TABLE IF uk_cities ()",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"\",\n                span: 0..0,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'NOT' here\",\n    span: 16..25,\n    sql_segment: \"uk_cities\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "CREATE TABLE NOT EXISTS uk_cities ()",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"NOT\",\n                span: 13..16,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"'NOT' is a reserved identifier use `NOT`\",\n    span: 13..16,\n    sql_segment: \"NOT\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected ''('' here\",\n    span: 17..23,\n    sql_segment: \"EXISTS\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "CREATE TABLE arr_test (id INT, tags TEXT[])",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"arr_test\",\n                span: 13..21,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"id\",\n                    span: 23..25,\n                },\n                data_type: DataType {\n                    identifier: 26..29,\n                    type_: Int(\n                        None,\n                    ),\n                    properties: [],\n                },\n            },\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"tags\",\n                    span: 31..35,\n                },\n                data_type: DataType {\n                    identifier: 36..42,\n                    type_: Array(\n                        Text(\n                            None,\n                        ),\n                        40..42,\n                    ),\n                    properties: [],\n                },\n            },\n        ],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "CREATE TABLE child_table (child_column INT) INHERITS ()",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"child_table\",\n                span: 13..24,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"child_column\",\n                    span: 26..38,\n                },\n                data_type: DataType {\n                    identifier: 39..42,\n                    type_: Int(\n                        None,\n                    ),\n                    properties: [],\n                },\n            },\n        ],\n        options: [\n            Inherits {\n                identifier: 44..52,\n                value: [],\n            },\n        ],\n        table_as: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'identifier' here\",\n    span: 54..55,\n    sql_segment: \")\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "CREATE TABLE child_table (child_column INT) INHERITS (public.parent_table)",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"child_table\",\n                span: 13..24,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"child_column\",\n                    span: 26..38,\n                },\n                data_type: DataType {\n                    identifier: 39..42,\n                    type_: Int(\n                        None,\n                    ),\n                    properties: [],\n                },\n            },\n        ],\n        options: [\n            Inherits {\n                identifier: 44..52,\n                value: [\n                    QualifiedName {\n                        prefix: [\n                            (\n                                Identifier {\n                                    value: \"public\",\n                                    span: 54..60,\n                                },\n                                60..61,\n                            ),\n                        ],\n                        identifier: Identifier {\n                            value: \"parent_table\",\n                            span: 61..73,\n                        },\n                    },\n                ],\n            },\n        ],\n        table_as: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "CREATE TABLE child_table (child_column INT) INHERITS (public.parent_table, pg_catalog.pg_settings)",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"child_table\",\n                span: 13..24,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"child_column\",\n                    span: 26..38,\n                },\n                data_type: DataType {\n                    identifier: 39..42,\n                    type_: Int(\n                        None,\n                    ),\n                    properties: [],\n                },\n            },\n        ],\n        options: [\n            Inherits {\n                identifier: 44..52,\n                value: [\n                    QualifiedName {\n                        prefix: [\n                            (\n                                Identifier {\n                                    value: \"public\",\n                                    span: 54..60,\n                                },\n                                60..61,\n                            ),\n                        ],\n                        identifier: Identifier {\n                            value: \"parent_table\",\n                            span: 61..73,\n                        },\n                    },\n                    QualifiedName {\n                        prefix: [\n                            (\n                                Identifier {\n                                    value: \"pg_catalog\",\n                                    span: 75..85,\n                                },\n                                85..86,\n                            ),\n                        ],\n                        identifier: Identifier {\n                            value: \"pg_settings\",\n                            span: 86..97,\n                        },\n                    },\n                ],\n            },\n        ],\n        table_as: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "CREATE TABLE emp (\n        empname           text,\n        salary            integer,\n        last_date         timestamp,\n        last_user         text\n    );",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"emp\",\n                span: 13..16,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"empname\",\n                    span: 27..34,\n                },\n                data_type: DataType {\n                    identifier: 45..49,\n                    type_: Text(\n                        None,\n                    ),\n                    properties: [],\n                },\n            },\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"salary\",\n                    span: 59..65,\n                },\n                data_type: DataType {\n                    identifier: 77..84,\n                    type_: Integer(\n                        None,\n                    ),\n                    properties: [],\n                },\n            },\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"last_date\",\n                    span: 94..103,\n                },\n                data_type: DataType {\n                    identifier: 112..121,\n                    type_: Timestamp(\n                        Timestamp {\n                            width: None,\n                            with_time_zone: None,\n                        },\n                    ),\n                    properties: [],\n                },\n            },\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"last_user\",\n                    span: 131..140,\n                },\n                data_type: DataType {\n                    identifier: 149..153,\n                    type_: Text(\n                        None,\n                    ),\n                    properties: [],\n                },\n            },\n        ],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 159..160,\n    sql_segment: \";\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TABLE foo (x TSQUERY)",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"foo\",\n                span: 13..16,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"x\",\n                    span: 18..19,\n                },\n                data_type: DataType {\n                    identifier: 20..27,\n                    type_: Named(\n                        20..27,\n                    ),\n                    properties: [],\n                },\n            },\n        ],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "CREATE TABLE foo (x TSVECTOR)",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"foo\",\n                span: 13..16,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"x\",\n                    span: 18..19,\n                },\n                data_type: DataType {\n                    identifier: 20..28,\n                    type_: Named(\n                        20..28,\n                    ),\n                    properties: [],\n                },\n            },\n        ],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "CREATE TABLE foo (x VARBIT, y VARBIT(42))",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"foo\",\n                span: 13..16,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"x\",\n                    span: 18..19,\n                },\n                data_type: DataType {\n                    identifier: 20..26,\n                    type_: VarBit(\n                        None,\n                    ),\n                    properties: [],\n                },\n            },\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"y\",\n                    span: 28..29,\n                },\n                data_type: DataType {\n                    identifier: 30..36,\n                    type_: VarBit(\n                        Some(\n                            (\n                                42,\n                                37..39,\n                            ),\n                        ),\n                    ),\n                    properties: [],\n                },\n            },\n        ],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "CREATE TABLE measurement_y2006m02 PARTITION OF measurement FOR VALUES FROM ('2006-02-01') TO ('2006-03-01')",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"measurement_y2006m02\",\n                span: 13..33,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''('' here\",\n    span: 34..43,\n    sql_segment: \"PARTITION\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'identifier' here\",\n    span: 76..88,\n    sql_segment: \"'2006-02-01'\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'table option or delimiter' here\",\n    span: 90..92,\n    sql_segment: \"TO\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TABLE new_users AS SELECT * FROM users WHERE active = true",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''('' here\",\n    span: 23..25,\n    sql_segment: \"AS\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TABLE orders (order_id INT REFERENCES another_table (id) MATCH FULL ON DELETE CASCADE ON UPDATE RESTRICT, customer_id INT, CONSTRAINT fk_customer FOREIGN KEY (customer_id) REFERENCES customers(customer_id) MATCH SIMPLE ON DELETE SET NULL ON UPDATE CASCADE)",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"orders\",\n                span: 13..19,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"order_id\",\n                    span: 21..29,\n                },\n                data_type: DataType {\n                    identifier: 30..33,\n                    type_: Int(\n                        None,\n                    ),\n                    properties: [],\n                },\n            },\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"customer_id\",\n                    span: 113..124,\n                },\n                data_type: DataType {\n                    identifier: 125..128,\n                    type_: Int(\n                        None,\n                    ),\n                    properties: [],\n                },\n            },\n            ForeignKeyDefinition {\n                constraint_span: Some(\n                    130..140,\n                ),\n                constraint_symbol: Some(\n                    Identifier {\n                        value: \"fk_customer\",\n                        span: 141..152,\n                    },\n                ),\n                foreign_key_span: 153..164,\n                index_name: None,\n                cols: [\n                    IndexCol {\n                        expr: Column(\n                            Identifier {\n                                value: \"customer_id\",\n                                span: 166..177,\n                            },\n                        ),\n                        size: None,\n                        asc: None,\n                        desc: None,\n                    },\n                ],\n                references_span: 179..189,\n                references_table: Identifier {\n                    value: \"customers\",\n                    span: 190..199,\n                },\n                references_cols: [\n                    Identifier {\n                        value: \"customer_id\",\n                        span: 200..211,\n                    },\n                ],\n                ons: [],\n            },\n        ],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected '')' or ','' here\",\n    span: 34..44,\n    sql_segment: \"REFERENCES\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected '')' or ','' here\",\n    span: 213..218,\n    sql_segment: \"MATCH\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TABLE orders_default PARTITION OF orders DEFAULT",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''('' here\",\n    span: 28..37,\n    sql_segment: \"PARTITION\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TABLE orders_new PARTITION OF orders FOR VALUES FROM ('2024-01-01') TO (MAXVALUE)",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"orders_new\",\n                span: 13..23,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''('' here\",\n    span: 24..33,\n    sql_segment: \"PARTITION\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'identifier' here\",\n    span: 61..73,\n    sql_segment: \"'2024-01-01'\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'table option or delimiter' here\",\n    span: 75..77,\n    sql_segment: \"TO\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TABLE orders_old PARTITION OF orders FOR VALUES FROM (MINVALUE) TO ('2020-01-01')",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"orders_old\",\n                span: 13..23,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''('' here\",\n    span: 24..33,\n    sql_segment: \"PARTITION\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'type' here\",\n    span: 69..70,\n    sql_segment: \")\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'table option or delimiter' here\",\n    span: 71..73,\n    sql_segment: \"TO\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TABLE orders_p0 PARTITION OF orders FOR VALUES WITH (MODULUS 4, REMAINDER 0)",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"orders_p0\",\n                span: 13..22,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''('' here\",\n    span: 23..32,\n    sql_segment: \"PARTITION\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'type' here\",\n    span: 68..69,\n    sql_segment: \"4\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'type' here\",\n    span: 81..82,\n    sql_segment: \"0\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TABLE orders_us PARTITION OF orders FOR VALUES IN ('US', 'CA', 'MX')",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"orders_us\",\n                span: 13..22,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''('' here\",\n    span: 23..32,\n    sql_segment: \"PARTITION\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'identifier' here\",\n    span: 58..62,\n    sql_segment: \"'US'\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'identifier' here\",\n    span: 64..68,\n    sql_segment: \"'CA'\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'identifier' here\",\n    span: 70..74,\n    sql_segment: \"'MX'\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TABLE p PARTITION OF parent",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''('' here\",\n    span: 15..24,\n    sql_segment: \"PARTITION\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TABLE p PARTITION OF parent FOR VALUES FROM () TO (10)",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"p\",\n                span: 13..14,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''('' here\",\n    span: 15..24,\n    sql_segment: \"PARTITION\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'table option or delimiter' here\",\n    span: 54..56,\n    sql_segment: \"TO\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "CREATE TABLE p PARTITION OF parent FOR VALUES FROM (1)",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"p\",\n                span: 13..14,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''('' here\",\n    span: 15..24,\n    sql_segment: \"PARTITION\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'identifier' here\",\n    span: 52..53,\n    sql_segment: \"1\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TABLE p PARTITION OF parent FOR VALUES FROM (1) TO ()",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"p\",\n                span: 13..14,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''('' here\",\n    span: 15..24,\n    sql_segment: \"PARTITION\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'identifier' here\",\n    span: 52..53,\n    sql_segment: \"1\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'table option or delimiter' here\",\n    span: 55..57,\n    sql_segment: \"TO\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "CREATE TABLE p PARTITION OF parent FOR VALUES IN ()",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"p\",\n                span: 13..14,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''('' here\",\n    span: 15..24,\n    sql_segment: \"PARTITION\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "CREATE TABLE p PARTITION OF parent FOR VALUES RANGE (1, 10)",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"p\",\n                span: 13..14,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''('' here\",\n    span: 15..24,\n    sql_segment: \"PARTITION\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'identifier' here\",\n    span: 53..54,\n    sql_segment: \"1\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'identifier' here\",\n    span: 56..58,\n    sql_segment: \"10\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TABLE p PARTITION OF parent WITH (fillfactor = 70)",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"p\",\n                span: 13..14,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''('' here\",\n    span: 15..24,\n    sql_segment: \"PARTITION\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'type' here\",\n    span: 52..53,\n    sql_segment: \"=\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TABLE sales_2023_q1 PARTITION OF sales FOR VALUES FROM ('2023-01-01', 1) TO ('2023-04-01', 1)",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"sales_2023_q1\",\n                span: 13..26,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''('' here\",\n    span: 27..36,\n    sql_segment: \"PARTITION\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'identifier' here\",\n    span: 63..75,\n    sql_segment: \"'2023-01-01'\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'identifier' here\",\n    span: 77..78,\n    sql_segment: \"1\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'table option or delimiter' here\",\n    span: 80..82,\n    sql_segment: \"TO\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TABLE t ()",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"t\",\n                span: 13..14,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "CREATE TABLE t (CONSTRAINT positive CHECK (2 > 1))",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"t\",\n                span: 13..14,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [\n            CheckConstraintDefinition {\n                constraint_span: Some(\n                    16..26,\n                ),\n                constraint_symbol: Some(\n                    Identifier {\n                        value: \"positive\",\n                        span: 27..35,\n                    },\n                ),\n                check_span: 36..41,\n                expression: Binary {\n                    op: Gt,\n                    op_span: 45..46,\n                    lhs: Integer(\n                        (\n                            2,\n                            43..44,\n                        ),\n                    ),\n                    rhs: Integer(\n                        (\n                            1,\n                            47..48,\n                        ),\n                    ),\n                },\n                enforced: None,\n            },\n        ],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "CREATE TABLE t (c INT) WITH (foo = 'bar', a = 123)",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"t\",\n                span: 13..14,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"c\",\n                    span: 16..17,\n                },\n                data_type: DataType {\n                    identifier: 18..21,\n                    type_: Int(\n                        None,\n                    ),\n                    properties: [],\n                },\n            },\n        ],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'table option or delimiter' here\",\n    span: 23..27,\n    sql_segment: \"WITH\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TABLE t (c TEXT DEFAULT (foo())::INT::TEXT)",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"t\",\n                span: 13..14,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"c\",\n                    span: 16..17,\n                },\n                data_type: DataType {\n                    identifier: 18..22,\n                    type_: Text(\n                        None,\n                    ),\n                    properties: [\n                        Default(\n                            Function(\n                                Other(\n                                    \"foo\",\n                                ),\n                                [],\n                                32..35,\n                            ),\n                        ),\n                    ],\n                },\n            },\n        ],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected '')' or ','' here\",\n    span: 38..40,\n    sql_segment: \"::\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "CREATE TABLE t (c TEXT DEFAULT (foo())::TEXT NOT NULL)",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"t\",\n                span: 13..14,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"c\",\n                    span: 16..17,\n                },\n                data_type: DataType {\n                    identifier: 18..22,\n                    type_: Text(\n                        None,\n                    ),\n                    properties: [\n                        Default(\n                            Function(\n                                Other(\n                                    \"foo\",\n                                ),\n                                [],\n                                32..35,\n                            ),\n                        ),\n                    ],\n                },\n            },\n        ],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected '')' or ','' here\",\n    span: 38..40,\n    sql_segment: \"::\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "CREATE TABLE t (c TEXT DEFAULT (foo())::TEXT)",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"t\",\n                span: 13..14,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"c\",\n                    span: 16..17,\n                },\n                data_type: DataType {\n                    identifier: 18..22,\n                    type_: Text(\n                        None,\n                    ),\n                    properties: [\n                        Default(\n                            Function(\n                                Other(\n                                    \"foo\",\n                                ),\n                                [],\n                                32..35,\n                            ),\n                        ),\n                    ],\n                },\n            },\n        ],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected '')' or ','' here\",\n    span: 38..40,\n    sql_segment: \"::\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "CREATE TABLE t (i INTERVAL {field}({p}))",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"t\",\n                span: 13..14,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"i\",\n                    span: 16..17,\n                },\n                data_type: DataType {\n                    identifier: 18..26,\n                    type_: Named(\n                        18..26,\n                    ),\n                    properties: [],\n                },\n            },\n        ],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected '')' or ','' here\",\n    span: 27..28,\n    sql_segment: \"{\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TABLE t (i INTERVAL {field})",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"t\",\n                span: 13..14,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"i\",\n                    span: 16..17,\n                },\n                data_type: DataType {\n                    identifier: 18..26,\n                    type_: Named(\n                        18..26,\n                    ),\n                    properties: [],\n                },\n            },\n        ],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected '')' or ','' here\",\n    span: 27..28,\n    sql_segment: \"{\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TABLE t (i INTERVAL({p}))",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"t\",\n                span: 13..14,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"i\",\n                    span: 16..17,\n                },\n                data_type: DataType {\n                    identifier: 18..26,\n                    type_: Named(\n                        18..26,\n                    ),\n                    properties: [],\n                },\n            },\n        ],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected '')' or ','' here\",\n    span: 26..27,\n    sql_segment: \"(\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TABLE t (i INTERVAL)",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"t\",\n                span: 13..14,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"i\",\n                    span: 16..17,\n                },\n                data_type: DataType {\n                    identifier: 18..26,\n                    type_: Named(\n                        18..26,\n                    ),\n                    properties: [],\n                },\n            },\n        ],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "CREATE TABLE t (id INT REFERENCES other_table (id) {match_clause})",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"t\",\n                span: 13..14,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"id\",\n                    span: 16..18,\n                },\n                data_type: DataType {\n                    identifier: 19..22,\n                    type_: Int(\n                        None,\n                    ),\n                    properties: [],\n                },\n            },\n        ],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected '')' or ','' here\",\n    span: 23..33,\n    sql_segment: \"REFERENCES\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TABLE t (id INT, FOREIGN KEY (id) REFERENCES other_table(id) {match_clause})",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"t\",\n                span: 13..14,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"id\",\n                    span: 16..18,\n                },\n                data_type: DataType {\n                    identifier: 19..22,\n                    type_: Int(\n                        None,\n                    ),\n                    properties: [],\n                },\n            },\n            ForeignKeyDefinition {\n                constraint_span: None,\n                constraint_symbol: None,\n                foreign_key_span: 24..35,\n                index_name: None,\n                cols: [\n                    IndexCol {\n                        expr: Column(\n                            Identifier {\n                                value: \"id\",\n                                span: 37..39,\n                            },\n                        ),\n                        size: None,\n                        asc: None,\n                        desc: None,\n                    },\n                ],\n                references_span: 41..51,\n                references_table: Identifier {\n                    value: \"other_table\",\n                    span: 52..63,\n                },\n                references_cols: [\n                    Identifier {\n                        value: \"id\",\n                        span: 64..66,\n                    },\n                ],\n                ons: [],\n            },\n        ],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected '')' or ','' here\",\n    span: 68..69,\n    sql_segment: \"{\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TABLE t1 (a INT, b TEXT) PARTITION BY RANGE(a)",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"t1\",\n                span: 13..15,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"a\",\n                    span: 17..18,\n                },\n                data_type: DataType {\n                    identifier: 19..22,\n                    type_: Int(\n                        None,\n                    ),\n                    properties: [],\n                },\n            },\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"b\",\n                    span: 24..25,\n                },\n                data_type: DataType {\n                    identifier: 26..30,\n                    type_: Text(\n                        None,\n                    ),\n                    properties: [],\n                },\n            },\n        ],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'table option or delimiter' here\",\n    span: 32..41,\n    sql_segment: \"PARTITION\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TABLE test_network (id INT, ip INET, cidr CIDR, mac MACADDR)",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"test_network\",\n                span: 13..25,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"id\",\n                    span: 27..29,\n                },\n                data_type: DataType {\n                    identifier: 30..33,\n                    type_: Int(\n                        None,\n                    ),\n                    properties: [],\n                },\n            },\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"ip\",\n                    span: 35..37,\n                },\n                data_type: DataType {\n                    identifier: 38..42,\n                    type_: Named(\n                        38..42,\n                    ),\n                    properties: [],\n                },\n            },\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"cidr\",\n                    span: 44..48,\n                },\n                data_type: DataType {\n                    identifier: 49..53,\n                    type_: Named(\n                        49..53,\n                    ),\n                    properties: [],\n                },\n            },\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"mac\",\n                    span: 55..58,\n                },\n                data_type: DataType {\n                    identifier: 59..66,\n                    type_: Named(\n                        59..66,\n                    ),\n                    properties: [],\n                },\n            },\n        ],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "CREATE TABLE test_serial (id SERIAL, big_id BIGSERIAL, data TEXT)",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"test_serial\",\n                span: 13..24,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"id\",\n                    span: 26..28,\n                },\n                data_type: DataType {\n                    identifier: 29..35,\n                    type_: Named(\n                        29..35,\n                    ),\n                    properties: [],\n                },\n            },\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"big_id\",\n                    span: 37..43,\n                },\n                data_type: DataType {\n                    identifier: 44..53,\n                    type_: Named(\n                        44..53,\n                    ),\n                    properties: [],\n                },\n            },\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"data\",\n                    span: 55..59,\n                },\n                data_type: DataType {\n                    identifier: 60..64,\n                    type_: Text(\n                        None,\n                    ),\n                    properties: [],\n                },\n            },\n        ],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "CREATE TABLE test_types (id SERIAL PRIMARY KEY, data BYTEA, doc JSONB, uid UUID)",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"test_types\",\n                span: 13..23,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"id\",\n                    span: 25..27,\n                },\n                data_type: DataType {\n                    identifier: 28..34,\n                    type_: Named(\n                        28..34,\n                    ),\n                    properties: [\n                        PrimaryKey(\n                            35..46,\n                        ),\n                    ],\n                },\n            },\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"data\",\n                    span: 48..52,\n                },\n                data_type: DataType {\n                    identifier: 53..58,\n                    type_: Bytea,\n                    properties: [],\n                },\n            },\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"doc\",\n                    span: 60..63,\n                },\n                data_type: DataType {\n                    identifier: 64..69,\n                    type_: Named(\n                        64..69,\n                    ),\n                    properties: [],\n                },\n            },\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"uid\",\n                    span: 71..74,\n                },\n                data_type: DataType {\n                    identifier: 75..79,\n                    type_: Named(\n                        75..79,\n                    ),\n                    properties: [],\n                },\n            },\n        ],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "CREATE TABLE user_stats AS SELECT user_id, COUNT(*) as order_count FROM orders GROUP BY user_id",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [],\n        table_span: 7..12,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"user_stats\",\n                span: 13..23,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''('' here\",\n    span: 24..26,\n    sql_segment: \"AS\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'identifier' here\",\n    span: 49..50,\n    sql_segment: \"*\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected ''SELECET' or '('' here\",\n    span: 55..66,\n    sql_segment: \"order_count\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TEMPORARY SEQUENCE  IF NOT EXISTS  name0",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 17..25,\n    sql_segment: \"SEQUENCE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TEMPORARY SEQUENCE  name0",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 17..25,\n    sql_segment: \"SEQUENCE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TEMPORARY SEQUENCE IF NOT EXISTS name0",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 17..25,\n    sql_segment: \"SEQUENCE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TEMPORARY SEQUENCE IF NOT EXISTS name1 AS BIGINT INCREMENT BY 1 MINVALUE 1 MAXVALUE 20 START WITH 10",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 17..25,\n    sql_segment: \"SEQUENCE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TEMPORARY SEQUENCE IF NOT EXISTS name3 INCREMENT 1 NO MINVALUE MAXVALUE 20 CACHE 2 CYCLE",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 17..25,\n    sql_segment: \"SEQUENCE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TEMPORARY SEQUENCE IF NOT EXISTS name3 INCREMENT 1 NO MINVALUE MAXVALUE 20 OWNED BY NONE",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 17..25,\n    sql_segment: \"SEQUENCE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TEMPORARY SEQUENCE IF NOT EXISTS name3 INCREMENT 1 NO MINVALUE MAXVALUE 20 OWNED BY public.table01",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 17..25,\n    sql_segment: \"SEQUENCE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TEMPORARY SEQUENCE name0",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLE' | 'VIEW' | 'TRIGGER' | 'FUNCTION' | 'INDEX' | 'TYPE' | 'DATABASE' | 'SCHEMA'' here\",\n    span: 17..25,\n    sql_segment: \"SEQUENCE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TEMPORARY TABLE table (COL INT) ON COMMIT DELETE ROWS",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [\n            Temporary(\n                7..16,\n            ),\n        ],\n        table_span: 17..22,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"table\",\n                span: 23..28,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"COL\",\n                    span: 30..33,\n                },\n                data_type: DataType {\n                    identifier: 34..37,\n                    type_: Int(\n                        None,\n                    ),\n                    properties: [],\n                },\n            },\n        ],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"'table' is a reserved identifier use `table`\",\n    span: 23..28,\n    sql_segment: \"table\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'table option or delimiter' here\",\n    span: 39..41,\n    sql_segment: \"ON\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TEMPORARY TABLE table (COL INT) ON COMMIT DROP",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [\n            Temporary(\n                7..16,\n            ),\n        ],\n        table_span: 17..22,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"table\",\n                span: 23..28,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"COL\",\n                    span: 30..33,\n                },\n                data_type: DataType {\n                    identifier: 34..37,\n                    type_: Int(\n                        None,\n                    ),\n                    properties: [],\n                },\n            },\n        ],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"'table' is a reserved identifier use `table`\",\n    span: 23..28,\n    sql_segment: \"table\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'table option or delimiter' here\",\n    span: 39..41,\n    sql_segment: \"ON\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TEMPORARY TABLE table (COL INT) ON COMMIT PRESERVE ROWS",
    "output": "CreateTable(\n    CreateTable {\n        create_span: 0..6,\n        create_options: [\n            Temporary(\n                7..16,\n            ),\n        ],\n        table_span: 17..22,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"table\",\n                span: 23..28,\n            },\n        },\n        if_not_exists: None,\n        create_definitions: [\n            ColumnDefinition {\n                identifier: Identifier {\n                    value: \"COL\",\n                    span: 30..33,\n                },\n                data_type: DataType {\n                    identifier: 34..37,\n                    type_: Int(\n                        None,\n                    ),\n                    properties: [],\n                },\n            },\n        ],\n        options: [],\n        table_as: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"'table' is a reserved identifier use `table`\",\n    span: 23..28,\n    sql_segment: \"table\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'table option or delimiter' here\",\n    span: 39..41,\n    sql_segment: \"ON\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TEMPORARY TABLE temp_users AS SELECT * FROM users",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''('' here\",\n    span: 34..36,\n    sql_segment: \"AS\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TRIGGER check_delete INSTEAD OF DELETE ON accounts FOR EACH ROW EXECUTE FUNCTION check_account_deletes",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''BEFORE' or 'AFTER'' here\",\n    span: 28..35,\n    sql_segment: \"INSTEAD\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TRIGGER check_insert BEFORE INSERT ON accounts FOR EACH ROW EXECUTE FUNCTION check_account_insert",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''('' here\",\n    span: 104..104,\n    sql_segment: \"\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TRIGGER check_referencing BEFORE INSERT ON accounts REFERENCING NEW TABLE AS new_accounts OLD TABLE AS old_accounts FOR EACH ROW EXECUTE FUNCTION check_account_referencing",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'FOR' here\",\n    span: 59..70,\n    sql_segment: \"REFERENCING\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TRIGGER check_update AFTER UPDATE ON accounts FOR EACH ROW WHEN (NEW.balance > 10000) EXECUTE FUNCTION check_account_update",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'statement' here\",\n    span: 66..70,\n    sql_segment: \"WHEN\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TRIGGER check_update BEFORE SAVE ON accounts EXECUTE FUNCTION check_account_update",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''UPDATE' or 'INSERT' or 'DELETE'' here\",\n    span: 35..39,\n    sql_segment: \"SAVE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TRIGGER check_update BEFORE UPDATE ON accounts FUNCTION check_account_update",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'FOR' here\",\n    span: 54..62,\n    sql_segment: \"FUNCTION\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TRIGGER check_update TOMORROW UPDATE ON accounts EXECUTE FUNCTION check_account_update",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''BEFORE' or 'AFTER'' here\",\n    span: 28..36,\n    sql_segment: \"TOMORROW\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATE TRIGGER emp_stamp BEFORE INSERT OR UPDATE ON emp\n        FOR EACH ROW EXECUTE FUNCTION emp_stamp();",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'ON' here\",\n    span: 39..41,\n    sql_segment: \"OR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "CREATE TYPE public.my_type AS ENUM ('label1', 'label2', 'label3', 'label4')",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'AS' here\",\n    span: 18..19,\n    sql_segment: \".\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "CREATEDB",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Statement' here\",\n    span: 0..8,\n    sql_segment: \"CREATEDB\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "CREATEROLE",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Statement' here\",\n    span: 0..10,\n    sql_segment: \"CREATEROLE\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "DECLARE \"SQL_CUR0x7fa44801bc00\" ASENSITIVE CURSOR FOR SELECT 1",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Statement' here\",\n    span: 0..7,\n    sql_segment: \"DECLARE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DECLARE \"SQL_CUR0x7fa44801bc00\" BINARY CURSOR FOR SELECT 1",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Statement' here\",\n    span: 0..7,\n    sql_segment: \"DECLARE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DECLARE \"SQL_CUR0x7fa44801bc00\" BINARY INSENSITIVE SCROLL CURSOR WITH HOLD FOR SELECT * FROM table_name LIMIT 2222",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Statement' here\",\n    span: 0..7,\n    sql_segment: \"DECLARE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DECLARE \"SQL_CUR0x7fa44801bc00\" CURSOR WITH HOLD FOR SELECT 1",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Statement' here\",\n    span: 0..7,\n    sql_segment: \"DECLARE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DECLARE \"SQL_CUR0x7fa44801bc00\" CURSOR WITHOUT HOLD FOR SELECT 1",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Statement' here\",\n    span: 0..7,\n    sql_segment: \"DECLARE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DECLARE \"SQL_CUR0x7fa44801bc00\" INSENSITIVE CURSOR FOR SELECT 1",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Statement' here\",\n    span: 0..7,\n    sql_segment: \"DECLARE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DECLARE \"SQL_CUR0x7fa44801bc00\" NO SCROLL CURSOR FOR SELECT 1",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Statement' here\",\n    span: 0..7,\n    sql_segment: \"DECLARE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DECLARE \"SQL_CUR0x7fa44801bc00\" SCROLL CURSOR FOR SELECT 1",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Statement' here\",\n    span: 0..7,\n    sql_segment: \"DECLARE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DELETE FROM tasks WHERE status = 'DONE' RETURNING *",
    "output": "Delete(\n    Delete {\n        delete_span: 0..6,\n        flags: [],\n        from_span: 7..11,\n        tables: [\n            QualifiedName {\n                prefix: [],\n                identifier: Identifier {\n                    value: \"tasks\",\n                    span: 12..17,\n                },\n            },\n        ],\n        using: [],\n        where_: Some(\n            (\n                Binary {\n                    op: Eq,\n                    op_span: 31..32,\n                    lhs: Identifier(\n                        [\n                            Name(\n                                Identifier {\n                                    value: \"status\",\n                                    span: 24..30,\n                                },\n                            ),\n                        ],\n                    ),\n                    rhs: String(\n                        SString {\n                            value: \"DONE\",\n                            span: 33..39,\n                        },\n                    ),\n                },\n                18..23,\n            ),\n        ),\n        order_by: None,\n        limit: None,\n        returning: Some(\n            (\n                40..49,\n                [\n                    SelectExpr {\n                        expr: Identifier(\n                            [\n                                Star(\n                                    50..51,\n                                ),\n                            ],\n                        ),\n                        as_: None,\n                    },\n                ],\n            ),\n        ),\n    },\n)",
    "issues": []
  },
  {
    "input": "DELETE FROM users USING contacts WHERE users.id = contacts.user_id AND contacts.active = false",
    "output": "Delete(\n    Delete {\n        delete_span: 0..6,\n        flags: [],\n        from_span: 7..11,\n        tables: [\n            QualifiedName {\n                prefix: [],\n                identifier: Identifier {\n                    value: \"users\",\n                    span: 12..17,\n                },\n            },\n        ],\n        using: [\n            Table {\n                identifier: QualifiedName {\n                    prefix: [],\n                    identifier: Identifier {\n                        value: \"contacts\",\n                        span: 24..32,\n                    },\n                },\n                as_span: None,\n                as_: None,\n                index_hints: [],\n            },\n        ],\n        where_: Some(\n            (\n                Binary {\n                    op: And,\n                    op_span: 67..70,\n                    lhs: Binary {\n                        op: Eq,\n                        op_span: 48..49,\n                        lhs: Identifier(\n                            [\n                                Name(\n                                    Identifier {\n                                        value: \"users\",\n                                        span: 39..44,\n                                    },\n                                ),\n                                Name(\n                                    Identifier {\n                                        value: \"id\",\n                                        span: 45..47,\n                                    },\n                                ),\n                            ],\n                        ),\n                        rhs: Identifier(\n                            [\n                                Name(\n                                    Identifier {\n                                        value: \"contacts\",\n                                        span: 50..58,\n                                    },\n                                ),\n                                Name(\n                                    Identifier {\n                                        value: \"user_id\",\n                                        span: 59..66,\n                                    },\n                                ),\n                            ],\n                        ),\n                    },\n                    rhs: Binary {\n                        op: Eq,\n                        op_span: 87..88,\n                        lhs: Identifier(\n                            [\n                                Name(\n                                    Identifier {\n                                        value: \"contacts\",\n                                        span: 71..79,\n                                    },\n                                ),\n                                Name(\n                                    Identifier {\n                                        value: \"active\",\n                                        span: 80..86,\n                                    },\n                                ),\n                            ],\n                        ),\n                        rhs: Bool(\n                            false,\n                            89..94,\n                        ),\n                    },\n                },\n                33..38,\n            ),\n        ),\n        order_by: None,\n        limit: None,\n        returning: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "DELETE FROM users WHERE id = 1",
    "output": "Delete(\n    Delete {\n        delete_span: 0..6,\n        flags: [],\n        from_span: 7..11,\n        tables: [\n            QualifiedName {\n                prefix: [],\n                identifier: Identifier {\n                    value: \"users\",\n                    span: 12..17,\n                },\n            },\n        ],\n        using: [],\n        where_: Some(\n            (\n                Binary {\n                    op: Eq,\n                    op_span: 27..28,\n                    lhs: Identifier(\n                        [\n                            Name(\n                                Identifier {\n                                    value: \"id\",\n                                    span: 24..26,\n                                },\n                            ),\n                        ],\n                    ),\n                    rhs: Integer(\n                        (\n                            1,\n                            29..30,\n                        ),\n                    ),\n                },\n                18..23,\n            ),\n        ),\n        order_by: None,\n        limit: None,\n        returning: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "DELETE FROM users WHERE id = 1 RETURNING *",
    "output": "Delete(\n    Delete {\n        delete_span: 0..6,\n        flags: [],\n        from_span: 7..11,\n        tables: [\n            QualifiedName {\n                prefix: [],\n                identifier: Identifier {\n                    value: \"users\",\n                    span: 12..17,\n                },\n            },\n        ],\n        using: [],\n        where_: Some(\n            (\n                Binary {\n                    op: Eq,\n                    op_span: 27..28,\n                    lhs: Identifier(\n                        [\n                            Name(\n                                Identifier {\n                                    value: \"id\",\n                                    span: 24..26,\n                                },\n                            ),\n                        ],\n                    ),\n                    rhs: Integer(\n                        (\n                            1,\n                            29..30,\n                        ),\n                    ),\n                },\n                18..23,\n            ),\n        ),\n        order_by: None,\n        limit: None,\n        returning: Some(\n            (\n                31..40,\n                [\n                    SelectExpr {\n                        expr: Identifier(\n                            [\n                                Star(\n                                    41..42,\n                                ),\n                            ],\n                        ),\n                        as_: None,\n                    },\n                ],\n            ),\n        ),\n    },\n)",
    "issues": []
  },
  {
    "input": "DELETE FROM users WHERE id = 1 RETURNING id, name",
    "output": "Delete(\n    Delete {\n        delete_span: 0..6,\n        flags: [],\n        from_span: 7..11,\n        tables: [\n            QualifiedName {\n                prefix: [],\n                identifier: Identifier {\n                    value: \"users\",\n                    span: 12..17,\n                },\n            },\n        ],\n        using: [],\n        where_: Some(\n            (\n                Binary {\n                    op: Eq,\n                    op_span: 27..28,\n                    lhs: Identifier(\n                        [\n                            Name(\n                                Identifier {\n                                    value: \"id\",\n                                    span: 24..26,\n                                },\n                            ),\n                        ],\n                    ),\n                    rhs: Integer(\n                        (\n                            1,\n                            29..30,\n                        ),\n                    ),\n                },\n                18..23,\n            ),\n        ),\n        order_by: None,\n        limit: None,\n        returning: Some(\n            (\n                31..40,\n                [\n                    SelectExpr {\n                        expr: Identifier(\n                            [\n                                Name(\n                                    Identifier {\n                                        value: \"id\",\n                                        span: 41..43,\n                                    },\n                                ),\n                            ],\n                        ),\n                        as_: None,\n                    },\n                    SelectExpr {\n                        expr: Identifier(\n                            [\n                                Name(\n                                    Identifier {\n                                        value: \"name\",\n                                        span: 45..49,\n                                    },\n                                ),\n                            ],\n                        ),\n                        as_: None,\n                    },\n                ],\n            ),\n        ),\n    },\n)",
    "issues": []
  },
  {
    "input": "DROP DOMAIN IF EXISTS jpeg_domain",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'droppable' here\",\n    span: 5..11,\n    sql_segment: \"DOMAIN\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP DOMAIN IF EXISTS jpeg_domain CASCADE",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'droppable' here\",\n    span: 5..11,\n    sql_segment: \"DOMAIN\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP DOMAIN IF EXISTS jpeg_domain RESTRICT",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'droppable' here\",\n    span: 5..11,\n    sql_segment: \"DOMAIN\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP DOMAIN jpeg_domain",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'droppable' here\",\n    span: 5..11,\n    sql_segment: \"DOMAIN\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP EXTENSION IF EXISTS extension_name",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'droppable' here\",\n    span: 5..14,\n    sql_segment: \"EXTENSION\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP EXTENSION IF EXISTS extension_name CASCADE",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'droppable' here\",\n    span: 5..14,\n    sql_segment: \"EXTENSION\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP EXTENSION IF EXISTS extension_name RESTRICT",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'droppable' here\",\n    span: 5..14,\n    sql_segment: \"EXTENSION\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP EXTENSION IF EXISTS extension_name1, extension_name2 CASCADE",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'droppable' here\",\n    span: 5..14,\n    sql_segment: \"EXTENSION\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP EXTENSION IF EXISTS extension_name1, extension_name2 RESTRICT",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'droppable' here\",\n    span: 5..14,\n    sql_segment: \"EXTENSION\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP EXTENSION extension_name",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'droppable' here\",\n    span: 5..14,\n    sql_segment: \"EXTENSION\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP EXTENSION extension_name CASCADE",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'droppable' here\",\n    span: 5..14,\n    sql_segment: \"EXTENSION\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP EXTENSION extension_name RESTRICT",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'droppable' here\",\n    span: 5..14,\n    sql_segment: \"EXTENSION\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP EXTENSION extension_name, extension_name2 CASCADE",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'droppable' here\",\n    span: 5..14,\n    sql_segment: \"EXTENSION\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP EXTENSION extension_name, extension_name2 RESTRICT",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'droppable' here\",\n    span: 5..14,\n    sql_segment: \"EXTENSION\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP FUNCTION IF EXISTS test_func",
    "output": "DropFunction(\n    DropFunction {\n        drop_span: 0..4,\n        function_span: 5..13,\n        if_exists: Some(\n            14..23,\n        ),\n        function: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"test_func\",\n                span: 24..33,\n            },\n        },\n    },\n)",
    "issues": []
  },
  {
    "input": "DROP FUNCTION IF EXISTS test_func(a INTEGER, IN b INTEGER = 1)",
    "output": "DropFunction(\n    DropFunction {\n        drop_span: 0..4,\n        function_span: 5..13,\n        if_exists: Some(\n            14..23,\n        ),\n        function: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"test_func\",\n                span: 24..33,\n            },\n        },\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 33..34,\n    sql_segment: \"(\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP FUNCTION IF EXISTS test_func1(a INTEGER, IN b INTEGER = 1), test_func2(a VARCHAR, IN b INTEGER = 1)",
    "output": "DropFunction(\n    DropFunction {\n        drop_span: 0..4,\n        function_span: 5..13,\n        if_exists: Some(\n            14..23,\n        ),\n        function: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"test_func1\",\n                span: 24..34,\n            },\n        },\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 34..35,\n    sql_segment: \"(\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP OPERATOR (INTEGER, INTEGER)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'droppable' here\",\n    span: 5..13,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP OPERATOR CLASS IF EXISTS USING btree",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'droppable' here\",\n    span: 5..13,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP OPERATOR CLASS USING btree",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'droppable' here\",\n    span: 5..13,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP OPERATOR CLASS{} {} USING {}{}",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'droppable' here\",\n    span: 5..13,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "DROP OPERATOR FAMILY IF EXISTS USING btree",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'droppable' here\",\n    span: 5..13,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP OPERATOR FAMILY USING btree",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'droppable' here\",\n    span: 5..13,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP OPERATOR FAMILY{} {} USING {}{}",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'droppable' here\",\n    span: 5..13,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "DROP OPERATOR IF EXISTS (INTEGER, INTEGER)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'droppable' here\",\n    span: 5..13,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP OPERATOR IF EXISTS + (INTEGER, INTEGER), - (INTEGER, INTEGER) CASCADE",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'droppable' here\",\n    span: 5..13,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP OPERATOR myschema.@@ (TEXT, TEXT)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'droppable' here\",\n    span: 5..13,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP OPERATOR ~ (NONE, BIT)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'droppable' here\",\n    span: 5..13,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP OPERATOR{} {op} (INTEGER, INTEGER){}",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'droppable' here\",\n    span: 5..13,\n    sql_segment: \"OPERATOR\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "DROP PROCEDURE IF EXISTS test_proc",
    "output": "DropProcedure(\n    DropProcedure {\n        drop_span: 0..4,\n        procedure_span: 5..14,\n        if_exists: Some(\n            15..24,\n        ),\n        procedure: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"test_proc\",\n                span: 25..34,\n            },\n        },\n    },\n)",
    "issues": []
  },
  {
    "input": "DROP PROCEDURE IF EXISTS test_proc(a INTEGER, IN b INTEGER = 1)",
    "output": "DropProcedure(\n    DropProcedure {\n        drop_span: 0..4,\n        procedure_span: 5..14,\n        if_exists: Some(\n            15..24,\n        ),\n        procedure: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"test_proc\",\n                span: 25..34,\n            },\n        },\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 34..35,\n    sql_segment: \"(\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP PROCEDURE IF EXISTS test_proc1(a INTEGER, IN b INTEGER = 1), test_proc2(a VARCHAR, IN b INTEGER = 1)",
    "output": "DropProcedure(\n    DropProcedure {\n        drop_span: 0..4,\n        procedure_span: 5..14,\n        if_exists: Some(\n            15..24,\n        ),\n        procedure: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"test_proc1\",\n                span: 25..35,\n            },\n        },\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 35..36,\n    sql_segment: \"(\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP PROCEDURE testproc DROP",
    "output": "DropProcedure(\n    DropProcedure {\n        drop_span: 0..4,\n        procedure_span: 5..14,\n        if_exists: None,\n        procedure: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"testproc\",\n                span: 15..23,\n            },\n        },\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 24..28,\n    sql_segment: \"DROP\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP PROCEDURE testproc SET NULL",
    "output": "DropProcedure(\n    DropProcedure {\n        drop_span: 0..4,\n        procedure_span: 5..14,\n        if_exists: None,\n        procedure: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"testproc\",\n                span: 15..23,\n            },\n        },\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 24..27,\n    sql_segment: \"SET\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP SCHEMA IF EXISTS schema_name",
    "output": "DropDatabase(\n    DropDatabase {\n        drop_span: 0..4,\n        database_span: 5..11,\n        if_exists: Some(\n            12..21,\n        ),\n        database: Identifier {\n            value: \"schema_name\",\n            span: 22..33,\n        },\n    },\n)",
    "issues": []
  },
  {
    "input": "DROP SEQUENCE  name0 CASCADE",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Not yet implemented at qusql-parse/src/drop.rs:469\",\n    span: 5..13,\n    sql_segment: \"SEQUENCE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP SEQUENCE  name1 RESTRICT",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Not yet implemented at qusql-parse/src/drop.rs:469\",\n    span: 5..13,\n    sql_segment: \"SEQUENCE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP SEQUENCE  name1, name2, name3",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Not yet implemented at qusql-parse/src/drop.rs:469\",\n    span: 5..13,\n    sql_segment: \"SEQUENCE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP SEQUENCE  name2",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Not yet implemented at qusql-parse/src/drop.rs:469\",\n    span: 5..13,\n    sql_segment: \"SEQUENCE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP SEQUENCE  name2 CASCADE",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Not yet implemented at qusql-parse/src/drop.rs:469\",\n    span: 5..13,\n    sql_segment: \"SEQUENCE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP SEQUENCE IF EXISTS  name0 CASCADE",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Not yet implemented at qusql-parse/src/drop.rs:469\",\n    span: 5..13,\n    sql_segment: \"SEQUENCE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP SEQUENCE IF EXISTS  name1 RESTRICT",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Not yet implemented at qusql-parse/src/drop.rs:469\",\n    span: 5..13,\n    sql_segment: \"SEQUENCE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP SEQUENCE IF EXISTS name0 CASCADE",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Not yet implemented at qusql-parse/src/drop.rs:469\",\n    span: 5..13,\n    sql_segment: \"SEQUENCE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP SEQUENCE IF EXISTS name1 RESTRICT",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Not yet implemented at qusql-parse/src/drop.rs:469\",\n    span: 5..13,\n    sql_segment: \"SEQUENCE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP SEQUENCE name0 CASCADE",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Not yet implemented at qusql-parse/src/drop.rs:469\",\n    span: 5..13,\n    sql_segment: \"SEQUENCE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP SEQUENCE name1 RESTRICT",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Not yet implemented at qusql-parse/src/drop.rs:469\",\n    span: 5..13,\n    sql_segment: \"SEQUENCE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP SEQUENCE name1, name2, name3",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Not yet implemented at qusql-parse/src/drop.rs:469\",\n    span: 5..13,\n    sql_segment: \"SEQUENCE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP SEQUENCE name2",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Not yet implemented at qusql-parse/src/drop.rs:469\",\n    span: 5..13,\n    sql_segment: \"SEQUENCE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP SEQUENCE name2 CASCADE",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Not yet implemented at qusql-parse/src/drop.rs:469\",\n    span: 5..13,\n    sql_segment: \"SEQUENCE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP TRIGGER check_update ON table_name CASCADE CASCADE",
    "output": "DropTrigger(\n    DropTrigger {\n        drop_span: 0..4,\n        trigger_span: 5..12,\n        if_exists: None,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"check_update\",\n                span: 13..25,\n            },\n        },\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 26..28,\n    sql_segment: \"ON\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP TRIGGER check_update ON table_name CASCADE CASCADE CASCADE",
    "output": "DropTrigger(\n    DropTrigger {\n        drop_span: 0..4,\n        trigger_span: 5..12,\n        if_exists: None,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"check_update\",\n                span: 13..25,\n            },\n        },\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 26..28,\n    sql_segment: \"ON\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP TRIGGER check_update ON table_name CASCADE RESTRICT",
    "output": "DropTrigger(\n    DropTrigger {\n        drop_span: 0..4,\n        trigger_span: 5..12,\n        if_exists: None,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"check_update\",\n                span: 13..25,\n            },\n        },\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 26..28,\n    sql_segment: \"ON\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP TRIGGER emp_stamp ON emp;",
    "output": "DropTrigger(\n    DropTrigger {\n        drop_span: 0..4,\n        trigger_span: 5..12,\n        if_exists: None,\n        identifier: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"emp_stamp\",\n                span: 13..22,\n            },\n        },\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 23..25,\n    sql_segment: \"ON\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "DROP TRIGGER{} check_update ON table_name{}",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'identifier' here\",\n    span: 12..13,\n    sql_segment: \"{\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "EXPLAIN (ANALYZE, BUFFERS) SELECT * FROM users JOIN orders ON users.id = orders.user_id",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Statement' here\",\n    span: 0..7,\n    sql_segment: \"EXPLAIN\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "EXPLAIN ANALYZE SELECT * FROM users WHERE id > 100",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Statement' here\",\n    span: 0..7,\n    sql_segment: \"EXPLAIN\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "EXPLAIN SELECT * FROM users",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Statement' here\",\n    span: 0..7,\n    sql_segment: \"EXPLAIN\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "Expected: end of statement, found: DROP",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Statement' here\",\n    span: 0..8,\n    sql_segment: \"Expected\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "Expected: one of INSERT or UPDATE or DELETE or TRUNCATE, found: SAVE",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Statement' here\",\n    span: 0..8,\n    sql_segment: \"Expected\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "Expected: one of INSERT or UPDATE or DELETE or TRUNCATE, found: TOMORROW",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Statement' here\",\n    span: 0..8,\n    sql_segment: \"Expected\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "Failed to parse CREATE ROLE test case: {err:?}",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Statement' here\",\n    span: 0..6,\n    sql_segment: \"Failed\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "IN, FROM, or WITH",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Statement' here\",\n    span: 0..2,\n    sql_segment: \"IN\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "INSERT INTO arr_test (id, tags) VALUES (1, ARRAY['tag1', 'tag2', 'tag3'])",
    "output": "InsertReplace(\n    InsertReplace {\n        type_: Insert(\n            0..6,\n        ),\n        flags: [],\n        into_span: Some(\n            7..11,\n        ),\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"arr_test\",\n                span: 12..20,\n            },\n        },\n        columns: [\n            Identifier {\n                value: \"id\",\n                span: 22..24,\n            },\n            Identifier {\n                value: \"tags\",\n                span: 26..30,\n            },\n        ],\n        values: Some(\n            (\n                32..38,\n                [\n                    [\n                        Integer(\n                            (\n                                1,\n                                40..41,\n                            ),\n                        ),\n                        Identifier(\n                            [\n                                Name(\n                                    Identifier {\n                                        value: \"ARRAY\",\n                                        span: 43..48,\n                                    },\n                                ),\n                            ],\n                        ),\n                    ],\n                ],\n            ),\n        ),\n        select: None,\n        set: None,\n        on_duplicate_key_update: None,\n        on_conflict: None,\n        as_alias: None,\n        returning: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ')' here\",\n    span: 48..49,\n    sql_segment: \"[\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "INSERT INTO distributors (did, dname) VALUES (DEFAULT, 'XYZ Widgets') RETURNING did",
    "output": "InsertReplace(\n    InsertReplace {\n        type_: Insert(\n            0..6,\n        ),\n        flags: [],\n        into_span: Some(\n            7..11,\n        ),\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"distributors\",\n                span: 12..24,\n            },\n        },\n        columns: [\n            Identifier {\n                value: \"did\",\n                span: 26..29,\n            },\n            Identifier {\n                value: \"dname\",\n                span: 31..36,\n            },\n        ],\n        values: Some(\n            (\n                38..44,\n                [\n                    [\n                        Identifier(\n                            [\n                                Name(\n                                    Identifier {\n                                        value: \"DEFAULT\",\n                                        span: 46..53,\n                                    },\n                                ),\n                            ],\n                        ),\n                        String(\n                            SString {\n                                value: \"XYZ Widgets\",\n                                span: 55..68,\n                            },\n                        ),\n                    ],\n                ],\n            ),\n        ),\n        select: None,\n        set: None,\n        on_duplicate_key_update: None,\n        on_conflict: None,\n        as_alias: None,\n        returning: Some(\n            (\n                70..79,\n                [\n                    SelectExpr {\n                        expr: Identifier(\n                            [\n                                Name(\n                                    Identifier {\n                                        value: \"did\",\n                                        span: 80..83,\n                                    },\n                                ),\n                            ],\n                        ),\n                        as_: None,\n                    },\n                ],\n            ),\n        ),\n    },\n)",
    "issues": []
  },
  {
    "input": "INSERT INTO test_tables AS \"Test_Table\" (id, a) VALUES (DEFAULT, '0123')",
    "output": "InsertReplace(\n    InsertReplace {\n        type_: Insert(\n            0..6,\n        ),\n        flags: [],\n        into_span: Some(\n            7..11,\n        ),\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"test_tables\",\n                span: 12..23,\n            },\n        },\n        columns: [],\n        values: None,\n        select: None,\n        set: None,\n        on_duplicate_key_update: None,\n        on_conflict: None,\n        as_alias: Some(\n            (\n                24..26,\n                Identifier {\n                    value: \"Test_Table\",\n                    span: 27..39,\n                },\n                Some(\n                    [\n                        Identifier {\n                            value: \"id\",\n                            span: 41..43,\n                        },\n                        Identifier {\n                            value: \"a\",\n                            span: 45..46,\n                        },\n                    ],\n                ),\n            ),\n        ),\n        returning: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'VALUE, VALUES, SELECT or SET' here\",\n    span: 24..26,\n    sql_segment: \"AS\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 48..54,\n    sql_segment: \"VALUES\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "INSERT INTO test_tables AS test_table (id, a) VALUES (DEFAULT, 123)",
    "output": "InsertReplace(\n    InsertReplace {\n        type_: Insert(\n            0..6,\n        ),\n        flags: [],\n        into_span: Some(\n            7..11,\n        ),\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"test_tables\",\n                span: 12..23,\n            },\n        },\n        columns: [],\n        values: None,\n        select: None,\n        set: None,\n        on_duplicate_key_update: None,\n        on_conflict: None,\n        as_alias: Some(\n            (\n                24..26,\n                Identifier {\n                    value: \"test_table\",\n                    span: 27..37,\n                },\n                Some(\n                    [\n                        Identifier {\n                            value: \"id\",\n                            span: 39..41,\n                        },\n                        Identifier {\n                            value: \"a\",\n                            span: 43..44,\n                        },\n                    ],\n                ),\n            ),\n        ),\n        returning: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'VALUE, VALUES, SELECT or SET' here\",\n    span: 24..26,\n    sql_segment: \"AS\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 46..52,\n    sql_segment: \"VALUES\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "INSERT INTO users (id, name) VALUES (1, 'John') ON CONFLICT (id) DO NOTHING",
    "output": "InsertReplace(\n    InsertReplace {\n        type_: Insert(\n            0..6,\n        ),\n        flags: [],\n        into_span: Some(\n            7..11,\n        ),\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"users\",\n                span: 12..17,\n            },\n        },\n        columns: [\n            Identifier {\n                value: \"id\",\n                span: 19..21,\n            },\n            Identifier {\n                value: \"name\",\n                span: 23..27,\n            },\n        ],\n        values: Some(\n            (\n                29..35,\n                [\n                    [\n                        Integer(\n                            (\n                                1,\n                                37..38,\n                            ),\n                        ),\n                        String(\n                            SString {\n                                value: \"John\",\n                                span: 40..46,\n                            },\n                        ),\n                    ],\n                ],\n            ),\n        ),\n        select: None,\n        set: None,\n        on_duplicate_key_update: None,\n        on_conflict: Some(\n            OnConflict {\n                on_conflict_span: 48..59,\n                target: Columns {\n                    names: [\n                        Identifier {\n                            value: \"id\",\n                            span: 61..63,\n                        },\n                    ],\n                },\n                action: DoNothing(\n                    65..75,\n                ),\n            },\n        ),\n        as_alias: None,\n        returning: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "INSERT INTO users (id, name) VALUES (1, 'John') ON CONFLICT (id) DO UPDATE SET name = EXCLUDED.name",
    "output": "InsertReplace(\n    InsertReplace {\n        type_: Insert(\n            0..6,\n        ),\n        flags: [],\n        into_span: Some(\n            7..11,\n        ),\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"users\",\n                span: 12..17,\n            },\n        },\n        columns: [\n            Identifier {\n                value: \"id\",\n                span: 19..21,\n            },\n            Identifier {\n                value: \"name\",\n                span: 23..27,\n            },\n        ],\n        values: Some(\n            (\n                29..35,\n                [\n                    [\n                        Integer(\n                            (\n                                1,\n                                37..38,\n                            ),\n                        ),\n                        String(\n                            SString {\n                                value: \"John\",\n                                span: 40..46,\n                            },\n                        ),\n                    ],\n                ],\n            ),\n        ),\n        select: None,\n        set: None,\n        on_duplicate_key_update: None,\n        on_conflict: Some(\n            OnConflict {\n                on_conflict_span: 48..59,\n                target: Columns {\n                    names: [\n                        Identifier {\n                            value: \"id\",\n                            span: 61..63,\n                        },\n                    ],\n                },\n                action: DoUpdateSet {\n                    do_update_set_span: 65..78,\n                    sets: [\n                        (\n                            Identifier {\n                                value: \"name\",\n                                span: 79..83,\n                            },\n                            Identifier(\n                                [\n                                    Name(\n                                        Identifier {\n                                            value: \"EXCLUDED\",\n                                            span: 86..94,\n                                        },\n                                    ),\n                                    Name(\n                                        Identifier {\n                                            value: \"name\",\n                                            span: 95..99,\n                                        },\n                                    ),\n                                ],\n                            ),\n                        ),\n                    ],\n                    where_: None,\n                },\n            },\n        ),\n        as_alias: None,\n        returning: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "INSERT INTO users (id, name, email) VALUES (1, 'John', 'j@ex.com') ON CONFLICT (id) DO UPDATE SET name = EXCLUDED.name, email = EXCLUDED.email WHERE users.updated_at < EXCLUDED.updated_at",
    "output": "InsertReplace(\n    InsertReplace {\n        type_: Insert(\n            0..6,\n        ),\n        flags: [],\n        into_span: Some(\n            7..11,\n        ),\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"users\",\n                span: 12..17,\n            },\n        },\n        columns: [\n            Identifier {\n                value: \"id\",\n                span: 19..21,\n            },\n            Identifier {\n                value: \"name\",\n                span: 23..27,\n            },\n            Identifier {\n                value: \"email\",\n                span: 29..34,\n            },\n        ],\n        values: Some(\n            (\n                36..42,\n                [\n                    [\n                        Integer(\n                            (\n                                1,\n                                44..45,\n                            ),\n                        ),\n                        String(\n                            SString {\n                                value: \"John\",\n                                span: 47..53,\n                            },\n                        ),\n                        String(\n                            SString {\n                                value: \"j@ex.com\",\n                                span: 55..65,\n                            },\n                        ),\n                    ],\n                ],\n            ),\n        ),\n        select: None,\n        set: None,\n        on_duplicate_key_update: None,\n        on_conflict: Some(\n            OnConflict {\n                on_conflict_span: 67..78,\n                target: Columns {\n                    names: [\n                        Identifier {\n                            value: \"id\",\n                            span: 80..82,\n                        },\n                    ],\n                },\n                action: DoUpdateSet {\n                    do_update_set_span: 84..97,\n                    sets: [\n                        (\n                            Identifier {\n                                value: \"name\",\n                                span: 98..102,\n                            },\n                            Identifier(\n                                [\n                                    Name(\n                                        Identifier {\n                                            value: \"EXCLUDED\",\n                                            span: 105..113,\n                                        },\n                                    ),\n                                    Name(\n                                        Identifier {\n                                            value: \"name\",\n                                            span: 114..118,\n                                        },\n                                    ),\n                                ],\n                            ),\n                        ),\n                        (\n                            Identifier {\n                                value: \"email\",\n                                span: 120..125,\n                            },\n                            Identifier(\n                                [\n                                    Name(\n                                        Identifier {\n                                            value: \"EXCLUDED\",\n                                            span: 128..136,\n                                        },\n                                    ),\n                                    Name(\n                                        Identifier {\n                                            value: \"email\",\n                                            span: 137..142,\n                                        },\n                                    ),\n                                ],\n                            ),\n                        ),\n                    ],\n                    where_: Some(\n                        (\n                            143..148,\n                            Binary {\n                                op: Lt,\n                                op_span: 166..167,\n                                lhs: Identifier(\n                                    [\n                                        Name(\n                                            Identifier {\n                                                value: \"users\",\n                                                span: 149..154,\n                                            },\n                                        ),\n                                        Name(\n                                            Identifier {\n                                                value: \"updated_at\",\n                                                span: 155..165,\n                                            },\n                                        ),\n                                    ],\n                                ),\n                                rhs: Identifier(\n                                    [\n                                        Name(\n                                            Identifier {\n                                                value: \"EXCLUDED\",\n                                                span: 168..176,\n                                            },\n                                        ),\n                                        Name(\n                                            Identifier {\n                                                value: \"updated_at\",\n                                                span: 177..187,\n                                            },\n                                        ),\n                                    ],\n                                ),\n                            },\n                        ),\n                    ),\n                },\n            },\n        ),\n        as_alias: None,\n        returning: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "INSERT INTO users (name, email) VALUES ('John', 'john@example.com')",
    "output": "InsertReplace(\n    InsertReplace {\n        type_: Insert(\n            0..6,\n        ),\n        flags: [],\n        into_span: Some(\n            7..11,\n        ),\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"users\",\n                span: 12..17,\n            },\n        },\n        columns: [\n            Identifier {\n                value: \"name\",\n                span: 19..23,\n            },\n            Identifier {\n                value: \"email\",\n                span: 25..30,\n            },\n        ],\n        values: Some(\n            (\n                32..38,\n                [\n                    [\n                        String(\n                            SString {\n                                value: \"John\",\n                                span: 40..46,\n                            },\n                        ),\n                        String(\n                            SString {\n                                value: \"john@example.com\",\n                                span: 48..66,\n                            },\n                        ),\n                    ],\n                ],\n            ),\n        ),\n        select: None,\n        set: None,\n        on_duplicate_key_update: None,\n        on_conflict: None,\n        as_alias: None,\n        returning: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "INSERT INTO users (name, email) VALUES ('John', 'john@example.com') RETURNING id",
    "output": "InsertReplace(\n    InsertReplace {\n        type_: Insert(\n            0..6,\n        ),\n        flags: [],\n        into_span: Some(\n            7..11,\n        ),\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"users\",\n                span: 12..17,\n            },\n        },\n        columns: [\n            Identifier {\n                value: \"name\",\n                span: 19..23,\n            },\n            Identifier {\n                value: \"email\",\n                span: 25..30,\n            },\n        ],\n        values: Some(\n            (\n                32..38,\n                [\n                    [\n                        String(\n                            SString {\n                                value: \"John\",\n                                span: 40..46,\n                            },\n                        ),\n                        String(\n                            SString {\n                                value: \"john@example.com\",\n                                span: 48..66,\n                            },\n                        ),\n                    ],\n                ],\n            ),\n        ),\n        select: None,\n        set: None,\n        on_duplicate_key_update: None,\n        on_conflict: None,\n        as_alias: None,\n        returning: Some(\n            (\n                68..77,\n                [\n                    SelectExpr {\n                        expr: Identifier(\n                            [\n                                Name(\n                                    Identifier {\n                                        value: \"id\",\n                                        span: 78..80,\n                                    },\n                                ),\n                            ],\n                        ),\n                        as_: None,\n                    },\n                ],\n            ),\n        ),\n    },\n)",
    "issues": []
  },
  {
    "input": "INSERT INTO users (name, email) VALUES ('John', 'john@example.com') RETURNING id, created_at",
    "output": "InsertReplace(\n    InsertReplace {\n        type_: Insert(\n            0..6,\n        ),\n        flags: [],\n        into_span: Some(\n            7..11,\n        ),\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"users\",\n                span: 12..17,\n            },\n        },\n        columns: [\n            Identifier {\n                value: \"name\",\n                span: 19..23,\n            },\n            Identifier {\n                value: \"email\",\n                span: 25..30,\n            },\n        ],\n        values: Some(\n            (\n                32..38,\n                [\n                    [\n                        String(\n                            SString {\n                                value: \"John\",\n                                span: 40..46,\n                            },\n                        ),\n                        String(\n                            SString {\n                                value: \"john@example.com\",\n                                span: 48..66,\n                            },\n                        ),\n                    ],\n                ],\n            ),\n        ),\n        select: None,\n        set: None,\n        on_duplicate_key_update: None,\n        on_conflict: None,\n        as_alias: None,\n        returning: Some(\n            (\n                68..77,\n                [\n                    SelectExpr {\n                        expr: Identifier(\n                            [\n                                Name(\n                                    Identifier {\n                                        value: \"id\",\n                                        span: 78..80,\n                                    },\n                                ),\n                            ],\n                        ),\n                        as_: None,\n                    },\n                    SelectExpr {\n                        expr: Identifier(\n                            [\n                                Name(\n                                    Identifier {\n                                        value: \"created_at\",\n                                        span: 82..92,\n                                    },\n                                ),\n                            ],\n                        ),\n                        as_: None,\n                    },\n                ],\n            ),\n        ),\n    },\n)",
    "issues": []
  },
  {
    "input": "INSERT INTO users (name, email) VALUES ('John', 'john@example.com'), ('Jane', 'jane@example.com')",
    "output": "InsertReplace(\n    InsertReplace {\n        type_: Insert(\n            0..6,\n        ),\n        flags: [],\n        into_span: Some(\n            7..11,\n        ),\n        table: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"users\",\n                span: 12..17,\n            },\n        },\n        columns: [\n            Identifier {\n                value: \"name\",\n                span: 19..23,\n            },\n            Identifier {\n                value: \"email\",\n                span: 25..30,\n            },\n        ],\n        values: Some(\n            (\n                32..38,\n                [\n                    [\n                        String(\n                            SString {\n                                value: \"John\",\n                                span: 40..46,\n                            },\n                        ),\n                        String(\n                            SString {\n                                value: \"john@example.com\",\n                                span: 48..66,\n                            },\n                        ),\n                    ],\n                    [\n                        String(\n                            SString {\n                                value: \"Jane\",\n                                span: 70..76,\n                            },\n                        ),\n                        String(\n                            SString {\n                                value: \"jane@example.com\",\n                                span: 78..96,\n                            },\n                        ),\n                    ],\n                ],\n            ),\n        ),\n        select: None,\n        set: None,\n        on_duplicate_key_update: None,\n        on_conflict: None,\n        as_alias: None,\n        returning: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "PREPARE a (INT, TEXT) AS SELECT * FROM customers WHERE customers.id = a1",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Statement' here\",\n    span: 0..7,\n    sql_segment: \"PREPARE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "PREPARE a AS INSERT INTO customers VALUES (a1, a2, a3)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Statement' here\",\n    span: 0..7,\n    sql_segment: \"PREPARE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "REFRESH MATERIALIZED VIEW CONCURRENTLY user_summary",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Statement' here\",\n    span: 0..7,\n    sql_segment: \"REFRESH\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "REFRESH MATERIALIZED VIEW user_summary",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Statement' here\",\n    span: 0..7,\n    sql_segment: \"REFRESH\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT \"\"\"quoted ident\"\"\"",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: String(\n                    SString {\n                        value: \"\\\"\\\"quoted ident\\\"\\\"\",\n                        span: 7..25,\n                    },\n                ),\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT \"alias\".\"bar baz\", \"myfun\"(), \"simple id\" AS \"column alias\" FROM \"a table\" AS \"alias\"",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: String(\n                    SString {\n                        value: \"alias\",\n                        span: 7..14,\n                    },\n                ),\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 14..15,\n    sql_segment: \".\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "SELECT \"quoted \"\" ident\"",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: String(\n                    SString {\n                        value: \"quoted \\\"\\\" ident\",\n                        span: 7..24,\n                    },\n                ),\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT $$$",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected expression\",\n    span: 7..9,\n    sql_segment: \"$$\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT $$Hello World$$",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected expression\",\n    span: 7..9,\n    sql_segment: \"$$\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT $$hello$$, $tag_name$world$tag_name$, $$Foo$Bar$$, $$Foo$Bar$$col_name, $$$$, $tag_name$$tag_name$",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected expression\",\n    span: 7..9,\n    sql_segment: \"$$\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT $hello$$",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected expression\",\n    span: 7..8,\n    sql_segment: \"$\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT $tag$Hello World$tag$",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected expression\",\n    span: 7..8,\n    sql_segment: \"$\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT $x$hello$$",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected expression\",\n    span: 7..8,\n    sql_segment: \"$\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT '1 second'::INTERVAL {field}",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: String(\n                    SString {\n                        value: \"1 second\",\n                        span: 7..17,\n                    },\n                ),\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 17..19,\n    sql_segment: \"::\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT '1 second'::INTERVAL {field}({p})",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: String(\n                    SString {\n                        value: \"1 second\",\n                        span: 7..17,\n                    },\n                ),\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 17..19,\n    sql_segment: \"::\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT '1 second'::INTERVAL({p})",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: String(\n                    SString {\n                        value: \"1 second\",\n                        span: 7..17,\n                    },\n                ),\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 17..19,\n    sql_segment: \"::\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT '123'::INTEGER",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: String(\n                    SString {\n                        value: \"123\",\n                        span: 7..12,\n                    },\n                ),\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 12..14,\n    sql_segment: \"::\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT '2024-01-01 12:00:00'::TIMESTAMP",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: String(\n                    SString {\n                        value: \"2024-01-01 12:00:00\",\n                        span: 7..28,\n                    },\n                ),\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 28..30,\n    sql_segment: \"::\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT '2024-01-01'::DATE",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: String(\n                    SString {\n                        value: \"2024-01-01\",\n                        span: 7..19,\n                    },\n                ),\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 19..21,\n    sql_segment: \"::\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT 'Hello' || ' ' || 'World'",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Binary {\n                    op: Or,\n                    op_span: 22..24,\n                    lhs: Binary {\n                        op: Or,\n                        op_span: 15..17,\n                        lhs: String(\n                            SString {\n                                value: \"Hello\",\n                                span: 7..14,\n                            },\n                        ),\n                        rhs: String(\n                            SString {\n                                value: \" \",\n                                span: 18..21,\n                            },\n                        ),\n                    },\n                    rhs: String(\n                        SString {\n                            value: \"World\",\n                            span: 25..32,\n                        },\n                    ),\n                },\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT 'abc' {str_op} '^a'",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: String(\n                    SString {\n                        value: \"abc\",\n                        span: 7..12,\n                    },\n                ),\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 13..14,\n    sql_segment: \"{\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT 'abc' {str_op} 'a_c%'",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: String(\n                    SString {\n                        value: \"abc\",\n                        span: 7..12,\n                    },\n                ),\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 13..14,\n    sql_segment: \"{\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT 'abc' {str_op} ALL(ARRAY['a_c%'])",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: String(\n                    SString {\n                        value: \"abc\",\n                        span: 7..12,\n                    },\n                ),\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 13..14,\n    sql_segment: \"{\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT 'abc' {str_op} ANY(ARRAY['^a', 'x'])",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: String(\n                    SString {\n                        value: \"abc\",\n                        span: 7..12,\n                    },\n                ),\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 13..14,\n    sql_segment: \"{\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT (CAST(ARRAY[ARRAY[2, 3]] AS INT[][]))[1][2]",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Invalid(\n                    8..12,\n                ),\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'AS' here\",\n    span: 18..19,\n    sql_segment: \"[\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 44..45,\n    sql_segment: \"[\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT (SELECT COUNT(*) FROM orders WHERE orders.user_id = users.id) AS order_count FROM users",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Subquery(\n                    Select(\n                        Select {\n                            select_span: 8..14,\n                            flags: [],\n                            select_exprs: [\n                                SelectExpr {\n                                    expr: Count {\n                                        count_span: 15..20,\n                                        distinct_span: None,\n                                        expr: Identifier(\n                                            [\n                                                Star(\n                                                    21..22,\n                                                ),\n                                            ],\n                                        ),\n                                    },\n                                    as_: None,\n                                },\n                            ],\n                            from_span: Some(\n                                24..28,\n                            ),\n                            table_references: Some(\n                                [\n                                    Table {\n                                        identifier: QualifiedName {\n                                            prefix: [],\n                                            identifier: Identifier {\n                                                value: \"orders\",\n                                                span: 29..35,\n                                            },\n                                        },\n                                        as_span: None,\n                                        as_: None,\n                                        index_hints: [],\n                                    },\n                                ],\n                            ),\n                            where_: Some(\n                                (\n                                    Binary {\n                                        op: Eq,\n                                        op_span: 57..58,\n                                        lhs: Identifier(\n                                            [\n                                                Name(\n                                                    Identifier {\n                                                        value: \"orders\",\n                                                        span: 42..48,\n                                                    },\n                                                ),\n                                                Name(\n                                                    Identifier {\n                                                        value: \"user_id\",\n                                                        span: 49..56,\n                                                    },\n                                                ),\n                                            ],\n                                        ),\n                                        rhs: Identifier(\n                                            [\n                                                Name(\n                                                    Identifier {\n                                                        value: \"users\",\n                                                        span: 59..64,\n                                                    },\n                                                ),\n                                                Name(\n                                                    Identifier {\n                                                        value: \"id\",\n                                                        span: 65..67,\n                                                    },\n                                                ),\n                                            ],\n                                        ),\n                                    },\n                                    36..41,\n                                ),\n                            ),\n                            group_by: None,\n                            having: None,\n                            window_span: None,\n                            order_by: None,\n                            limit: None,\n                            locking: None,\n                        },\n                    ),\n                ),\n                as_: Some(\n                    Identifier {\n                        value: \"order_count\",\n                        span: 72..83,\n                    },\n                ),\n            },\n        ],\n        from_span: Some(\n            84..88,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"users\",\n                            span: 89..94,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT (information_schema._pg_expandarray(ARRAY['i', 'i'])).n",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected '')'' here\",\n    span: 48..49,\n    sql_segment: \"[\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT (on_hand.item).name FROM on_hand WHERE (on_hand.item).price > 9",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"on_hand\",\n                                span: 8..15,\n                            },\n                        ),\n                        Name(\n                            Identifier {\n                                value: \"item\",\n                                span: 16..20,\n                            },\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 21..22,\n    sql_segment: \".\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT * FROM (VALUES (1, 'a'), (2, 'b'), (3, 'c')) AS t (id, name)",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Star(\n                            7..8,\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            9..13,\n        ),\n        table_references: Some(\n            [\n                Query {\n                    query: Invalid(\n                        14..15,\n                    ),\n                    as_span: Some(\n                        52..54,\n                    ),\n                    as_: Some(\n                        Identifier {\n                            value: \"t\",\n                            span: 55..56,\n                        },\n                    ),\n                },\n            ],\n        ),\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''SELECET' or '('' here\",\n    span: 15..21,\n    sql_segment: \"VALUES\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 57..58,\n    sql_segment: \"(\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT * FROM JSON_TABLE",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Star(\n                            7..8,\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            9..13,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"JSON_TABLE\",\n                            span: 14..24,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT * FROM UNNEST([10, 20, 30]) WITH ORDINALITY AS t",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected '')'' here\",\n    span: 55..55,\n    sql_segment: \"\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT * FROM arr_test WHERE 'tag1' = ANY(tags)",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Star(\n                            7..8,\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            9..13,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"arr_test\",\n                            span: 14..22,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: Some(\n            (\n                Binary {\n                    op: Eq,\n                    op_span: 36..37,\n                    lhs: String(\n                        SString {\n                            value: \"tag1\",\n                            span: 29..35,\n                        },\n                    ),\n                    rhs: Function(\n                        Other(\n                            \"ANY\",\n                        ),\n                        [\n                            Identifier(\n                                [\n                                    Name(\n                                        Identifier {\n                                            value: \"tags\",\n                                            span: 42..46,\n                                        },\n                                    ),\n                                ],\n                            ),\n                        ],\n                        38..41,\n                    ),\n                },\n                23..28,\n            ),\n        ),\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT * FROM arr_test WHERE tags && ARRAY['tag1', 'tag5']",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Star(\n                            7..8,\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            9..13,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"arr_test\",\n                            span: 14..22,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: Some(\n            (\n                Binary {\n                    op: And,\n                    op_span: 34..36,\n                    lhs: Identifier(\n                        [\n                            Name(\n                                Identifier {\n                                    value: \"tags\",\n                                    span: 29..33,\n                                },\n                            ),\n                        ],\n                    ),\n                    rhs: Identifier(\n                        [\n                            Name(\n                                Identifier {\n                                    value: \"ARRAY\",\n                                    span: 37..42,\n                                },\n                            ),\n                        ],\n                    ),\n                },\n                23..28,\n            ),\n        ),\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 42..43,\n    sql_segment: \"[\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT * FROM arr_test WHERE tags @> ARRAY['tag1']",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'identifier' here\",\n    span: 35..36,\n    sql_segment: \">\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT * FROM customers WHERE customers.id = a1",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Star(\n                            7..8,\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            9..13,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"customers\",\n                            span: 14..23,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: Some(\n            (\n                Binary {\n                    op: Eq,\n                    op_span: 43..44,\n                    lhs: Identifier(\n                        [\n                            Name(\n                                Identifier {\n                                    value: \"customers\",\n                                    span: 30..39,\n                                },\n                            ),\n                            Name(\n                                Identifier {\n                                    value: \"id\",\n                                    span: 40..42,\n                                },\n                            ),\n                        ],\n                    ),\n                    rhs: Identifier(\n                        [\n                            Name(\n                                Identifier {\n                                    value: \"a1\",\n                                    span: 45..47,\n                                },\n                            ),\n                        ],\n                    ),\n                },\n                24..29,\n            ),\n        ),\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT * FROM events WHERE relname OPERATOR(database.pg_catalog.~) '^(table)$'",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected expression\",\n    span: 44..52,\n    sql_segment: \"database\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expression should not follow expression\",\n    span: 67..78,\n    sql_segment: \"'^(table)$'\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT * FROM events WHERE relname OPERATOR(pg_catalog.~) '^(table)$'",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Identifier or '*'' here\",\n    span: 55..56,\n    sql_segment: \"~\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expression should not follow expression\",\n    span: 58..69,\n    sql_segment: \"'^(table)$'\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT * FROM events WHERE relname OPERATOR(~) '^(table)$'",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected expression\",\n    span: 44..45,\n    sql_segment: \"~\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expression should not follow expression\",\n    span: 47..58,\n    sql_segment: \"'^(table)$'\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT * FROM generate_series('2024-01-01'::DATE, '2024-01-31'::DATE, '1 day'::INTERVAL)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected '')'' here\",\n    span: 88..88,\n    sql_segment: \"\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT * FROM generate_series(1, 10)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected '')'' here\",\n    span: 36..36,\n    sql_segment: \"\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT * FROM generate_series(1, 10) WITH ORDINALITY AS t",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected '')'' here\",\n    span: 57..57,\n    sql_segment: \"\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT * FROM generate_series(1, 10, 2)",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected '')'' here\",\n    span: 39..39,\n    sql_segment: \"\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT * FROM t1 JOIN UNNEST(t1.a) AS f ON c1 = c2",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected '')'' here\",\n    span: 50..50,\n    sql_segment: \"\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT * FROM users CROSS JOIN categories",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Star(\n                            7..8,\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            9..13,\n        ),\n        table_references: Some(\n            [\n                Join {\n                    join: Cross(\n                        20..30,\n                    ),\n                    left: Table {\n                        identifier: QualifiedName {\n                            prefix: [],\n                            identifier: Identifier {\n                                value: \"users\",\n                                span: 14..19,\n                            },\n                        },\n                        as_span: None,\n                        as_: None,\n                        index_hints: [],\n                    },\n                    right: Table {\n                        identifier: QualifiedName {\n                            prefix: [],\n                            identifier: Identifier {\n                                value: \"categories\",\n                                span: 31..41,\n                            },\n                        },\n                        as_span: None,\n                        as_: None,\n                        index_hints: [],\n                    },\n                    specification: None,\n                },\n            ],\n        ),\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT * FROM users FETCH FIRST 10 ROWS ONLY",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Star(\n                            7..8,\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            9..13,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"users\",\n                            span: 14..19,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 20..25,\n    sql_segment: \"FETCH\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT * FROM users FULL OUTER JOIN orders ON users.id = orders.user_id",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Star(\n                            7..8,\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            9..13,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"users\",\n                            span: 14..19,\n                        },\n                    },\n                    as_span: None,\n                    as_: Some(\n                        Identifier {\n                            value: \"FULL\",\n                            span: 20..24,\n                        },\n                    ),\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 25..30,\n    sql_segment: \"OUTER\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT * FROM users LEFT JOIN LATERAL (SELECT * FROM orders WHERE orders.user_id = users.id ORDER BY created_at DESC LIMIT 5) o ON true",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected '')'' here\",\n    span: 135..135,\n    sql_segment: \"\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT * FROM users LEFT JOIN orders ON users.id = orders.user_id",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Star(\n                            7..8,\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            9..13,\n        ),\n        table_references: Some(\n            [\n                Join {\n                    join: Left(\n                        20..29,\n                    ),\n                    left: Table {\n                        identifier: QualifiedName {\n                            prefix: [],\n                            identifier: Identifier {\n                                value: \"users\",\n                                span: 14..19,\n                            },\n                        },\n                        as_span: None,\n                        as_: None,\n                        index_hints: [],\n                    },\n                    right: Table {\n                        identifier: QualifiedName {\n                            prefix: [],\n                            identifier: Identifier {\n                                value: \"orders\",\n                                span: 30..36,\n                            },\n                        },\n                        as_span: None,\n                        as_: None,\n                        index_hints: [],\n                    },\n                    specification: Some(\n                        On(\n                            Binary {\n                                op: Eq,\n                                op_span: 49..50,\n                                lhs: Identifier(\n                                    [\n                                        Name(\n                                            Identifier {\n                                                value: \"users\",\n                                                span: 40..45,\n                                            },\n                                        ),\n                                        Name(\n                                            Identifier {\n                                                value: \"id\",\n                                                span: 46..48,\n                                            },\n                                        ),\n                                    ],\n                                ),\n                                rhs: Identifier(\n                                    [\n                                        Name(\n                                            Identifier {\n                                                value: \"orders\",\n                                                span: 51..57,\n                                            },\n                                        ),\n                                        Name(\n                                            Identifier {\n                                                value: \"user_id\",\n                                                span: 58..65,\n                                            },\n                                        ),\n                                    ],\n                                ),\n                            },\n                            37..39,\n                        ),\n                    ),\n                },\n            ],\n        ),\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT * FROM users LIMIT 10",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Star(\n                            7..8,\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            9..13,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"users\",\n                            span: 14..19,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: Some(\n            (\n                20..25,\n                None,\n                Integer(\n                    (\n                        10,\n                        26..28,\n                    ),\n                ),\n            ),\n        ),\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT * FROM users LIMIT 10 OFFSET 20",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Star(\n                            7..8,\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            9..13,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"users\",\n                            span: 14..19,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: Some(\n            (\n                20..25,\n                Some(\n                    Integer(\n                        (\n                            20,\n                            36..38,\n                        ),\n                    ),\n                ),\n                Integer(\n                    (\n                        10,\n                        26..28,\n                    ),\n                ),\n            ),\n        ),\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT * FROM users OFFSET 100",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Star(\n                            7..8,\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            9..13,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"users\",\n                            span: 14..19,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 20..26,\n    sql_segment: \"OFFSET\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT * FROM users OFFSET 20 ROWS FETCH NEXT 10 ROWS ONLY",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Star(\n                            7..8,\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            9..13,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"users\",\n                            span: 14..19,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 20..26,\n    sql_segment: \"OFFSET\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT * FROM users ORDER BY last_login DESC NULLS LAST",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Star(\n                            7..8,\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            9..13,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"users\",\n                            span: 14..19,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: Some(\n            (\n                20..28,\n                [\n                    (\n                        Identifier(\n                            [\n                                Name(\n                                    Identifier {\n                                        value: \"last_login\",\n                                        span: 29..39,\n                                    },\n                                ),\n                            ],\n                        ),\n                        Desc(\n                            40..44,\n                        ),\n                    ),\n                ],\n            ),\n        ),\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 45..50,\n    sql_segment: \"NULLS\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT * FROM users ORDER BY last_login NULLS FIRST",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expression should not follow expression\",\n    span: 46..51,\n    sql_segment: \"FIRST\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT * FROM users RIGHT JOIN orders ON users.id = orders.user_id",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Star(\n                            7..8,\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            9..13,\n        ),\n        table_references: Some(\n            [\n                Join {\n                    join: Right(\n                        20..30,\n                    ),\n                    left: Table {\n                        identifier: QualifiedName {\n                            prefix: [],\n                            identifier: Identifier {\n                                value: \"users\",\n                                span: 14..19,\n                            },\n                        },\n                        as_span: None,\n                        as_: None,\n                        index_hints: [],\n                    },\n                    right: Table {\n                        identifier: QualifiedName {\n                            prefix: [],\n                            identifier: Identifier {\n                                value: \"orders\",\n                                span: 31..37,\n                            },\n                        },\n                        as_span: None,\n                        as_: None,\n                        index_hints: [],\n                    },\n                    specification: Some(\n                        On(\n                            Binary {\n                                op: Eq,\n                                op_span: 50..51,\n                                lhs: Identifier(\n                                    [\n                                        Name(\n                                            Identifier {\n                                                value: \"users\",\n                                                span: 41..46,\n                                            },\n                                        ),\n                                        Name(\n                                            Identifier {\n                                                value: \"id\",\n                                                span: 47..49,\n                                            },\n                                        ),\n                                    ],\n                                ),\n                                rhs: Identifier(\n                                    [\n                                        Name(\n                                            Identifier {\n                                                value: \"orders\",\n                                                span: 52..58,\n                                            },\n                                        ),\n                                        Name(\n                                            Identifier {\n                                                value: \"user_id\",\n                                                span: 59..66,\n                                            },\n                                        ),\n                                    ],\n                                ),\n                            },\n                            38..40,\n                        ),\n                    ),\n                },\n            ],\n        ),\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT * FROM users WHERE EXISTS (SELECT 1 FROM orders WHERE orders.user_id = users.id)",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Star(\n                            7..8,\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            9..13,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"users\",\n                            span: 14..19,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: Some(\n            (\n                Exists(\n                    Select(\n                        Select {\n                            select_span: 34..40,\n                            flags: [],\n                            select_exprs: [\n                                SelectExpr {\n                                    expr: Integer(\n                                        (\n                                            1,\n                                            41..42,\n                                        ),\n                                    ),\n                                    as_: None,\n                                },\n                            ],\n                            from_span: Some(\n                                43..47,\n                            ),\n                            table_references: Some(\n                                [\n                                    Table {\n                                        identifier: QualifiedName {\n                                            prefix: [],\n                                            identifier: Identifier {\n                                                value: \"orders\",\n                                                span: 48..54,\n                                            },\n                                        },\n                                        as_span: None,\n                                        as_: None,\n                                        index_hints: [],\n                                    },\n                                ],\n                            ),\n                            where_: Some(\n                                (\n                                    Binary {\n                                        op: Eq,\n                                        op_span: 76..77,\n                                        lhs: Identifier(\n                                            [\n                                                Name(\n                                                    Identifier {\n                                                        value: \"orders\",\n                                                        span: 61..67,\n                                                    },\n                                                ),\n                                                Name(\n                                                    Identifier {\n                                                        value: \"user_id\",\n                                                        span: 68..75,\n                                                    },\n                                                ),\n                                            ],\n                                        ),\n                                        rhs: Identifier(\n                                            [\n                                                Name(\n                                                    Identifier {\n                                                        value: \"users\",\n                                                        span: 78..83,\n                                                    },\n                                                ),\n                                                Name(\n                                                    Identifier {\n                                                        value: \"id\",\n                                                        span: 84..86,\n                                                    },\n                                                ),\n                                            ],\n                                        ),\n                                    },\n                                    55..60,\n                                ),\n                            ),\n                            group_by: None,\n                            having: None,\n                            window_span: None,\n                            order_by: None,\n                            limit: None,\n                            locking: None,\n                        },\n                    ),\n                ),\n                20..25,\n            ),\n        ),\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT * FROM users WHERE email SIMILAR TO '%@example.com'",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expression should not follow expression\",\n    span: 40..42,\n    sql_segment: \"TO\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT * FROM users WHERE id IN (SELECT user_id FROM orders WHERE total > 100)",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Star(\n                            7..8,\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            9..13,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"users\",\n                            span: 14..19,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: Some(\n            (\n                In {\n                    lhs: Identifier(\n                        [\n                            Name(\n                                Identifier {\n                                    value: \"id\",\n                                    span: 26..28,\n                                },\n                            ),\n                        ],\n                    ),\n                    rhs: [\n                        Subquery(\n                            Select(\n                                Select {\n                                    select_span: 33..39,\n                                    flags: [],\n                                    select_exprs: [\n                                        SelectExpr {\n                                            expr: Identifier(\n                                                [\n                                                    Name(\n                                                        Identifier {\n                                                            value: \"user_id\",\n                                                            span: 40..47,\n                                                        },\n                                                    ),\n                                                ],\n                                            ),\n                                            as_: None,\n                                        },\n                                    ],\n                                    from_span: Some(\n                                        48..52,\n                                    ),\n                                    table_references: Some(\n                                        [\n                                            Table {\n                                                identifier: QualifiedName {\n                                                    prefix: [],\n                                                    identifier: Identifier {\n                                                        value: \"orders\",\n                                                        span: 53..59,\n                                                    },\n                                                },\n                                                as_span: None,\n                                                as_: None,\n                                                index_hints: [],\n                                            },\n                                        ],\n                                    ),\n                                    where_: Some(\n                                        (\n                                            Binary {\n                                                op: Gt,\n                                                op_span: 72..73,\n                                                lhs: Identifier(\n                                                    [\n                                                        Name(\n                                                            Identifier {\n                                                                value: \"total\",\n                                                                span: 66..71,\n                                                            },\n                                                        ),\n                                                    ],\n                                                ),\n                                                rhs: Integer(\n                                                    (\n                                                        100,\n                                                        74..77,\n                                                    ),\n                                                ),\n                                            },\n                                            60..65,\n                                        ),\n                                    ),\n                                    group_by: None,\n                                    having: None,\n                                    window_span: None,\n                                    order_by: None,\n                                    limit: None,\n                                    locking: None,\n                                },\n                            ),\n                        ),\n                    ],\n                    in_span: 29..31,\n                    not_in: false,\n                },\n                20..25,\n            ),\n        ),\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT * FROM users WHERE name !~ '[0-9]'",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Unary operator cannot come before expression\",\n    span: 32..33,\n    sql_segment: \"~\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT * FROM users WHERE name ~ '^[A-Z]'",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Star(\n                            7..8,\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            9..13,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"users\",\n                            span: 14..19,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: Some(\n            (\n                Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"name\",\n                                span: 26..30,\n                            },\n                        ),\n                    ],\n                ),\n                20..25,\n            ),\n        ),\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 31..32,\n    sql_segment: \"~\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT * FROM users WHERE name ~* '^john'",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Star(\n                            7..8,\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            9..13,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"users\",\n                            span: 14..19,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: Some(\n            (\n                Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"name\",\n                                span: 26..30,\n                            },\n                        ),\n                    ],\n                ),\n                20..25,\n            ),\n        ),\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 31..32,\n    sql_segment: \"~\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT * FROM users WHERE status IS DISTINCT FROM 'active'",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''NOT', 'TRUE', 'FALSE', 'UNKNOWN' or 'NULL'' here\",\n    span: 36..44,\n    sql_segment: \"DISTINCT\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT * FROM users WHERE status IS NOT DISTINCT FROM NULL",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TRUE', 'FALSE', 'UNKNOWN' or 'NULL'' here\",\n    span: 40..48,\n    sql_segment: \"DISTINCT\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT * FROM users u JOIN orders o ON u.id = o.user_id JOIN products p ON o.product_id = p.id",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Star(\n                            7..8,\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            9..13,\n        ),\n        table_references: Some(\n            [\n                Join {\n                    join: Normal(\n                        56..60,\n                    ),\n                    left: Join {\n                        join: Normal(\n                            22..26,\n                        ),\n                        left: Table {\n                            identifier: QualifiedName {\n                                prefix: [],\n                                identifier: Identifier {\n                                    value: \"users\",\n                                    span: 14..19,\n                                },\n                            },\n                            as_span: None,\n                            as_: Some(\n                                Identifier {\n                                    value: \"u\",\n                                    span: 20..21,\n                                },\n                            ),\n                            index_hints: [],\n                        },\n                        right: Table {\n                            identifier: QualifiedName {\n                                prefix: [],\n                                identifier: Identifier {\n                                    value: \"orders\",\n                                    span: 27..33,\n                                },\n                            },\n                            as_span: None,\n                            as_: Some(\n                                Identifier {\n                                    value: \"o\",\n                                    span: 34..35,\n                                },\n                            ),\n                            index_hints: [],\n                        },\n                        specification: Some(\n                            On(\n                                Binary {\n                                    op: Eq,\n                                    op_span: 44..45,\n                                    lhs: Identifier(\n                                        [\n                                            Name(\n                                                Identifier {\n                                                    value: \"u\",\n                                                    span: 39..40,\n                                                },\n                                            ),\n                                            Name(\n                                                Identifier {\n                                                    value: \"id\",\n                                                    span: 41..43,\n                                                },\n                                            ),\n                                        ],\n                                    ),\n                                    rhs: Identifier(\n                                        [\n                                            Name(\n                                                Identifier {\n                                                    value: \"o\",\n                                                    span: 46..47,\n                                                },\n                                            ),\n                                            Name(\n                                                Identifier {\n                                                    value: \"user_id\",\n                                                    span: 48..55,\n                                                },\n                                            ),\n                                        ],\n                                    ),\n                                },\n                                36..38,\n                            ),\n                        ),\n                    },\n                    right: Table {\n                        identifier: QualifiedName {\n                            prefix: [],\n                            identifier: Identifier {\n                                value: \"products\",\n                                span: 61..69,\n                            },\n                        },\n                        as_span: None,\n                        as_: Some(\n                            Identifier {\n                                value: \"p\",\n                                span: 70..71,\n                            },\n                        ),\n                        index_hints: [],\n                    },\n                    specification: Some(\n                        On(\n                            Binary {\n                                op: Eq,\n                                op_span: 88..89,\n                                lhs: Identifier(\n                                    [\n                                        Name(\n                                            Identifier {\n                                                value: \"o\",\n                                                span: 75..76,\n                                            },\n                                        ),\n                                        Name(\n                                            Identifier {\n                                                value: \"product_id\",\n                                                span: 77..87,\n                                            },\n                                        ),\n                                    ],\n                                ),\n                                rhs: Identifier(\n                                    [\n                                        Name(\n                                            Identifier {\n                                                value: \"p\",\n                                                span: 90..91,\n                                            },\n                                        ),\n                                        Name(\n                                            Identifier {\n                                                value: \"id\",\n                                                span: 92..94,\n                                            },\n                                        ),\n                                    ],\n                                ),\n                            },\n                            72..74,\n                        ),\n                    ),\n                },\n            ],\n        ),\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT * FROM users, LATERAL (SELECT * FROM orders WHERE orders.user_id = users.id) AS o",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected '')'' here\",\n    span: 88..88,\n    sql_segment: \"\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT ARRAY(SELECT 1 UNION SELECT 2)",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Function(\n                    Other(\n                        \"ARRAY\",\n                    ),\n                    [\n                        Subquery(\n                            Select(\n                                Select {\n                                    select_span: 13..19,\n                                    flags: [],\n                                    select_exprs: [\n                                        SelectExpr {\n                                            expr: Integer(\n                                                (\n                                                    1,\n                                                    20..21,\n                                                ),\n                                            ),\n                                            as_: None,\n                                        },\n                                    ],\n                                    from_span: None,\n                                    table_references: None,\n                                    where_: None,\n                                    group_by: None,\n                                    having: None,\n                                    window_span: None,\n                                    order_by: None,\n                                    limit: None,\n                                    locking: None,\n                                },\n                            ),\n                        ),\n                    ],\n                    7..12,\n                ),\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected '')' or ','' here\",\n    span: 22..27,\n    sql_segment: \"UNION\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT ARRAY[1, 2, 3, 4, 5]",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"ARRAY\",\n                                span: 7..12,\n                            },\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 12..13,\n    sql_segment: \"[\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT ARRAY[[1, 2], [3, 4]]",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"ARRAY\",\n                                span: 7..12,\n                            },\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 12..13,\n    sql_segment: \"[\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT ARRAY[]",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"ARRAY\",\n                                span: 7..12,\n                            },\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 12..13,\n    sql_segment: \"[\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT ARRAY_AGG(my_schema.sections_tbl.*) AS sections FROM sections_tbl",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Function(\n                    Other(\n                        \"ARRAY_AGG\",\n                    ),\n                    [\n                        Identifier(\n                            [\n                                Name(\n                                    Identifier {\n                                        value: \"my_schema\",\n                                        span: 17..26,\n                                    },\n                                ),\n                                Name(\n                                    Identifier {\n                                        value: \"sections_tbl\",\n                                        span: 27..39,\n                                    },\n                                ),\n                                Star(\n                                    40..41,\n                                ),\n                            ],\n                        ),\n                    ],\n                    7..16,\n                ),\n                as_: Some(\n                    Identifier {\n                        value: \"sections\",\n                        span: 46..54,\n                    },\n                ),\n            },\n        ],\n        from_span: Some(\n            55..59,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"sections_tbl\",\n                            span: 60..72,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT ARRAY_AGG(sections_tbl.*) AS sections FROM sections_tbl",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Function(\n                    Other(\n                        \"ARRAY_AGG\",\n                    ),\n                    [\n                        Identifier(\n                            [\n                                Name(\n                                    Identifier {\n                                        value: \"sections_tbl\",\n                                        span: 17..29,\n                                    },\n                                ),\n                                Star(\n                                    30..31,\n                                ),\n                            ],\n                        ),\n                    ],\n                    7..16,\n                ),\n                as_: Some(\n                    Identifier {\n                        value: \"sections\",\n                        span: 36..44,\n                    },\n                ),\n            },\n        ],\n        from_span: Some(\n            45..49,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"sections_tbl\",\n                            span: 50..62,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT B'111'",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: String(\n                    SString {\n                        value: \"\ufffd\",\n                        span: 7..13,\n                    },\n                ),\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT CASE WHEN age < 18 THEN 'minor' WHEN age < 65 THEN 'adult' ELSE 'senior' END FROM users",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Case {\n                    case_span: 7..11,\n                    value: None,\n                    whens: [\n                        When {\n                            when_span: 12..16,\n                            when: Binary {\n                                op: Lt,\n                                op_span: 21..22,\n                                lhs: Identifier(\n                                    [\n                                        Name(\n                                            Identifier {\n                                                value: \"age\",\n                                                span: 17..20,\n                                            },\n                                        ),\n                                    ],\n                                ),\n                                rhs: Integer(\n                                    (\n                                        18,\n                                        23..25,\n                                    ),\n                                ),\n                            },\n                            then_span: 26..30,\n                            then: String(\n                                SString {\n                                    value: \"minor\",\n                                    span: 31..38,\n                                },\n                            ),\n                        },\n                        When {\n                            when_span: 39..43,\n                            when: Binary {\n                                op: Lt,\n                                op_span: 48..49,\n                                lhs: Identifier(\n                                    [\n                                        Name(\n                                            Identifier {\n                                                value: \"age\",\n                                                span: 44..47,\n                                            },\n                                        ),\n                                    ],\n                                ),\n                                rhs: Integer(\n                                    (\n                                        65,\n                                        50..52,\n                                    ),\n                                ),\n                            },\n                            then_span: 53..57,\n                            then: String(\n                                SString {\n                                    value: \"adult\",\n                                    span: 58..65,\n                                },\n                            ),\n                        },\n                    ],\n                    else_: Some(\n                        (\n                            66..70,\n                            String(\n                                SString {\n                                    value: \"senior\",\n                                    span: 71..79,\n                                },\n                            ),\n                        ),\n                    ),\n                    end_span: 80..83,\n                },\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            84..88,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"users\",\n                            span: 89..94,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT CASE status WHEN 'active' THEN 1 WHEN 'inactive' THEN 0 END FROM users",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Case {\n                    case_span: 7..11,\n                    value: Some(\n                        Identifier(\n                            [\n                                Name(\n                                    Identifier {\n                                        value: \"status\",\n                                        span: 12..18,\n                                    },\n                                ),\n                            ],\n                        ),\n                    ),\n                    whens: [\n                        When {\n                            when_span: 19..23,\n                            when: String(\n                                SString {\n                                    value: \"active\",\n                                    span: 24..32,\n                                },\n                            ),\n                            then_span: 33..37,\n                            then: Integer(\n                                (\n                                    1,\n                                    38..39,\n                                ),\n                            ),\n                        },\n                        When {\n                            when_span: 40..44,\n                            when: String(\n                                SString {\n                                    value: \"inactive\",\n                                    span: 45..55,\n                                },\n                            ),\n                            then_span: 56..60,\n                            then: Integer(\n                                (\n                                    0,\n                                    61..62,\n                                ),\n                            ),\n                        },\n                    ],\n                    else_: None,\n                    end_span: 63..66,\n                },\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            67..71,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"users\",\n                            span: 72..77,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT CAST('1 second' AS INTERVAL {field}({p}))",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Cast {\n                    cast_span: 7..11,\n                    expr: String(\n                        SString {\n                            value: \"1 second\",\n                            span: 12..22,\n                        },\n                    ),\n                    as_span: 23..25,\n                    type_: DataType {\n                        identifier: 26..34,\n                        type_: Named(\n                            26..34,\n                        ),\n                        properties: [],\n                    },\n                },\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected '')'' here\",\n    span: 35..36,\n    sql_segment: \"{\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT CAST('1 second' AS INTERVAL {field})",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Cast {\n                    cast_span: 7..11,\n                    expr: String(\n                        SString {\n                            value: \"1 second\",\n                            span: 12..22,\n                        },\n                    ),\n                    as_span: 23..25,\n                    type_: DataType {\n                        identifier: 26..34,\n                        type_: Named(\n                            26..34,\n                        ),\n                        properties: [],\n                    },\n                },\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected '')'' here\",\n    span: 35..36,\n    sql_segment: \"{\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT CAST('1 second' AS INTERVAL({p}))",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Cast {\n                    cast_span: 7..11,\n                    expr: String(\n                        SString {\n                            value: \"1 second\",\n                            span: 12..22,\n                        },\n                    ),\n                    as_span: 23..25,\n                    type_: DataType {\n                        identifier: 26..34,\n                        type_: Named(\n                            26..34,\n                        ),\n                        properties: [],\n                    },\n                },\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected '')'' here\",\n    span: 34..35,\n    sql_segment: \"(\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT CAST(id AS TEXT) FROM users",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Cast {\n                    cast_span: 7..11,\n                    expr: Identifier(\n                        [\n                            Name(\n                                Identifier {\n                                    value: \"id\",\n                                    span: 12..14,\n                                },\n                            ),\n                        ],\n                    ),\n                    as_span: 15..17,\n                    type_: DataType {\n                        identifier: 18..22,\n                        type_: Text(\n                            None,\n                        ),\n                        properties: [],\n                    },\n                },\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            24..28,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"users\",\n                            span: 29..34,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT COUNT(*) FILTER (WHERE status = 'active') FROM users",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected expression\",\n    span: 24..29,\n    sql_segment: \"WHERE\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expression should not follow expression\",\n    span: 49..53,\n    sql_segment: \"FROM\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT CURRENT_CATALOG, CURRENT_USER, SESSION_USER, USER",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected expression\",\n    span: 24..36,\n    sql_segment: \"CURRENT_USER\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT DISTINCT ON (department) name, salary FROM employees ORDER BY department, salary DESC",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected expression\",\n    span: 16..18,\n    sql_segment: \"ON\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT DISTINCT ON (user_id, date) * FROM events ORDER BY user_id, date, created_at DESC",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected expression\",\n    span: 16..18,\n    sql_segment: \"ON\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT E'\\'",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"E\",\n                                span: 7..8,\n                            },\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 8..11,\n    sql_segment: \"'\\\\'\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT E'\\080'",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expression should not follow expression\",\n    span: 14..14,\n    sql_segment: \"\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT E'\\U00110000'",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expression should not follow expression\",\n    span: 20..20,\n    sql_segment: \"\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT E'\\u0000'",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expression should not follow expression\",\n    span: 16..16,\n    sql_segment: \"\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT E'\\u0001', E'\\U0010FFFF', E'\\xC', E'\\x25', E'\\2', E'\\45', E'\\445'",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expression should not follow expression\",\n    span: 16..17,\n    sql_segment: \",\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT E'\\u{0001}'",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expression should not follow expression\",\n    span: 18..18,\n    sql_segment: \"\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT E'\\xCAD'",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expression should not follow expression\",\n    span: 15..15,\n    sql_segment: \"\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT E's1 \\n s1', E's2 \\\\n s2', E's3 \\\\\\n s3', E's4 \\\\\\\\n s4', E'\\'', E'foo \\\\'",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expression should not follow expression\",\n    span: 18..19,\n    sql_segment: \",\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT GREATEST(my_schema.sections_tbl.*) AS sections FROM sections_tbl",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Function(\n                    Greatest,\n                    [\n                        Identifier(\n                            [\n                                Name(\n                                    Identifier {\n                                        value: \"my_schema\",\n                                        span: 16..25,\n                                    },\n                                ),\n                                Name(\n                                    Identifier {\n                                        value: \"sections_tbl\",\n                                        span: 26..38,\n                                    },\n                                ),\n                                Star(\n                                    39..40,\n                                ),\n                            ],\n                        ),\n                    ],\n                    7..15,\n                ),\n                as_: Some(\n                    Identifier {\n                        value: \"sections\",\n                        span: 45..53,\n                    },\n                ),\n            },\n        ],\n        from_span: Some(\n            54..58,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"sections_tbl\",\n                            span: 59..71,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT GREATEST(sections_tbl.*) AS sections FROM sections_tbl",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Function(\n                    Greatest,\n                    [\n                        Identifier(\n                            [\n                                Name(\n                                    Identifier {\n                                        value: \"sections_tbl\",\n                                        span: 16..28,\n                                    },\n                                ),\n                                Star(\n                                    29..30,\n                                ),\n                            ],\n                        ),\n                    ],\n                    7..15,\n                ),\n                as_: Some(\n                    Identifier {\n                        value: \"sections\",\n                        span: 35..43,\n                    },\n                ),\n            },\n        ],\n        from_span: Some(\n            44..48,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"sections_tbl\",\n                            span: 49..61,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT REGEXP.REGEXP AS REGEXP FROM REGEXP AS REGEXP WHERE REGEXP.REGEXP",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected expression before here\",\n    span: 13..14,\n    sql_segment: \".\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT array_length(tags, 1) FROM arr_test",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Function(\n                    Other(\n                        \"array_length\",\n                    ),\n                    [\n                        Identifier(\n                            [\n                                Name(\n                                    Identifier {\n                                        value: \"tags\",\n                                        span: 20..24,\n                                    },\n                                ),\n                            ],\n                        ),\n                        Integer(\n                            (\n                                1,\n                                26..27,\n                            ),\n                        ),\n                    ],\n                    7..19,\n                ),\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            29..33,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"arr_test\",\n                            span: 34..42,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT a{}",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"a\",\n                                span: 7..8,\n                            },\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 8..9,\n    sql_segment: \"{\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "SELECT bar[0][\"baz\"][\"fooz\"] FROM foos",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"bar\",\n                                span: 7..10,\n                            },\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 10..11,\n    sql_segment: \"[\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT brand, size, sum(sales) FROM items_sold GROUP BY size, CUBE (brand, size)",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"brand\",\n                                span: 7..12,\n                            },\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"size\",\n                                span: 14..18,\n                            },\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n            SelectExpr {\n                expr: Function(\n                    Sum,\n                    [\n                        Identifier(\n                            [\n                                Name(\n                                    Identifier {\n                                        value: \"sales\",\n                                        span: 24..29,\n                                    },\n                                ),\n                            ],\n                        ),\n                    ],\n                    20..23,\n                ),\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            31..35,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"items_sold\",\n                            span: 36..46,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: None,\n        group_by: Some(\n            (\n                47..55,\n                [\n                    Identifier(\n                        [\n                            Name(\n                                Identifier {\n                                    value: \"size\",\n                                    span: 56..60,\n                                },\n                            ),\n                        ],\n                    ),\n                    Function(\n                        Other(\n                            \"CUBE\",\n                        ),\n                        [\n                            Identifier(\n                                [\n                                    Name(\n                                        Identifier {\n                                            value: \"brand\",\n                                            span: 68..73,\n                                        },\n                                    ),\n                                ],\n                            ),\n                            Identifier(\n                                [\n                                    Name(\n                                        Identifier {\n                                            value: \"size\",\n                                            span: 75..79,\n                                        },\n                                    ),\n                                ],\n                            ),\n                        ],\n                        62..66,\n                    ),\n                ],\n            ),\n        ),\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT brand, size, sum(sales) FROM items_sold GROUP BY size, GROUPING SETS ((brand), (size), ())",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected expression\",\n    span: 95..96,\n    sql_segment: \")\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expression should not follow expression\",\n    span: 96..97,\n    sql_segment: \")\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "SELECT brand, size, sum(sales) FROM items_sold GROUP BY size, ROLLUP (brand, size)",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"brand\",\n                                span: 7..12,\n                            },\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"size\",\n                                span: 14..18,\n                            },\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n            SelectExpr {\n                expr: Function(\n                    Sum,\n                    [\n                        Identifier(\n                            [\n                                Name(\n                                    Identifier {\n                                        value: \"sales\",\n                                        span: 24..29,\n                                    },\n                                ),\n                            ],\n                        ),\n                    ],\n                    20..23,\n                ),\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            31..35,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"items_sold\",\n                            span: 36..46,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: None,\n        group_by: Some(\n            (\n                47..55,\n                [\n                    Identifier(\n                        [\n                            Name(\n                                Identifier {\n                                    value: \"size\",\n                                    span: 56..60,\n                                },\n                            ),\n                        ],\n                    ),\n                    Function(\n                        Other(\n                            \"ROLLUP\",\n                        ),\n                        [\n                            Identifier(\n                                [\n                                    Name(\n                                        Identifier {\n                                            value: \"brand\",\n                                            span: 70..75,\n                                        },\n                                    ),\n                                ],\n                            ),\n                            Identifier(\n                                [\n                                    Name(\n                                        Identifier {\n                                            value: \"size\",\n                                            span: 77..81,\n                                        },\n                                    ),\n                                ],\n                            ),\n                        ],\n                        62..68,\n                    ),\n                ],\n            ),\n        ),\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT data ? 'name' FROM users",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"data\",\n                                span: 7..11,\n                            },\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 12..13,\n    sql_segment: \"?\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT data ?& ARRAY['name', 'email'] FROM users",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"data\",\n                                span: 7..11,\n                            },\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 12..13,\n    sql_segment: \"?\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT data ?| ARRAY['name', 'email'] FROM users",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"data\",\n                                span: 7..11,\n                            },\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 12..13,\n    sql_segment: \"?\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT data#>'{address, city}' FROM users",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"data\",\n                                span: 7..11,\n                            },\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 11..12,\n    sql_segment: \"#\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT data#>>'{address, city}' FROM users",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"data\",\n                                span: 7..11,\n                            },\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 11..12,\n    sql_segment: \"#\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT data->'address'->>'city' FROM users",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Binary {\n                    op: JsonExtractUnquote,\n                    op_span: 22..25,\n                    lhs: Binary {\n                        op: JsonExtract,\n                        op_span: 11..13,\n                        lhs: Identifier(\n                            [\n                                Name(\n                                    Identifier {\n                                        value: \"data\",\n                                        span: 7..11,\n                                    },\n                                ),\n                            ],\n                        ),\n                        rhs: String(\n                            SString {\n                                value: \"address\",\n                                span: 13..22,\n                            },\n                        ),\n                    },\n                    rhs: String(\n                        SString {\n                            value: \"city\",\n                            span: 25..31,\n                        },\n                    ),\n                },\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            32..36,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"users\",\n                            span: 37..42,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT data->>'name' FROM users WHERE data @> '{\"active\": true}'",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'identifier' here\",\n    span: 44..45,\n    sql_segment: \">\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT department, AVG(salary) FILTER (WHERE hire_date > '2020-01-01') FROM employees GROUP BY department",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected expression\",\n    span: 39..44,\n    sql_segment: \"WHERE\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expression should not follow expression\",\n    span: 71..75,\n    sql_segment: \"FROM\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT first_name || ' ' || last_name AS full_name FROM users",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Binary {\n                    op: Or,\n                    op_span: 25..27,\n                    lhs: Binary {\n                        op: Or,\n                        op_span: 18..20,\n                        lhs: Identifier(\n                            [\n                                Name(\n                                    Identifier {\n                                        value: \"first_name\",\n                                        span: 7..17,\n                                    },\n                                ),\n                            ],\n                        ),\n                        rhs: String(\n                            SString {\n                                value: \" \",\n                                span: 21..24,\n                            },\n                        ),\n                    },\n                    rhs: Identifier(\n                        [\n                            Name(\n                                Identifier {\n                                    value: \"last_name\",\n                                    span: 28..37,\n                                },\n                            ),\n                        ],\n                    ),\n                },\n                as_: Some(\n                    Identifier {\n                        value: \"full_name\",\n                        span: 41..50,\n                    },\n                ),\n            },\n        ],\n        from_span: Some(\n            51..55,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"users\",\n                            span: 56..61,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT foo[0] FROM foos",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"foo\",\n                                span: 7..10,\n                            },\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 10..11,\n    sql_segment: \"[\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT foo[0][0] FROM foos",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"foo\",\n                                span: 7..10,\n                            },\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 10..11,\n    sql_segment: \"[\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT generate_series(1, 5) AS id, 'test' AS name",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Function(\n                    Other(\n                        \"generate_series\",\n                    ),\n                    [\n                        Integer(\n                            (\n                                1,\n                                23..24,\n                            ),\n                        ),\n                        Integer(\n                            (\n                                5,\n                                26..27,\n                            ),\n                        ),\n                    ],\n                    7..22,\n                ),\n                as_: Some(\n                    Identifier {\n                        value: \"id\",\n                        span: 32..34,\n                    },\n                ),\n            },\n            SelectExpr {\n                expr: String(\n                    SString {\n                        value: \"test\",\n                        span: 36..42,\n                    },\n                ),\n                as_: Some(\n                    Identifier {\n                        value: \"name\",\n                        span: 46..50,\n                    },\n                ),\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT id::TEXT FROM users",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"id\",\n                                span: 7..9,\n                            },\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 9..11,\n    sql_segment: \"::\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT info #- ARRAY['a', 'b'] FROM orders",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"info\",\n                                span: 7..11,\n                            },\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 12..13,\n    sql_segment: \"#\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT info #> '{a,b,c}' FROM orders",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"info\",\n                                span: 7..11,\n                            },\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 12..13,\n    sql_segment: \"#\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT info #>> '{a,b,c}' FROM orders",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"info\",\n                                span: 7..11,\n                            },\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 12..13,\n    sql_segment: \"#\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT info -> 'items' ->> 'product' FROM orders",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Binary {\n                    op: JsonExtractUnquote,\n                    op_span: 23..26,\n                    lhs: Binary {\n                        op: JsonExtract,\n                        op_span: 12..14,\n                        lhs: Identifier(\n                            [\n                                Name(\n                                    Identifier {\n                                        value: \"info\",\n                                        span: 7..11,\n                                    },\n                                ),\n                            ],\n                        ),\n                        rhs: String(\n                            SString {\n                                value: \"items\",\n                                span: 15..22,\n                            },\n                        ),\n                    },\n                    rhs: String(\n                        SString {\n                            value: \"product\",\n                            span: 27..36,\n                        },\n                    ),\n                },\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            37..41,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"orders\",\n                            span: 42..48,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT info FROM orders WHERE '{\"a\": 1}' <@ info",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"info\",\n                                span: 7..11,\n                            },\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            12..16,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"orders\",\n                            span: 17..23,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: Some(\n            (\n                Binary {\n                    op: Lt,\n                    op_span: 41..42,\n                    lhs: String(\n                        SString {\n                            value: \"{\\\"a\\\": 1}\",\n                            span: 30..40,\n                        },\n                    ),\n                    rhs: UserVariable {\n                        name: Identifier {\n                            value: \"info\",\n                            span: 44..48,\n                        },\n                        at_span: 42..43,\n                    },\n                },\n                24..29,\n            ),\n        ),\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT info FROM orders WHERE info ? 'b'",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"info\",\n                                span: 7..11,\n                            },\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            12..16,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"orders\",\n                            span: 17..23,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: Some(\n            (\n                Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"info\",\n                                span: 30..34,\n                            },\n                        ),\n                    ],\n                ),\n                24..29,\n            ),\n        ),\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 35..36,\n    sql_segment: \"?\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT info FROM orders WHERE info ?& ARRAY['b', 'c']",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"info\",\n                                span: 7..11,\n                            },\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            12..16,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"orders\",\n                            span: 17..23,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: Some(\n            (\n                Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"info\",\n                                span: 30..34,\n                            },\n                        ),\n                    ],\n                ),\n                24..29,\n            ),\n        ),\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 35..36,\n    sql_segment: \"?\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT info FROM orders WHERE info ?| ARRAY['b', 'c']",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"info\",\n                                span: 7..11,\n                            },\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            12..16,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"orders\",\n                            span: 17..23,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: Some(\n            (\n                Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"info\",\n                                span: 30..34,\n                            },\n                        ),\n                    ],\n                ),\n                24..29,\n            ),\n        ),\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 35..36,\n    sql_segment: \"?\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT info FROM orders WHERE info @> '{\"a\": 1}'",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'identifier' here\",\n    span: 36..37,\n    sql_segment: \">\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT info FROM orders WHERE info @? '$.a'",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'identifier' here\",\n    span: 36..37,\n    sql_segment: \"?\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT info FROM orders WHERE info @@ '$.a'",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"info\",\n                                span: 7..11,\n                            },\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            12..16,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"orders\",\n                            span: 17..23,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: Some(\n            (\n                Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"info\",\n                                span: 30..34,\n                            },\n                        ),\n                    ],\n                ),\n                24..29,\n            ),\n        ),\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 35..37,\n    sql_segment: \"@@\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT jsonb_build_object('name', name, 'email', email) FROM users",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Function(\n                    Other(\n                        \"jsonb_build_object\",\n                    ),\n                    [\n                        String(\n                            SString {\n                                value: \"name\",\n                                span: 26..32,\n                            },\n                        ),\n                        Identifier(\n                            [\n                                Name(\n                                    Identifier {\n                                        value: \"name\",\n                                        span: 34..38,\n                                    },\n                                ),\n                            ],\n                        ),\n                        String(\n                            SString {\n                                value: \"email\",\n                                span: 40..47,\n                            },\n                        ),\n                        Identifier(\n                            [\n                                Name(\n                                    Identifier {\n                                        value: \"email\",\n                                        span: 49..54,\n                                    },\n                                ),\n                            ],\n                        ),\n                    ],\n                    7..25,\n                ),\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            56..60,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"users\",\n                            span: 61..66,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT name AS user_name, email AS user_email FROM users",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"name\",\n                                span: 7..11,\n                            },\n                        ),\n                    ],\n                ),\n                as_: Some(\n                    Identifier {\n                        value: \"user_name\",\n                        span: 15..24,\n                    },\n                ),\n            },\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"email\",\n                                span: 26..31,\n                            },\n                        ),\n                    ],\n                ),\n                as_: Some(\n                    Identifier {\n                        value: \"user_email\",\n                        span: 35..45,\n                    },\n                ),\n            },\n        ],\n        from_span: Some(\n            46..50,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"users\",\n                            span: 51..56,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT name FROM users EXCEPT SELECT name FROM customers",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"name\",\n                                span: 7..11,\n                            },\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            12..16,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"users\",\n                            span: 17..22,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 23..29,\n    sql_segment: \"EXCEPT\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT name FROM users INTERSECT SELECT name FROM customers",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"name\",\n                                span: 7..11,\n                            },\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            12..16,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"users\",\n                            span: 17..22,\n                        },\n                    },\n                    as_span: None,\n                    as_: Some(\n                        Identifier {\n                            value: \"INTERSECT\",\n                            span: 23..32,\n                        },\n                    ),\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 33..39,\n    sql_segment: \"SELECT\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT name FROM users UNION ALL SELECT name FROM customers",
    "output": "Union(\n    Union {\n        left: Select(\n            Select {\n                select_span: 0..6,\n                flags: [],\n                select_exprs: [\n                    SelectExpr {\n                        expr: Identifier(\n                            [\n                                Name(\n                                    Identifier {\n                                        value: \"name\",\n                                        span: 7..11,\n                                    },\n                                ),\n                            ],\n                        ),\n                        as_: None,\n                    },\n                ],\n                from_span: Some(\n                    12..16,\n                ),\n                table_references: Some(\n                    [\n                        Table {\n                            identifier: QualifiedName {\n                                prefix: [],\n                                identifier: Identifier {\n                                    value: \"users\",\n                                    span: 17..22,\n                                },\n                            },\n                            as_span: None,\n                            as_: None,\n                            index_hints: [],\n                        },\n                    ],\n                ),\n                where_: None,\n                group_by: None,\n                having: None,\n                window_span: None,\n                order_by: None,\n                limit: None,\n                locking: None,\n            },\n        ),\n        with: [\n            UnionWith {\n                union_span: 23..28,\n                union_type: All(\n                    29..32,\n                ),\n                union_statement: Select(\n                    Select {\n                        select_span: 33..39,\n                        flags: [],\n                        select_exprs: [\n                            SelectExpr {\n                                expr: Identifier(\n                                    [\n                                        Name(\n                                            Identifier {\n                                                value: \"name\",\n                                                span: 40..44,\n                                            },\n                                        ),\n                                    ],\n                                ),\n                                as_: None,\n                            },\n                        ],\n                        from_span: Some(\n                            45..49,\n                        ),\n                        table_references: Some(\n                            [\n                                Table {\n                                    identifier: QualifiedName {\n                                        prefix: [],\n                                        identifier: Identifier {\n                                            value: \"customers\",\n                                            span: 50..59,\n                                        },\n                                    },\n                                    as_span: None,\n                                    as_: None,\n                                    index_hints: [],\n                                },\n                            ],\n                        ),\n                        where_: None,\n                        group_by: None,\n                        having: None,\n                        window_span: None,\n                        order_by: None,\n                        limit: None,\n                        locking: None,\n                    },\n                ),\n            },\n        ],\n        order_by: None,\n        limit: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT name FROM users UNION SELECT name FROM customers",
    "output": "Union(\n    Union {\n        left: Select(\n            Select {\n                select_span: 0..6,\n                flags: [],\n                select_exprs: [\n                    SelectExpr {\n                        expr: Identifier(\n                            [\n                                Name(\n                                    Identifier {\n                                        value: \"name\",\n                                        span: 7..11,\n                                    },\n                                ),\n                            ],\n                        ),\n                        as_: None,\n                    },\n                ],\n                from_span: Some(\n                    12..16,\n                ),\n                table_references: Some(\n                    [\n                        Table {\n                            identifier: QualifiedName {\n                                prefix: [],\n                                identifier: Identifier {\n                                    value: \"users\",\n                                    span: 17..22,\n                                },\n                            },\n                            as_span: None,\n                            as_: None,\n                            index_hints: [],\n                        },\n                    ],\n                ),\n                where_: None,\n                group_by: None,\n                having: None,\n                window_span: None,\n                order_by: None,\n                limit: None,\n                locking: None,\n            },\n        ),\n        with: [\n            UnionWith {\n                union_span: 23..28,\n                union_type: Default,\n                union_statement: Select(\n                    Select {\n                        select_span: 29..35,\n                        flags: [],\n                        select_exprs: [\n                            SelectExpr {\n                                expr: Identifier(\n                                    [\n                                        Name(\n                                            Identifier {\n                                                value: \"name\",\n                                                span: 36..40,\n                                            },\n                                        ),\n                                    ],\n                                ),\n                                as_: None,\n                            },\n                        ],\n                        from_span: Some(\n                            41..45,\n                        ),\n                        table_references: Some(\n                            [\n                                Table {\n                                    identifier: QualifiedName {\n                                        prefix: [],\n                                        identifier: Identifier {\n                                            value: \"customers\",\n                                            span: 46..55,\n                                        },\n                                    },\n                                    as_span: None,\n                                    as_: None,\n                                    index_hints: [],\n                                },\n                            ],\n                        ),\n                        where_: None,\n                        group_by: None,\n                        having: None,\n                        window_span: None,\n                        order_by: None,\n                        limit: None,\n                        locking: None,\n                    },\n                ),\n            },\n        ],\n        order_by: None,\n        limit: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT name, LAG(salary, 1) OVER (ORDER BY hire_date), LEAD(salary, 1) OVER (ORDER BY hire_date) FROM employees",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"name\",\n                                span: 7..11,\n                            },\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n            SelectExpr {\n                expr: WindowFunction {\n                    function: Lag,\n                    args: [\n                        Identifier(\n                            [\n                                Name(\n                                    Identifier {\n                                        value: \"salary\",\n                                        span: 17..23,\n                                    },\n                                ),\n                            ],\n                        ),\n                        Integer(\n                            (\n                                1,\n                                25..26,\n                            ),\n                        ),\n                    ],\n                    function_span: 13..16,\n                    over_span: 28..32,\n                    window_spec: WindowSpec {\n                        order_by: (\n                            34..42,\n                            [\n                                (\n                                    Identifier(\n                                        [\n                                            Name(\n                                                Identifier {\n                                                    value: \"hire_date\",\n                                                    span: 43..52,\n                                                },\n                                            ),\n                                        ],\n                                    ),\n                                    None,\n                                ),\n                            ],\n                        ),\n                    },\n                },\n                as_: None,\n            },\n            SelectExpr {\n                expr: WindowFunction {\n                    function: Lead,\n                    args: [\n                        Identifier(\n                            [\n                                Name(\n                                    Identifier {\n                                        value: \"salary\",\n                                        span: 60..66,\n                                    },\n                                ),\n                            ],\n                        ),\n                        Integer(\n                            (\n                                1,\n                                68..69,\n                            ),\n                        ),\n                    ],\n                    function_span: 55..59,\n                    over_span: 71..75,\n                    window_spec: WindowSpec {\n                        order_by: (\n                            77..85,\n                            [\n                                (\n                                    Identifier(\n                                        [\n                                            Name(\n                                                Identifier {\n                                                    value: \"hire_date\",\n                                                    span: 86..95,\n                                                },\n                                            ),\n                                        ],\n                                    ),\n                                    None,\n                                ),\n                            ],\n                        ),\n                    },\n                },\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            97..101,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"employees\",\n                            span: 102..111,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT name, salary, AVG(salary) OVER (PARTITION BY department) FROM employees",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'ORDER' here\",\n    span: 39..48,\n    sql_segment: \"PARTITION\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT name, salary, SUM(salary) OVER (ORDER BY hire_date RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) FROM employees",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected '')'' here\",\n    span: 58..63,\n    sql_segment: \"RANGE\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT name, salary, SUM(salary) OVER (ORDER BY hire_date ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) FROM employees",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected '')'' here\",\n    span: 58..62,\n    sql_segment: \"ROWS\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT name, salary, rank() OVER (ORDER BY salary DESC) FROM employees",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"name\",\n                                span: 7..11,\n                            },\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"salary\",\n                                span: 13..19,\n                            },\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n            SelectExpr {\n                expr: WindowFunction {\n                    function: Other(\n                        \"rank\",\n                    ),\n                    args: [],\n                    function_span: 21..25,\n                    over_span: 28..32,\n                    window_spec: WindowSpec {\n                        order_by: (\n                            34..42,\n                            [\n                                (\n                                    Identifier(\n                                        [\n                                            Name(\n                                                Identifier {\n                                                    value: \"salary\",\n                                                    span: 43..49,\n                                                },\n                                            ),\n                                        ],\n                                    ),\n                                    Desc(\n                                        50..54,\n                                    ),\n                                ),\n                            ],\n                        ),\n                    },\n                },\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            56..60,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"employees\",\n                            span: 61..70,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT name, salary, rank() OVER (PARTITION BY department ORDER BY salary DESC) FROM employees",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'ORDER' here\",\n    span: 34..43,\n    sql_segment: \"PARTITION\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "SELECT obj -> 3 * 2",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Binary {\n                    op: Mult,\n                    op_span: 16..17,\n                    lhs: Binary {\n                        op: JsonExtract,\n                        op_span: 11..13,\n                        lhs: Identifier(\n                            [\n                                Name(\n                                    Identifier {\n                                        value: \"obj\",\n                                        span: 7..10,\n                                    },\n                                ),\n                            ],\n                        ),\n                        rhs: Integer(\n                            (\n                                3,\n                                14..15,\n                            ),\n                        ),\n                    },\n                    rhs: Integer(\n                        (\n                            2,\n                            18..19,\n                        ),\n                    ),\n                },\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT obj -> 42",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Binary {\n                    op: JsonExtract,\n                    op_span: 11..13,\n                    lhs: Identifier(\n                        [\n                            Name(\n                                Identifier {\n                                    value: \"obj\",\n                                    span: 7..10,\n                                },\n                            ),\n                        ],\n                    ),\n                    rhs: Integer(\n                        (\n                            42,\n                            14..16,\n                        ),\n                    ),\n                },\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT obj -> key",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected expression\",\n    span: 14..17,\n    sql_segment: \"key\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT params -> 'name' FROM events",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Binary {\n                    op: JsonExtract,\n                    op_span: 14..16,\n                    lhs: Identifier(\n                        [\n                            Name(\n                                Identifier {\n                                    value: \"params\",\n                                    span: 7..13,\n                                },\n                            ),\n                        ],\n                    ),\n                    rhs: String(\n                        SString {\n                            value: \"name\",\n                            span: 17..23,\n                        },\n                    ),\n                },\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            24..28,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"events\",\n                            span: 29..35,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT params ->> 'name' FROM events",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Binary {\n                    op: JsonExtractUnquote,\n                    op_span: 14..17,\n                    lhs: Identifier(\n                        [\n                            Name(\n                                Identifier {\n                                    value: \"params\",\n                                    span: 7..13,\n                                },\n                            ),\n                        ],\n                    ),\n                    rhs: String(\n                        SString {\n                            value: \"name\",\n                            span: 18..24,\n                        },\n                    ),\n                },\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            25..29,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"events\",\n                            span: 30..36,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT tags[1], tags[2:3] FROM arr_test",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"tags\",\n                                span: 7..11,\n                            },\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: None,\n        table_references: None,\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 11..12,\n    sql_segment: \"[\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "SELECT u.name, o.total FROM users u JOIN orders o ON u.id = o.user_id",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"u\",\n                                span: 7..8,\n                            },\n                        ),\n                        Name(\n                            Identifier {\n                                value: \"name\",\n                                span: 9..13,\n                            },\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n            SelectExpr {\n                expr: Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"o\",\n                                span: 15..16,\n                            },\n                        ),\n                        Name(\n                            Identifier {\n                                value: \"total\",\n                                span: 17..22,\n                            },\n                        ),\n                    ],\n                ),\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            23..27,\n        ),\n        table_references: Some(\n            [\n                Join {\n                    join: Normal(\n                        36..40,\n                    ),\n                    left: Table {\n                        identifier: QualifiedName {\n                            prefix: [],\n                            identifier: Identifier {\n                                value: \"users\",\n                                span: 28..33,\n                            },\n                        },\n                        as_span: None,\n                        as_: Some(\n                            Identifier {\n                                value: \"u\",\n                                span: 34..35,\n                            },\n                        ),\n                        index_hints: [],\n                    },\n                    right: Table {\n                        identifier: QualifiedName {\n                            prefix: [],\n                            identifier: Identifier {\n                                value: \"orders\",\n                                span: 41..47,\n                            },\n                        },\n                        as_span: None,\n                        as_: Some(\n                            Identifier {\n                                value: \"o\",\n                                span: 48..49,\n                            },\n                        ),\n                        index_hints: [],\n                    },\n                    specification: Some(\n                        On(\n                            Binary {\n                                op: Eq,\n                                op_span: 58..59,\n                                lhs: Identifier(\n                                    [\n                                        Name(\n                                            Identifier {\n                                                value: \"u\",\n                                                span: 53..54,\n                                            },\n                                        ),\n                                        Name(\n                                            Identifier {\n                                                value: \"id\",\n                                                span: 55..57,\n                                            },\n                                        ),\n                                    ],\n                                ),\n                                rhs: Identifier(\n                                    [\n                                        Name(\n                                            Identifier {\n                                                value: \"o\",\n                                                span: 60..61,\n                                            },\n                                        ),\n                                        Name(\n                                            Identifier {\n                                                value: \"user_id\",\n                                                span: 62..69,\n                                            },\n                                        ),\n                                    ],\n                                ),\n                            },\n                            50..52,\n                        ),\n                    ),\n                },\n            ],\n        ),\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT unnest(tags) FROM arr_test",
    "output": "Select(\n    Select {\n        select_span: 0..6,\n        flags: [],\n        select_exprs: [\n            SelectExpr {\n                expr: Function(\n                    Other(\n                        \"unnest\",\n                    ),\n                    [\n                        Identifier(\n                            [\n                                Name(\n                                    Identifier {\n                                        value: \"tags\",\n                                        span: 14..18,\n                                    },\n                                ),\n                            ],\n                        ),\n                    ],\n                    7..13,\n                ),\n                as_: None,\n            },\n        ],\n        from_span: Some(\n            20..24,\n        ),\n        table_references: Some(\n            [\n                Table {\n                    identifier: QualifiedName {\n                        prefix: [],\n                        identifier: Identifier {\n                            value: \"arr_test\",\n                            span: 25..33,\n                        },\n                    },\n                    as_span: None,\n                    as_: None,\n                    index_hints: [],\n                },\n            ],\n        ),\n        where_: None,\n        group_by: None,\n        having: None,\n        window_span: None,\n        order_by: None,\n        limit: None,\n        locking: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "SELECT {}a",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected expression\",\n    span: 7..8,\n    sql_segment: \"{\",\n    fragments: [],\n}"
    ],
    "failure": true,
    "should_fail": true
  },
  {
    "input": "SHOW search_path; SELECT 1",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''TABLES' | 'DATABASES' | 'PROCESS' | 'PROCESSLIST' | 'VARIABLES' | 'STATUS' | 'COLUMNS' | 'FIELDS' | 'CHARSET' | 'CHARACTER' | 'COLLATION' | 'ENGINES'' here\",\n    span: 5..16,\n    sql_segment: \"search_path\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "Should not be able to parse CREATE ROLE containing both negated and non-negated versions of the same keyword: {negatable_kw}",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Statement' here\",\n    span: 0..6,\n    sql_segment: \"Should\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "TRUNCATE TABLE \"users\", \"orders\" RESTART IDENTITY RESTRICT",
    "output": "TruncateTable(\n    TruncateTable {\n        truncate_span: 0..8,\n        table_span: Some(\n            9..14,\n        ),\n        table_name: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"users\",\n                span: 15..22,\n            },\n        },\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 22..23,\n    sql_segment: \",\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "TRUNCATE TABLE ONLY db.table_name RESTART IDENTITY CASCADE",
    "output": "TruncateTable(\n    TruncateTable {\n        truncate_span: 0..8,\n        table_span: Some(\n            9..14,\n        ),\n        table_name: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"ONLY\",\n                span: 15..19,\n            },\n        },\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 20..22,\n    sql_segment: \"db\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "TRUNCATE TABLE ONLY parent, child *, grandchild RESTART IDENTITY",
    "output": "TruncateTable(\n    TruncateTable {\n        truncate_span: 0..8,\n        table_span: Some(\n            9..14,\n        ),\n        table_name: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"ONLY\",\n                span: 15..19,\n            },\n        },\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 20..26,\n    sql_segment: \"parent\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "TRUNCATE TABLE db.table_name, db.other_table_name RESTART IDENTITY CASCADE",
    "output": "TruncateTable(\n    TruncateTable {\n        truncate_span: 0..8,\n        table_span: Some(\n            9..14,\n        ),\n        table_name: QualifiedName {\n            prefix: [\n                (\n                    Identifier {\n                        value: \"db\",\n                        span: 15..17,\n                    },\n                    17..18,\n                ),\n            ],\n            identifier: Identifier {\n                value: \"table_name\",\n                span: 18..28,\n            },\n        },\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 28..29,\n    sql_segment: \",\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "TRUNCATE TABLE t *",
    "output": "TruncateTable(\n    TruncateTable {\n        truncate_span: 0..8,\n        table_span: Some(\n            9..14,\n        ),\n        table_name: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"t\",\n                span: 15..16,\n            },\n        },\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 17..18,\n    sql_segment: \"*\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "TRUNCATE db.table_name",
    "output": "TruncateTable(\n    TruncateTable {\n        truncate_span: 0..8,\n        table_span: None,\n        table_name: QualifiedName {\n            prefix: [\n                (\n                    Identifier {\n                        value: \"db\",\n                        span: 9..11,\n                    },\n                    11..12,\n                ),\n            ],\n            identifier: Identifier {\n                value: \"table_name\",\n                span: 12..22,\n            },\n        },\n    },\n)",
    "issues": []
  },
  {
    "input": "TRUNCATE users, orders RESTART IDENTITY",
    "output": "TruncateTable(\n    TruncateTable {\n        truncate_span: 0..8,\n        table_span: None,\n        table_name: QualifiedName {\n            prefix: [],\n            identifier: Identifier {\n                value: \"users\",\n                span: 9..14,\n            },\n        },\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 14..15,\n    sql_segment: \",\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "UPDATE foo SET \"bar\" = 5",
    "output": "Update(\n    Update {\n        update_span: 0..6,\n        flags: [],\n        tables: [\n            Table {\n                identifier: QualifiedName {\n                    prefix: [],\n                    identifier: Identifier {\n                        value: \"foo\",\n                        span: 7..10,\n                    },\n                },\n                as_span: None,\n                as_: None,\n                index_hints: [],\n            },\n        ],\n        set_span: 11..14,\n        set: [\n            (\n                [\n                    Identifier {\n                        value: \"bar\",\n                        span: 15..20,\n                    },\n                ],\n                Integer(\n                    (\n                        5,\n                        23..24,\n                    ),\n                ),\n            ),\n        ],\n        where_: None,\n        returning: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "UPDATE test SET name = $1, value = $2, where = $3, create = $4, is_default = $5, classification = $6, sort = $7 WHERE id = $8",
    "output": "Update(\n    Update {\n        update_span: 0..6,\n        flags: [],\n        tables: [\n            Table {\n                identifier: QualifiedName {\n                    prefix: [],\n                    identifier: Identifier {\n                        value: \"test\",\n                        span: 7..11,\n                    },\n                },\n                as_span: None,\n                as_: None,\n                index_hints: [],\n            },\n        ],\n        set_span: 12..15,\n        set: [\n            (\n                [\n                    Identifier {\n                        value: \"name\",\n                        span: 16..20,\n                    },\n                ],\n                Arg(\n                    (\n                        0,\n                        23..25,\n                    ),\n                ),\n            ),\n            (\n                [\n                    Identifier {\n                        value: \"value\",\n                        span: 27..32,\n                    },\n                ],\n                Arg(\n                    (\n                        1,\n                        35..37,\n                    ),\n                ),\n            ),\n            (\n                [\n                    Identifier {\n                        value: \"where\",\n                        span: 39..44,\n                    },\n                ],\n                Arg(\n                    (\n                        2,\n                        47..49,\n                    ),\n                ),\n            ),\n            (\n                [\n                    Identifier {\n                        value: \"create\",\n                        span: 51..57,\n                    },\n                ],\n                Arg(\n                    (\n                        3,\n                        60..62,\n                    ),\n                ),\n            ),\n            (\n                [\n                    Identifier {\n                        value: \"is_default\",\n                        span: 64..74,\n                    },\n                ],\n                Arg(\n                    (\n                        4,\n                        77..79,\n                    ),\n                ),\n            ),\n            (\n                [\n                    Identifier {\n                        value: \"classification\",\n                        span: 81..95,\n                    },\n                ],\n                Arg(\n                    (\n                        5,\n                        98..100,\n                    ),\n                ),\n            ),\n            (\n                [\n                    Identifier {\n                        value: \"sort\",\n                        span: 102..106,\n                    },\n                ],\n                Arg(\n                    (\n                        6,\n                        109..111,\n                    ),\n                ),\n            ),\n        ],\n        where_: Some(\n            (\n                Binary {\n                    op: Eq,\n                    op_span: 121..122,\n                    lhs: Identifier(\n                        [\n                            Name(\n                                Identifier {\n                                    value: \"id\",\n                                    span: 118..120,\n                                },\n                            ),\n                        ],\n                    ),\n                    rhs: Arg(\n                        (\n                            7,\n                            123..125,\n                        ),\n                    ),\n                },\n                112..117,\n            ),\n        ),\n        returning: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"'where' is a reserved identifier use `where`\",\n    span: 39..44,\n    sql_segment: \"where\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"'create' is a reserved identifier use `create`\",\n    span: 51..57,\n    sql_segment: \"create\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "UPDATE test SET name=$1,\n                value=$2,\n                where=$3,\n                create=$4,\n                is_default=$5,\n                classification=$6,\n                sort=$7\n                WHERE id=$8",
    "output": "Update(\n    Update {\n        update_span: 0..6,\n        flags: [],\n        tables: [\n            Table {\n                identifier: QualifiedName {\n                    prefix: [],\n                    identifier: Identifier {\n                        value: \"test\",\n                        span: 7..11,\n                    },\n                },\n                as_span: None,\n                as_: None,\n                index_hints: [],\n            },\n        ],\n        set_span: 12..15,\n        set: [\n            (\n                [\n                    Identifier {\n                        value: \"name\",\n                        span: 16..20,\n                    },\n                ],\n                Arg(\n                    (\n                        0,\n                        21..23,\n                    ),\n                ),\n            ),\n            (\n                [\n                    Identifier {\n                        value: \"value\",\n                        span: 41..46,\n                    },\n                ],\n                Arg(\n                    (\n                        1,\n                        47..49,\n                    ),\n                ),\n            ),\n            (\n                [\n                    Identifier {\n                        value: \"where\",\n                        span: 67..72,\n                    },\n                ],\n                Arg(\n                    (\n                        2,\n                        73..75,\n                    ),\n                ),\n            ),\n            (\n                [\n                    Identifier {\n                        value: \"create\",\n                        span: 93..99,\n                    },\n                ],\n                Arg(\n                    (\n                        3,\n                        100..102,\n                    ),\n                ),\n            ),\n            (\n                [\n                    Identifier {\n                        value: \"is_default\",\n                        span: 120..130,\n                    },\n                ],\n                Arg(\n                    (\n                        4,\n                        131..133,\n                    ),\n                ),\n            ),\n            (\n                [\n                    Identifier {\n                        value: \"classification\",\n                        span: 151..165,\n                    },\n                ],\n                Arg(\n                    (\n                        5,\n                        166..168,\n                    ),\n                ),\n            ),\n            (\n                [\n                    Identifier {\n                        value: \"sort\",\n                        span: 186..190,\n                    },\n                ],\n                Arg(\n                    (\n                        6,\n                        191..193,\n                    ),\n                ),\n            ),\n        ],\n        where_: Some(\n            (\n                Binary {\n                    op: Eq,\n                    op_span: 218..219,\n                    lhs: Identifier(\n                        [\n                            Name(\n                                Identifier {\n                                    value: \"id\",\n                                    span: 216..218,\n                                },\n                            ),\n                        ],\n                    ),\n                    rhs: Arg(\n                        (\n                            7,\n                            219..221,\n                        ),\n                    ),\n                },\n                210..215,\n            ),\n        ),\n        returning: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"'where' is a reserved identifier use `where`\",\n    span: 67..72,\n    sql_segment: \"where\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"'create' is a reserved identifier use `create`\",\n    span: 93..99,\n    sql_segment: \"create\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "UPDATE users SET email = contacts.email FROM contacts WHERE users.id = contacts.user_id",
    "output": "Update(\n    Update {\n        update_span: 0..6,\n        flags: [],\n        tables: [\n            Table {\n                identifier: QualifiedName {\n                    prefix: [],\n                    identifier: Identifier {\n                        value: \"users\",\n                        span: 7..12,\n                    },\n                },\n                as_span: None,\n                as_: None,\n                index_hints: [],\n            },\n        ],\n        set_span: 13..16,\n        set: [\n            (\n                [\n                    Identifier {\n                        value: \"email\",\n                        span: 17..22,\n                    },\n                ],\n                Identifier(\n                    [\n                        Name(\n                            Identifier {\n                                value: \"contacts\",\n                                span: 25..33,\n                            },\n                        ),\n                        Name(\n                            Identifier {\n                                value: \"email\",\n                                span: 34..39,\n                            },\n                        ),\n                    ],\n                ),\n            ),\n        ],\n        where_: None,\n        returning: None,\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Unexpected token after statement' here\",\n    span: 40..44,\n    sql_segment: \"FROM\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "UPDATE users SET name = 'Jane' WHERE id = 1",
    "output": "Update(\n    Update {\n        update_span: 0..6,\n        flags: [],\n        tables: [\n            Table {\n                identifier: QualifiedName {\n                    prefix: [],\n                    identifier: Identifier {\n                        value: \"users\",\n                        span: 7..12,\n                    },\n                },\n                as_span: None,\n                as_: None,\n                index_hints: [],\n            },\n        ],\n        set_span: 13..16,\n        set: [\n            (\n                [\n                    Identifier {\n                        value: \"name\",\n                        span: 17..21,\n                    },\n                ],\n                String(\n                    SString {\n                        value: \"Jane\",\n                        span: 24..30,\n                    },\n                ),\n            ),\n        ],\n        where_: Some(\n            (\n                Binary {\n                    op: Eq,\n                    op_span: 40..41,\n                    lhs: Identifier(\n                        [\n                            Name(\n                                Identifier {\n                                    value: \"id\",\n                                    span: 37..39,\n                                },\n                            ),\n                        ],\n                    ),\n                    rhs: Integer(\n                        (\n                            1,\n                            42..43,\n                        ),\n                    ),\n                },\n                31..36,\n            ),\n        ),\n        returning: None,\n    },\n)",
    "issues": []
  },
  {
    "input": "UPDATE users SET name = 'Jane' WHERE id = 1 RETURNING *",
    "output": "Update(\n    Update {\n        update_span: 0..6,\n        flags: [],\n        tables: [\n            Table {\n                identifier: QualifiedName {\n                    prefix: [],\n                    identifier: Identifier {\n                        value: \"users\",\n                        span: 7..12,\n                    },\n                },\n                as_span: None,\n                as_: None,\n                index_hints: [],\n            },\n        ],\n        set_span: 13..16,\n        set: [\n            (\n                [\n                    Identifier {\n                        value: \"name\",\n                        span: 17..21,\n                    },\n                ],\n                String(\n                    SString {\n                        value: \"Jane\",\n                        span: 24..30,\n                    },\n                ),\n            ),\n        ],\n        where_: Some(\n            (\n                Binary {\n                    op: Eq,\n                    op_span: 40..41,\n                    lhs: Identifier(\n                        [\n                            Name(\n                                Identifier {\n                                    value: \"id\",\n                                    span: 37..39,\n                                },\n                            ),\n                        ],\n                    ),\n                    rhs: Integer(\n                        (\n                            1,\n                            42..43,\n                        ),\n                    ),\n                },\n                31..36,\n            ),\n        ),\n        returning: Some(\n            (\n                44..53,\n                [\n                    SelectExpr {\n                        expr: Identifier(\n                            [\n                                Star(\n                                    54..55,\n                                ),\n                            ],\n                        ),\n                        as_: None,\n                    },\n                ],\n            ),\n        ),\n    },\n)",
    "issues": []
  },
  {
    "input": "UPDATE users SET name = 'Jane', email = 'jane@example.com' WHERE id = 1 RETURNING id, name",
    "output": "Update(\n    Update {\n        update_span: 0..6,\n        flags: [],\n        tables: [\n            Table {\n                identifier: QualifiedName {\n                    prefix: [],\n                    identifier: Identifier {\n                        value: \"users\",\n                        span: 7..12,\n                    },\n                },\n                as_span: None,\n                as_: None,\n                index_hints: [],\n            },\n        ],\n        set_span: 13..16,\n        set: [\n            (\n                [\n                    Identifier {\n                        value: \"name\",\n                        span: 17..21,\n                    },\n                ],\n                String(\n                    SString {\n                        value: \"Jane\",\n                        span: 24..30,\n                    },\n                ),\n            ),\n            (\n                [\n                    Identifier {\n                        value: \"email\",\n                        span: 32..37,\n                    },\n                ],\n                String(\n                    SString {\n                        value: \"jane@example.com\",\n                        span: 40..58,\n                    },\n                ),\n            ),\n        ],\n        where_: Some(\n            (\n                Binary {\n                    op: Eq,\n                    op_span: 68..69,\n                    lhs: Identifier(\n                        [\n                            Name(\n                                Identifier {\n                                    value: \"id\",\n                                    span: 65..67,\n                                },\n                            ),\n                        ],\n                    ),\n                    rhs: Integer(\n                        (\n                            1,\n                            70..71,\n                        ),\n                    ),\n                },\n                59..64,\n            ),\n        ),\n        returning: Some(\n            (\n                72..81,\n                [\n                    SelectExpr {\n                        expr: Identifier(\n                            [\n                                Name(\n                                    Identifier {\n                                        value: \"id\",\n                                        span: 82..84,\n                                    },\n                                ),\n                            ],\n                        ),\n                        as_: None,\n                    },\n                    SelectExpr {\n                        expr: Identifier(\n                            [\n                                Name(\n                                    Identifier {\n                                        value: \"name\",\n                                        span: 86..90,\n                                    },\n                                ),\n                            ],\n                        ),\n                        as_: None,\n                    },\n                ],\n            ),\n        ),\n    },\n)",
    "issues": []
  },
  {
    "input": "VALUES (1, 'a'), (2, 'b'), (3, 'c')",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'Statement' here\",\n    span: 0..6,\n    sql_segment: \"VALUES\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "WITH \"result\" AS (UPDATE \"Hero\" SET \"name\" = 'Captain America', \"number_of_movies\" = \"number_of_movies\" + 1 WHERE \"secret_identity\" = 'Sam Wilson' RETURNING \"id\", \"name\", \"secret_identity\", \"number_of_movies\") SELECT * FROM \"result\"",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'subquery or identifier' here\",\n    span: 25..31,\n    sql_segment: \"\\\"Hero\\\"\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'subquery or identifier' here\",\n    span: 224..232,\n    sql_segment: \"\\\"result\\\"\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "WITH RECURSIVE cte AS (SELECT 1 AS n UNION ALL SELECT n + 1 FROM cte WHERE n < 10) SELECT * FROM cte",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"'RECURSIVE' is a reserved identifier use `RECURSIVE`\",\n    span: 5..14,\n    sql_segment: \"RECURSIVE\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected 'AS' here\",\n    span: 15..18,\n    sql_segment: \"cte\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "WITH cte AS (SELECT * FROM users WHERE active = true) SELECT * FROM cte",
    "output": "WithQuery(\n    WithQuery {\n        with_span: 0..4,\n        with_blocks: [\n            WithBlock {\n                identifier: Identifier {\n                    value: \"cte\",\n                    span: 5..8,\n                },\n                as_span: 9..11,\n                lparen_span: 12..13,\n                statement: Select(\n                    Select {\n                        select_span: 13..19,\n                        flags: [],\n                        select_exprs: [\n                            SelectExpr {\n                                expr: Identifier(\n                                    [\n                                        Star(\n                                            20..21,\n                                        ),\n                                    ],\n                                ),\n                                as_: None,\n                            },\n                        ],\n                        from_span: Some(\n                            22..26,\n                        ),\n                        table_references: Some(\n                            [\n                                Table {\n                                    identifier: QualifiedName {\n                                        prefix: [],\n                                        identifier: Identifier {\n                                            value: \"users\",\n                                            span: 27..32,\n                                        },\n                                    },\n                                    as_span: None,\n                                    as_: None,\n                                    index_hints: [],\n                                },\n                            ],\n                        ),\n                        where_: Some(\n                            (\n                                Binary {\n                                    op: Eq,\n                                    op_span: 46..47,\n                                    lhs: Identifier(\n                                        [\n                                            Name(\n                                                Identifier {\n                                                    value: \"active\",\n                                                    span: 39..45,\n                                                },\n                                            ),\n                                        ],\n                                    ),\n                                    rhs: Bool(\n                                        true,\n                                        48..52,\n                                    ),\n                                },\n                                33..38,\n                            ),\n                        ),\n                        group_by: None,\n                        having: None,\n                        window_span: None,\n                        order_by: None,\n                        limit: None,\n                        locking: None,\n                    },\n                ),\n                rparen_span: 52..53,\n            },\n        ],\n        statement: Select(\n            Select {\n                select_span: 54..60,\n                flags: [],\n                select_exprs: [\n                    SelectExpr {\n                        expr: Identifier(\n                            [\n                                Star(\n                                    61..62,\n                                ),\n                            ],\n                        ),\n                        as_: None,\n                    },\n                ],\n                from_span: Some(\n                    63..67,\n                ),\n                table_references: Some(\n                    [\n                        Table {\n                            identifier: QualifiedName {\n                                prefix: [],\n                                identifier: Identifier {\n                                    value: \"cte\",\n                                    span: 68..71,\n                                },\n                            },\n                            as_span: None,\n                            as_: None,\n                            index_hints: [],\n                        },\n                    ],\n                ),\n                where_: None,\n                group_by: None,\n                having: None,\n                window_span: None,\n                order_by: None,\n                limit: None,\n                locking: None,\n            },\n        ),\n    },\n)",
    "issues": []
  },
  {
    "input": "WITH cte AS MATERIALIZED (SELECT id FROM accounts) SELECT id FROM cte",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''('' here\",\n    span: 12..24,\n    sql_segment: \"MATERIALIZED\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "WITH cte AS NOT MATERIALIZED (SELECT id FROM accounts) SELECT id FROM cte",
    "output": null,
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected ''('' here\",\n    span: 12..15,\n    sql_segment: \"NOT\",\n    fragments: [],\n}"
    ],
    "failure": true
  },
  {
    "input": "WITH cte1 AS (SELECT * FROM users), cte2 AS (SELECT * FROM orders) SELECT * FROM cte1 JOIN cte2 ON cte1.id = cte2.user_id",
    "output": "WithQuery(\n    WithQuery {\n        with_span: 0..4,\n        with_blocks: [\n            WithBlock {\n                identifier: Identifier {\n                    value: \"cte1\",\n                    span: 5..9,\n                },\n                as_span: 10..12,\n                lparen_span: 13..14,\n                statement: Select(\n                    Select {\n                        select_span: 14..20,\n                        flags: [],\n                        select_exprs: [\n                            SelectExpr {\n                                expr: Identifier(\n                                    [\n                                        Star(\n                                            21..22,\n                                        ),\n                                    ],\n                                ),\n                                as_: None,\n                            },\n                        ],\n                        from_span: Some(\n                            23..27,\n                        ),\n                        table_references: Some(\n                            [\n                                Table {\n                                    identifier: QualifiedName {\n                                        prefix: [],\n                                        identifier: Identifier {\n                                            value: \"users\",\n                                            span: 28..33,\n                                        },\n                                    },\n                                    as_span: None,\n                                    as_: None,\n                                    index_hints: [],\n                                },\n                            ],\n                        ),\n                        where_: None,\n                        group_by: None,\n                        having: None,\n                        window_span: None,\n                        order_by: None,\n                        limit: None,\n                        locking: None,\n                    },\n                ),\n                rparen_span: 33..34,\n            },\n            WithBlock {\n                identifier: Identifier {\n                    value: \"cte2\",\n                    span: 36..40,\n                },\n                as_span: 41..43,\n                lparen_span: 44..45,\n                statement: Select(\n                    Select {\n                        select_span: 45..51,\n                        flags: [],\n                        select_exprs: [\n                            SelectExpr {\n                                expr: Identifier(\n                                    [\n                                        Star(\n                                            52..53,\n                                        ),\n                                    ],\n                                ),\n                                as_: None,\n                            },\n                        ],\n                        from_span: Some(\n                            54..58,\n                        ),\n                        table_references: Some(\n                            [\n                                Table {\n                                    identifier: QualifiedName {\n                                        prefix: [],\n                                        identifier: Identifier {\n                                            value: \"orders\",\n                                            span: 59..65,\n                                        },\n                                    },\n                                    as_span: None,\n                                    as_: None,\n                                    index_hints: [],\n                                },\n                            ],\n                        ),\n                        where_: None,\n                        group_by: None,\n                        having: None,\n                        window_span: None,\n                        order_by: None,\n                        limit: None,\n                        locking: None,\n                    },\n                ),\n                rparen_span: 65..66,\n            },\n        ],\n        statement: Select(\n            Select {\n                select_span: 67..73,\n                flags: [],\n                select_exprs: [\n                    SelectExpr {\n                        expr: Identifier(\n                            [\n                                Star(\n                                    74..75,\n                                ),\n                            ],\n                        ),\n                        as_: None,\n                    },\n                ],\n                from_span: Some(\n                    76..80,\n                ),\n                table_references: Some(\n                    [\n                        Join {\n                            join: Normal(\n                                86..90,\n                            ),\n                            left: Table {\n                                identifier: QualifiedName {\n                                    prefix: [],\n                                    identifier: Identifier {\n                                        value: \"cte1\",\n                                        span: 81..85,\n                                    },\n                                },\n                                as_span: None,\n                                as_: None,\n                                index_hints: [],\n                            },\n                            right: Table {\n                                identifier: QualifiedName {\n                                    prefix: [],\n                                    identifier: Identifier {\n                                        value: \"cte2\",\n                                        span: 91..95,\n                                    },\n                                },\n                                as_span: None,\n                                as_: None,\n                                index_hints: [],\n                            },\n                            specification: Some(\n                                On(\n                                    Binary {\n                                        op: Eq,\n                                        op_span: 107..108,\n                                        lhs: Identifier(\n                                            [\n                                                Name(\n                                                    Identifier {\n                                                        value: \"cte1\",\n                                                        span: 99..103,\n                                                    },\n                                                ),\n                                                Name(\n                                                    Identifier {\n                                                        value: \"id\",\n                                                        span: 104..106,\n                                                    },\n                                                ),\n                                            ],\n                                        ),\n                                        rhs: Identifier(\n                                            [\n                                                Name(\n                                                    Identifier {\n                                                        value: \"cte2\",\n                                                        span: 109..113,\n                                                    },\n                                                ),\n                                                Name(\n                                                    Identifier {\n                                                        value: \"user_id\",\n                                                        span: 114..121,\n                                                    },\n                                                ),\n                                            ],\n                                        ),\n                                    },\n                                    96..98,\n                                ),\n                            ),\n                        },\n                    ],\n                ),\n                where_: None,\n                group_by: None,\n                having: None,\n                window_span: None,\n                order_by: None,\n                limit: None,\n                locking: None,\n            },\n        ),\n    },\n)",
    "issues": []
  },
  {
    "input": "WITH existing AS (SELECT test_table.id FROM test_tables AS test_table WHERE (a = 12) AND (b = 34)), inserted AS (INSERT INTO test_tables AS test_table (id, a, b, c) VALUES (DEFAULT, 56, 78, 90) ON CONFLICT(a, b) DO UPDATE SET c = EXCLUDED.c WHERE (test_table.c <> EXCLUDED.c)) SELECT c FROM existing",
    "output": "WithQuery(\n    WithQuery {\n        with_span: 0..4,\n        with_blocks: [\n            WithBlock {\n                identifier: Identifier {\n                    value: \"existing\",\n                    span: 5..13,\n                },\n                as_span: 14..16,\n                lparen_span: 17..18,\n                statement: Select(\n                    Select {\n                        select_span: 18..24,\n                        flags: [],\n                        select_exprs: [\n                            SelectExpr {\n                                expr: Identifier(\n                                    [\n                                        Name(\n                                            Identifier {\n                                                value: \"test_table\",\n                                                span: 25..35,\n                                            },\n                                        ),\n                                        Name(\n                                            Identifier {\n                                                value: \"id\",\n                                                span: 36..38,\n                                            },\n                                        ),\n                                    ],\n                                ),\n                                as_: None,\n                            },\n                        ],\n                        from_span: Some(\n                            39..43,\n                        ),\n                        table_references: Some(\n                            [\n                                Table {\n                                    identifier: QualifiedName {\n                                        prefix: [],\n                                        identifier: Identifier {\n                                            value: \"test_tables\",\n                                            span: 44..55,\n                                        },\n                                    },\n                                    as_span: Some(\n                                        56..58,\n                                    ),\n                                    as_: Some(\n                                        Identifier {\n                                            value: \"test_table\",\n                                            span: 59..69,\n                                        },\n                                    ),\n                                    index_hints: [],\n                                },\n                            ],\n                        ),\n                        where_: Some(\n                            (\n                                Binary {\n                                    op: And,\n                                    op_span: 85..88,\n                                    lhs: Binary {\n                                        op: Eq,\n                                        op_span: 79..80,\n                                        lhs: Identifier(\n                                            [\n                                                Name(\n                                                    Identifier {\n                                                        value: \"a\",\n                                                        span: 77..78,\n                                                    },\n                                                ),\n                                            ],\n                                        ),\n                                        rhs: Integer(\n                                            (\n                                                12,\n                                                81..83,\n                                            ),\n                                        ),\n                                    },\n                                    rhs: Binary {\n                                        op: Eq,\n                                        op_span: 92..93,\n                                        lhs: Identifier(\n                                            [\n                                                Name(\n                                                    Identifier {\n                                                        value: \"b\",\n                                                        span: 90..91,\n                                                    },\n                                                ),\n                                            ],\n                                        ),\n                                        rhs: Integer(\n                                            (\n                                                34,\n                                                94..96,\n                                            ),\n                                        ),\n                                    },\n                                },\n                                70..75,\n                            ),\n                        ),\n                        group_by: None,\n                        having: None,\n                        window_span: None,\n                        order_by: None,\n                        limit: None,\n                        locking: None,\n                    },\n                ),\n                rparen_span: 97..98,\n            },\n            WithBlock {\n                identifier: Identifier {\n                    value: \"inserted\",\n                    span: 100..108,\n                },\n                as_span: 109..111,\n                lparen_span: 112..113,\n                statement: InsertReplace(\n                    InsertReplace {\n                        type_: Insert(\n                            113..119,\n                        ),\n                        flags: [],\n                        into_span: Some(\n                            120..124,\n                        ),\n                        table: QualifiedName {\n                            prefix: [],\n                            identifier: Identifier {\n                                value: \"test_tables\",\n                                span: 125..136,\n                            },\n                        },\n                        columns: [],\n                        values: None,\n                        select: None,\n                        set: None,\n                        on_duplicate_key_update: None,\n                        on_conflict: None,\n                        as_alias: Some(\n                            (\n                                137..139,\n                                Identifier {\n                                    value: \"test_table\",\n                                    span: 140..150,\n                                },\n                                Some(\n                                    [\n                                        Identifier {\n                                            value: \"id\",\n                                            span: 152..154,\n                                        },\n                                        Identifier {\n                                            value: \"a\",\n                                            span: 156..157,\n                                        },\n                                        Identifier {\n                                            value: \"b\",\n                                            span: 159..160,\n                                        },\n                                        Identifier {\n                                            value: \"c\",\n                                            span: 162..163,\n                                        },\n                                    ],\n                                ),\n                            ),\n                        ),\n                        returning: None,\n                    },\n                ),\n                rparen_span: 275..276,\n            },\n        ],\n        statement: Select(\n            Select {\n                select_span: 277..283,\n                flags: [],\n                select_exprs: [\n                    SelectExpr {\n                        expr: Identifier(\n                            [\n                                Name(\n                                    Identifier {\n                                        value: \"c\",\n                                        span: 284..285,\n                                    },\n                                ),\n                            ],\n                        ),\n                        as_: None,\n                    },\n                ],\n                from_span: Some(\n                    286..290,\n                ),\n                table_references: Some(\n                    [\n                        Table {\n                            identifier: QualifiedName {\n                                prefix: [],\n                                identifier: Identifier {\n                                    value: \"existing\",\n                                    span: 291..299,\n                                },\n                            },\n                            as_span: None,\n                            as_: None,\n                            index_hints: [],\n                        },\n                    ],\n                ),\n                where_: None,\n                group_by: None,\n                having: None,\n                window_span: None,\n                order_by: None,\n                limit: None,\n                locking: None,\n            },\n        ),\n    },\n)",
    "issues": [
      "Issue {\n    level: Error,\n    message: \"Expected 'VALUE, VALUES, SELECT or SET' here\",\n    span: 137..139,\n    sql_segment: \"AS\",\n    fragments: [],\n}",
      "Issue {\n    level: Error,\n    message: \"Expected '')'' here\",\n    span: 165..171,\n    sql_segment: \"VALUES\",\n    fragments: [],\n}"
    ],
    "failure": true
  }
]